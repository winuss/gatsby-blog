<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.b8221ec0ff064b96422d.css">code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.21.0"/><title data-react-helmet="true">NLP - 텍스트 분류 (전처리) - #1 - DevTimes</title><meta data-react-helmet="true" name="description" content="케글 데이터 불러오기 -&gt; EDA -&gt; 데이터정제 -&gt; 모델링의미한다."/><meta data-react-helmet="true" name="og:title" content="NLP - 텍스트 분류 (전처리) - #1 - DevTimes"/><meta data-react-helmet="true" name="og:type" content="website"/><meta data-react-helmet="true" name="og:description" content="케글 데이터 불러오기 -&gt; EDA -&gt; 데이터정제 -&gt; 모델링의미한다."/><meta data-react-helmet="true" name="og:url" content="https://devtimes.com/nb-text-classification-pre"/><meta data-react-helmet="true" name="twitter:label1" content="Written by"/><meta data-react-helmet="true" name="twitter:data1" content="winuss"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="winuss"/><meta data-react-helmet="true" name="twitter:title" content="NLP - 텍스트 분류 (전처리) - #1 - DevTimes"/><meta data-react-helmet="true" name="twitter:description" content="케글 데이터 불러오기 -&gt; EDA -&gt; 데이터정제 -&gt; 모델링의미한다."/><meta data-react-helmet="true" name="keywords" content="angular, python, machine learning, deep learning, game, ML-DL, ML, NLP"/><meta data-react-helmet="true" name="article:published_time" content="2019-06-25T00:00:00.000Z"/><meta data-react-helmet="true" name="article:modified_time" content="2019-06-25T00:00:00.000Z"/><meta data-react-helmet="true" name="twitter:label2" content="Filed under"/><meta data-react-helmet="true" name="twitter:data2" content="ML-DL"/><script data-react-helmet="true" type="application/ld+json">
        {
          "@context": "https://schema.org/",
          "@type": "Article",
          "author": {
            "@type": "Person",
            "name": "winuss"
          },
          "keywords": "ML-DL, ML, NLP",
          "headline": "NLP - 텍스트 분류 (전처리) - #1 - DevTimes",
          "url": "https://devtimes.com/nb-text-classification-pre",
          "datePublished": "2019-06-25T00:00:00.000Z",
          "dateModified": "2019-06-25T00:00:00.000Z",
          
          "publisher": {
            "@type": "Organization",
            "name": "DevTimes"
          },
          "description": "케글 데이터 불러오기 -> EDA -> 데이터정제 -> 모델링의미한다.",
          "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://devtimes.com"
          }
        }
      </script><style data-styled="gOVsKi fbNACK dqKNZj JgKdn jnMIuM hqRQjv gWKWdg jMoVC fiqFtq llrxFq imSJbr JexoF iRWYuq bOhMpF eMHMJv fymZCI bdTsjL ixYMGE gDLYpk hKDtNq guoPGM hyzxOc kAaKev ewrmMm dWgKtp kWRivk rrUdK gmpFBk cCbMYU kStElJ frcJlw cNysWr htFYTF hdhrBK kcCrhV cKJeHJ evGsdC dkniVZ eysmNL" data-styled-version="4.4.1">
/* sc-component-id: sc-global-2451124928 */
html{box-sizing:border-box;background-color:#fafafa;} body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;line-height:1.9em;} *{box-sizing:border-box;} h1,h2,h3,h4,h5,h6{outline:none;} a{color:#000;-webkit-text-decoration:none;text-decoration:none;} .gatsby-highlight{font-size:0.85em;background-color:#282a36;border-radius:0.2em;padding:1em 1.4em;overflow:auto;width:100%;border:0.1em solid #c6c6c8;margin-bottom:6px;} div[data-language='text'].gatsby-highlight{background-color:#f0f0f0;border:0.03em solid #c6c6c8;margin-left:2px;margin-right:2px;width:calc(100% - 4px);} .gatsby-highlight pre.language-text code.language-text{color:#000;text-shadow:none;} .gatsby-highlight pre[class*='language-']{background-color:transparent;margin:0;padding:0;overflow:initial;float:left;min-width:100%;} .gatsby-highlight-code-line{background-color:#353631;display:block;margin-right:-1em;margin-left:-1em;padding-right:1em;padding-left:0.75em;} .remark-sticky-table{border-radius:2px;margin:32px 0px;} .remark-sticky-table-table{border-collapse:collapse;box-sizing:border-box;border:1px solid #bcbcbc;width:auto;} .remark-sticky-table-th{background-color:#f7f7f7;font-weight:600;text-align:left;border-bottom:1px solid #b8bcc9;} .remark-sticky-table-tbody:nth-child(odd){background-color:#fafafa;} .remark-sticky-table-th,.remark-sticky-table-td{padding:4px 12px;} table.dataframe{border-collapse:collapse;font-size:0.75em;margin-bottom:8px;margin-left:2px;margin-right:2px;line-height:2em;display:block;overflow-x:auto;white-space:nowrap;border:1px solid transparent;} table.dataframe > tbody{text-align:right;} .dataframe td,.dataframe th{border:1px solid #bcbcbc;padding:0px 12px;} .dataframe tr:nth-child(even){background-color:#f2f2f2;} .dataframe tr:hover{background-color:#d6d9e0;} .dataframe th{background-color:#f7f7f7;padding:0px 12px;}
/* sc-component-id: style__NavContainer-sc-1nu4t1g-0 */
.gOVsKi{z-index:1000;background-color:#20232a;position:-webkit-sticky;position:sticky;top:0;box-shadow:0 0 3px rgba(0,0,0,.03),0 3px 46px rgba(0,0,0,.07);}
/* sc-component-id: style__Nav-sc-1nu4t1g-1 */
.fbNACK{width:1260px;margin-left:auto;margin-right:auto;max-width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:relative;} @media (max-width:1300px){.fbNACK{padding:0 20px;}}
/* sc-component-id: style__NavWrapper-sc-1nu4t1g-2 */
.jnMIuM{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;height:70px;white-space:nowrap;} @media (max-width:576px){.jnMIuM{width:90%;}}
/* sc-component-id: style__NavMenu-sc-1nu4t1g-3 */
.hqRQjv{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;list-style-type:none;margin:0;padding:0;} @media (max-width:576px){.hqRQjv{width:80%;overflow-x:auto;overflow-y:hidden;-webkit-mask-image:linear-gradient(to right,transparent,#000 25px,#000 90%,transparent);mask-image:linear-gradient(to right,transparent,#000 25px,#000 90%,transparent);}}.gWKWdg{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;list-style-type:none;margin:0;padding:0;}
/* sc-component-id: style__NavMenuItem-sc-1nu4t1g-4 */
.jMoVC{cursor:pointer;display:inline-block;border:0;background:transparent;outline:none;-webkit-text-decoration:none;text-decoration:none;}
/* sc-component-id: style__NavLink-sc-1nu4t1g-5 */
.fiqFtq{color:#fff;opacity:.8;padding:16px;-webkit-transition:opacity .5s;transition:opacity .5s;} .fiqFtq:hover{opacity:1;}
/* sc-component-id: style__SearchContainer-sc-1nu4t1g-6 */
.llrxFq{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;position:relative;}
/* sc-component-id: style__ToggleSearchButton-sc-1nu4t1g-7 */
.imSJbr{cursor:pointer;color:#fff;opacity:.8;background:none;outline:none;border:0;-webkit-transition:opacity .5s;transition:opacity .5s;} .imSJbr:hover{opacity:1;}
/* sc-component-id: logo__LogoImage-nd9ri7-0 */
.JgKdn{max-height:30px;width:30px;margin-right:45px;} @media (max-width:576px){.JgKdn{margin-right:15px;}}
/* sc-component-id: logo__HomeLink-nd9ri7-1 */
.dqKNZj{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;height:30px;}
/* sc-component-id: style__StyledFooter-sc-1xdlo4d-0 */
.hdhrBK{max-width:100%;padding:10px 0;z-index:700;position:relative;font-size:.9em;margin-top:50px;}
/* sc-component-id: style__FooterContainer-sc-1xdlo4d-1 */
.kcCrhV{width:1260px;margin-left:auto;margin-right:auto;max-width:100%;text-align:right;line-height:1.1em;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;} @media (max-width:1300px){.kcCrhV{padding:0 20px;}}
/* sc-component-id: style__Copyright-sc-1xdlo4d-2 */
.dkniVZ{margin:0;}
/* sc-component-id: style__DesignBy-sc-1xdlo4d-3 */
.eysmNL{margin:0;opacity:.8;font-size:.8em;} .eysmNL a{font-weight:bold;-webkit-text-decoration:none;text-decoration:none;color:#000;} .eysmNL a:hover{-webkit-text-decoration:underline;text-decoration:underline;}
/* sc-component-id: style__StyledNav-sc-1xdlo4d-4 */
.cKJeHJ ul{list-style-type:none;margin:0;padding:0;} .cKJeHJ li{display:inline-block;margin-right:25px;} .cKJeHJ li:last-child{margin-right:0;}
/* sc-component-id: style__FooterMenuItem-sc-1xdlo4d-5 */
.evGsdC{color:#000;-webkit-text-decoration:none;text-decoration:none;}
/* sc-component-id: toc__StyledNav-dzz3d3-0 */
.kAaKev .toc-list{list-style-type:none;margin:0;padding:0 0 0 0;border-left:2.5px solid #dcdee4;} .kAaKev .toc-list .toc-list{padding-top:10px;} .kAaKev .toc-list-item{line-height:1.2em;padding-bottom:10px;} .kAaKev .toc-list-item:last-child{padding-bottom:0;} .kAaKev .toc-link{color:#808080;-webkit-text-decoration:none;text-decoration:none;font-size:0.9em;font-weight:550;padding-left:8px;} .kAaKev .is-active-link{margin-left:-2.5px;padding-left:8px;border-left:2.5px solid #13acee;color:#099bcc;}
/* sc-component-id: reading-progress__ReadingProgressBar-i1hf8v-0 */
.JexoF{position:-webkit-sticky;position:sticky;height:5px;top:70px;background-color:#4bc822;z-index:500;}
/* sc-component-id: social-channel-list__StyledSocialChannels-z1p8fq-0 */
.cNysWr{list-style-type:none;margin:0;padding:0;}
/* sc-component-id: social-channel-list__StyledSocialChannel-z1p8fq-1 */
.htFYTF{display:inline-block;margin:0 10px;font-size:1.6em;opacity:.7;-webkit-transition:opacity .5s;transition:opacity .5s;} .htFYTF:hover{opacity:1;}
/* sc-component-id: avatar__StyledAvatar-sc-1papyes-0 */
.cCbMYU{max-width:70px;border-radius:100%;}
/* sc-component-id: bio__StyledBio-j3ch0c-0 */
.gmpFBk{margin:auto;text-align:center;width:100%;}
/* sc-component-id: bio__AuthorDescription-j3ch0c-1 */
.frcJlw{margin:10px 0 13px;} .frcJlw a{color:#000;-webkit-text-decoration:underline;text-decoration:underline;}
/* sc-component-id: bio__AuthorName-j3ch0c-2 */
.kStElJ{margin:10px;}
/* sc-component-id: post__PostContainer-z0x2sj-0 */
.iRWYuq{width:1260px;margin-left:auto;margin-right:auto;max-width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:0 !important;} @media (max-width:1300px){.iRWYuq{padding:0 20px;}}
/* sc-component-id: post__LeftSidebar-z0x2sj-1 */
.guoPGM{min-width:300px;max-width:300px;-webkit-transition:opacity .5s,z-index .5s;transition:opacity .5s,z-index .5s;font-size:0.9em;margin-left:20px;} @media (max-width:1300px){.guoPGM{position:fixed;opacity:0;z-index:-1;background-color:#fff;width:100% !important;padding:0 20px;margin-top:-5px;height:calc(100vh - 70px);}}
/* sc-component-id: post__PostContent-z0x2sj-2 */
.bOhMpF{margin-top:-5px;border-right:1px #e5eff5 solid;border-left:1px #e5eff5 solid;background-color:#fff;box-shadow:0 0 3px rgba(0,0,0,.03),0 3px 46px rgba(0,0,0,.1);z-index:10;width:1035px;max-width:100%;} .bOhMpF li > a,.bOhMpF p > a{color:#a4cbb8;border-bottom:2px #a4cbb8 solid;} .bOhMpF pre{margin:30px 0;} .bOhMpF blockquote{border-left:4px #a4cbb8 solid;background-color:#fafafa;margin:30px 0;padding:5px 20px;border-radius:.3em;} .bOhMpF h3::before,.bOhMpF h4::before,.bOhMpF h5::before,.bOhMpF h6::before{display:block;content:" ";height:90px;margin-top:-90px;visibility:hidden;} .bOhMpF h2{border-top:1px solid #ececec;margin-top:44px;padding-top:40px;line-height:1.2;} .bOhMpF code[class*="language-text"]{padding:2px;font-size:0.9em;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;} .bOhMpF p > .language-text{background-color:#f2e6e9;padding:0 4px 2px 4px;font-weight:600;color:#c7254e;text-align:center;} .bOhMpF p > img{max-width:100%;border-radius:.3em;margin:30px 0;} .bOhMpF hr{border-top:1px solid #ececec;border-bottom:0;margin-top:44px;margin-bottom:40px;} .bOhMpF .gatsby-resp-image-link{margin:30px 0;max-width:100%;} .bOhMpF .gatsby-resp-image-link .gatsby-resp-image-image{border-radius:.3em;}
/* sc-component-id: post__TocWrapper-z0x2sj-3 */
.hyzxOc{position:-webkit-sticky;position:sticky;top:70px;padding:40px 30px 40px 0;}
/* sc-component-id: post__PostHeader-z0x2sj-4 */
.eMHMJv{padding:40px;} @media (max-width:576px){.eMHMJv{padding:20px;}}
/* sc-component-id: post__StyledPost-z0x2sj-6 */
.ixYMGE{padding:40px;} @media (max-width:576px){.ixYMGE{padding:20px;}}
/* sc-component-id: post__PostMeta-z0x2sj-7 */
.fymZCI{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;opacity:.8;font-size:.9em;}
/* sc-component-id: post__PostTitle-z0x2sj-8 */
.bdTsjL{margin:0;padding:0;}
/* sc-component-id: post__PostFooter-z0x2sj-9 */
.gDLYpk{background-color:#fafafa;font-size:.8em;color:#666;padding:40px;line-height:1em;} .gDLYpk p{margin:5px 0;}
/* sc-component-id: post__FooterTagLink-z0x2sj-10 */
.hKDtNq{color:#000 !important;-webkit-text-decoration:none;text-decoration:none;border-bottom:0 !important;}
/* sc-component-id: post__PostAddition-z0x2sj-11 */
.dWgKtp{background-color:#fff;border-top:1px #e5eff5 solid;border-bottom:1px #e5eff5 solid;z-index:700;position:relative;padding:40px;}
/* sc-component-id: post__PostAdditionContent-z0x2sj-12 */
.kWRivk{width:1260px;margin-left:auto;margin-right:auto;max-width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;} @media (max-width:1300px){.kWRivk{padding:0 20px;}}
/* sc-component-id: post__BioWrapper-z0x2sj-13 */
.rrUdK{width:50%;margin:auto;} @media (max-width:576px){.rrUdK{width:100%;}}
/* sc-component-id: post__ToggleTocButton-z0x2sj-14 */
.ewrmMm{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:fixed;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;right:20px;bottom:20px;border-radius:100%;box-shadow:0 0 3px rgba(0,0,0,.03),0 3px 46px rgba(0,0,0,.1);border:0;z-index:5000;width:50px;height:50px;background-color:#20232a;color:#fff;outline:none;} @media (min-width:1300px){.ewrmMm{display:none;}}</style><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/favicon-32x32.png?v=53395c7476cdf4ad211173db66a6affd"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#a4cbb8"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=53395c7476cdf4ad211173db66a6affd"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=53395c7476cdf4ad211173db66a6affd"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=53395c7476cdf4ad211173db66a6affd"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=53395c7476cdf4ad211173db66a6affd"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=53395c7476cdf4ad211173db66a6affd"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=53395c7476cdf4ad211173db66a6affd"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=53395c7476cdf4ad211173db66a6affd"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=53395c7476cdf4ad211173db66a6affd"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/rss.xml"/><link as="script" rel="preload" href="/webpack-runtime-54fc4c4fe4b49e1e33de.js"/><link as="script" rel="preload" href="/framework-737c3e16d462c41141c7.js"/><link as="script" rel="preload" href="/app-a8b2574222d925c54afd.js"/><link as="script" rel="preload" href="/styles-85581d4dae49207538a9.js"/><link as="script" rel="preload" href="/1bfc9850-693458f4bfc03c5b78c9.js"/><link as="script" rel="preload" href="/6c18e55fdd71cb6af87612710cbe2c0cb61bdd56-92ca3db2def247415ce0.js"/><link as="script" rel="preload" href="/component---src-templates-post-tsx-8a7ad919cf47b755089e.js"/><link as="fetch" rel="preload" href="/page-data/nb-text-classification-pre/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="style__NavContainer-sc-1nu4t1g-0 gOVsKi"><div class="common__Container-sc-1wbwqlx-0 style__Nav-sc-1nu4t1g-1 fbNACK"><a class="logo__HomeLink-nd9ri7-1 dqKNZj" href="/"><div class="logo__LogoImage-nd9ri7-0 JgKdn gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:30px;height:30px"><img aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAC1UlEQVQ4y4WVTUubQRCAo6bQQEvxH+SSQw4SCOI5kGsiQtNCCTQeepD+BgVbDzlqsRSFBGKgBJpDTzlEbfUaFTVQSyAQ7QdYvIgt0eT9mOnMZme7BqELk9ndd/bZmdnZTQAAAtxYk4zq/j2SJyQVklMSBxFd0t9IPpA8o/F9bTtKfcUQrToyIIM09b+i1TzPU2I3smuTehoIGMbIXbDX1hr2yCXt83otvjUv4DcWVP1ImK+0jU99j0RBKpUKzM/Pw+LiIqytrYHrujDgKBtPQ9/e8pImUhaMBX3fVwsTiQS7ryQcDuPNzY0A1Y94S3pWYEEaf9GTsiMQUO2QSqUMcGJiAnu93mBn3xeorPlJ6hG7+VhPuJoF2kO1MJ1OG2AsFjNASaG1ljTOMfD9XcBBChE7nQ4eHh7i0dERtlotddqO42C/32cBGrOhlMAnDrlj5Q+GSgOHW7vdxsnJSYzH4xiJRLBYLKqc6oj+sIeO5M1KtoGxoXjFrdlsmhSwLC0tKUN9+qoG3X8OAUgRszBsGHh8fHwLyOU0DPxhe4j/aWdnZzgzM4PT09OYTCaxWq3aIXcZ+FFuxuXlJWxtbcHOzg7W63U8Pz/Hk5MT3NzcxO3tbdzf38erqyskG/W9VqsBHZo5FPLpMx/KrAAZxKU5NjamwimVSpjNZk14fBB7e3t2yEA5ROscXrKHDyn+U57Y3d312DAUCvEThOVyGXO5nAFMTU3hwcEBf8dgMKhs8vm8r3P4i4Dj6rZcX18/50kKy+VdZfdCoQCZTMYAo9EoNhoNsG0WFhaUd8SYk6s3oi/2Oy7WlZUVlx4Bb3l5mQsZaBOgPqyurgIfwMXFBWxsbHA6/PX1dYfzTK1sHgfzQmio/XzpZMPQVfMkZ7qVZb04F6D7aaDdbjdH+fhu3xauMRa535IzE6bNsP4CRsRb6j+g/gvSddK/LXiXS4NPk4bjw+u4rv8C5lC4pDZ5rvwAAAAASUVORK5CYII=" alt="DevTimes" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/c9a164741da1db2837cd1e6d841a84fb/91664/main-logo.png 1x,
/static/c9a164741da1db2837cd1e6d841a84fb/ad39b/main-logo.png 1.5x,
/static/c9a164741da1db2837cd1e6d841a84fb/183c2/main-logo.png 2x" /><img loading="lazy" width="30" height="30" srcset="/static/c9a164741da1db2837cd1e6d841a84fb/91664/main-logo.png 1x,
/static/c9a164741da1db2837cd1e6d841a84fb/ad39b/main-logo.png 1.5x,
/static/c9a164741da1db2837cd1e6d841a84fb/183c2/main-logo.png 2x" src="/static/c9a164741da1db2837cd1e6d841a84fb/91664/main-logo.png" alt="DevTimes" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></a><div class="style__NavWrapper-sc-1nu4t1g-2 jnMIuM"><ul class="style__NavMenu-sc-1nu4t1g-3 hqRQjv"><li class="style__NavMenuItem-sc-1nu4t1g-4 jMoVC"><a class="style__NavLink-sc-1nu4t1g-5 fiqFtq" href="/tag/web">Web</a></li><li class="style__NavMenuItem-sc-1nu4t1g-4 jMoVC"><a class="style__NavLink-sc-1nu4t1g-5 fiqFtq" href="/tag/python">Python</a></li><li class="style__NavMenuItem-sc-1nu4t1g-4 jMoVC"><a class="style__NavLink-sc-1nu4t1g-5 fiqFtq" href="/tag/ml-dl">ML-DL</a></li><li class="style__NavMenuItem-sc-1nu4t1g-4 jMoVC"><a class="style__NavLink-sc-1nu4t1g-5 fiqFtq" href="/tag/datalake">DataLake</a></li><li class="style__NavMenuItem-sc-1nu4t1g-4 jMoVC"><a class="style__NavLink-sc-1nu4t1g-5 fiqFtq" href="/tag/statistics">Statistics</a></li><li class="style__NavMenuItem-sc-1nu4t1g-4 jMoVC"><a class="style__NavLink-sc-1nu4t1g-5 fiqFtq" href="/tag/tip">Tips</a></li><li class="style__NavMenuItem-sc-1nu4t1g-4 jMoVC"><a class="style__NavLink-sc-1nu4t1g-5 fiqFtq" href="/page">About</a></li></ul><div class="style__SearchContainer-sc-1nu4t1g-6 llrxFq"><ul class="style__NavMenu-sc-1nu4t1g-3 gWKWdg"><li class="style__NavMenuItem-sc-1nu4t1g-4 jMoVC"><button role="button" aria-label="Toggle search" class="style__ToggleSearchButton-sc-1nu4t1g-7 imSJbr"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg></button></li></ul></div></div></div></div><main><div style="width:0%" color="#4bc822" class="reading-progress__ReadingProgressBar-i1hf8v-0 JexoF"></div><div class="common__Container-sc-1wbwqlx-0 post__PostContainer-z0x2sj-0 iRWYuq"><div class="post__PostContent-z0x2sj-2 bOhMpF"><article class="post"><header class="post__PostHeader-z0x2sj-4 eMHMJv"><section class="post__PostMeta-z0x2sj-7 fymZCI"><a href="/tag/ml-dl">ML-DL</a><time dateTime="2019-06-25T00:00:00.000Z">25 June, 2019</time></section><h1 class="post__PostTitle-z0x2sj-8 bdTsjL">NLP - 텍스트 분류 (전처리) - #1</h1></header><section class="post__StyledPost-z0x2sj-6 ixYMGE post"><p>캐글(Kaggle)의 "Bag of Words meets bag of popcorns"</p>
<p>(<a href="https://www.kaggle.com/c/word2vec-nlp-tutorial">https://www.kaggle.com/c/word2vec-nlp-tutorial</a>)</p>
<h3 id="워드팝콘-데이터의-처리-과정" style="position:relative;"><a href="#%EC%9B%8C%EB%93%9C%ED%8C%9D%EC%BD%98-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%9D%98-%EC%B2%98%EB%A6%AC-%EA%B3%BC%EC%A0%95" aria-label="워드팝콘 데이터의 처리 과정 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>워드팝콘 데이터의 처리 과정</h3>
<blockquote>
<p>케글 데이터 불러오기 -> EDA -> 데이터정제 -> 모델링</p>
</blockquote>
<p><strong>데이터정제</strong></p>
<ul>
<li>HTML 및 문장 보호 제거</li>
<li>불용어 제거</li>
<li>단어 최대 길이 설정</li>
<li>단어 패딩</li>
<li>백터 표상화</li>
</ul>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> zipfile</code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">DATA_IN_PATH <span class="token operator">=</span> <span class="token string">'./data_in/'</span></code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">file_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'labeledTrainData.tsv.zip'</span><span class="token punctuation">,</span> <span class="token string">'unlabeledTrainData.tsv.zip'</span><span class="token punctuation">,</span> <span class="token string">'testData.tsv.zip'</span><span class="token punctuation">]</span>
file_list_tsv <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'labeledTrainData.tsv'</span><span class="token punctuation">,</span> <span class="token string">'unlabeledTrainData.tsv'</span><span class="token punctuation">,</span> <span class="token string">'testData.tsv'</span><span class="token punctuation">]</span></code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">! ls <span class="token punctuation">.</span><span class="token operator">/</span>data_in</code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">NanumGothic.ttf		  ratings.txt		test_id.npy
labeledTrainData.tsv	  ratings_test.txt	train_clean.csv
labeledTrainData.tsv.zip  ratings_train.txt	train_input.npy
nsmc_test_input.npy	  sampleSubmission.csv	train_label.npy
nsmc_test_label.npy	  testData.tsv		unlabeledTrainData.tsv
nsmc_train_input.npy	  testData.tsv.zip	unlabeledTrainData.tsv.zip
nsmc_train_label.npy	  test_clean.csv</code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># file_list의 zip 압축파일을 풀어준다.</span>
<span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> file_list<span class="token punctuation">:</span>
    zipRef <span class="token operator">=</span> zipfile<span class="token punctuation">.</span>ZipFile<span class="token punctuation">(</span>DATA_IN_PATH <span class="token operator">+</span> <span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>
    zipRef<span class="token punctuation">.</span>extractall<span class="token punctuation">(</span>DATA_IN_PATH<span class="token punctuation">)</span>
    zipRef<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> os
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns

<span class="token operator">%</span>matplotlib inline</code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">! head <span class="token operator">-</span><span class="token number">2</span> <span class="token punctuation">.</span><span class="token operator">/</span>data_in<span class="token operator">/</span>labeledTrainData<span class="token punctuation">.</span>tsv</code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">id	sentiment	review
&quot;5814_8&quot;	1	&quot;With all this stuff going down at the moment with MJ i&#39;ve started listening to his music, watching the odd documentary here and there, watched The Wiz and watched Moonwalker again. Maybe i just want to get a certain insight into this guy who i thought was really cool in the eighties just to maybe make up my mind whether he is guilty or innocent. Moonwalker is part biography, part feature film which i remember going to see at the cinema when it was originally released. Some of it has subtle messages about MJ&#39;s feeling towards the press and also the obvious message of drugs are bad m&#39;kay.&lt;br /&gt;&lt;br /&gt;Visually impressive but of course this is all about Michael Jackson so unless you remotely like MJ in anyway then you are going to hate this and find it boring. Some may call MJ an egotist for consenting to the making of this movie BUT MJ and most of his fans would say that he made it for the fans which if true is really nice of him.&lt;br /&gt;&lt;br /&gt;The actual feature film bit when it finally starts is only on for 20 minutes or so excluding the Smooth Criminal sequence and Joe Pesci is convincing as a psychopathic all powerful drug lord. Why he wants MJ dead so bad is beyond me. Because MJ overheard his plans? Nah, Joe Pesci&#39;s character ranted that he wanted people to know it is he who is supplying drugs etc so i dunno, maybe he just hates MJ&#39;s music.&lt;br /&gt;&lt;br /&gt;Lots of cool things in this like MJ turning into a car and a robot and the whole Speed Demon sequence. Also, the director must have had the patience of a saint when it came to filming the kiddy Bad sequence as usually directors hate working with one kid let alone a whole bunch of them performing a complex dance scene.&lt;br /&gt;&lt;br /&gt;Bottom line, this movie is for people who like MJ on one level or another (which i think is most people). If not, then stay away. It does try and give off a wholesome message and ironically MJ&#39;s bestest buddy in this movie is a girl! Michael Jackson is truly one of the most talented people ever to grace this planet but is he guilty? Well, with all the attention i&#39;ve gave this subject....hmmm well i don&#39;t know because people can be different behind closed doors, i know this for a fact. He is either an extremely nice but stupid guy or one of the most sickest liars. I hope he is not the latter.&quot;</code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># 데이터를 불러오자</span>
train_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>DATA_IN_PATH <span class="token operator">+</span> <span class="token string">'labeledTrainData.tsv'</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">"\t"</span><span class="token punctuation">)</span>
train_data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre></div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>sentiment</th>
      <th>review</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5814_8</td>
      <td>1</td>
      <td>With all this stuff going down at the moment w...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2381_9</td>
      <td>1</td>
      <td>\The Classic War of the Worlds\" by Timothy Hi...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7759_3</td>
      <td>0</td>
      <td>The film starts with a manager (Nicholas Bell)...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3630_4</td>
      <td>0</td>
      <td>It must be assumed that those who praised this...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9495_8</td>
      <td>1</td>
      <td>Superbly trashy and wondrously unpretentious 8...</td>
    </tr>
  </tbody>
</table>
</div>
<p>데이터는 "id", "sentiment", "review"로 구분되어 있어며, 각 리뷰('review')에 대한 감정('sentiment')이 긍정(1), 부정(0)인지 나와있다.</p>
<p>이제 다음과 같은 순서로 데이터 분석을 해보자.</p>
<ol>
<li>데이터 크기</li>
<li>데이터 개수</li>
<li>각 리뷰 문자 길이 분포</li>
<li>많이 사용된 단어</li>
<li>긍정, 부정 데이터의 분포</li>
<li>각 리뷰의 단어 개수 분포</li>
<li>특수문자 및 대문자, 소문자 비율</li>
</ol>
<h3 id="데이터-크기" style="position:relative;"><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%81%AC%EA%B8%B0" aria-label="데이터 크기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>데이터 크기</h3>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"파일 크기 :"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>DATA_IN_PATH<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">file</span> <span class="token keyword">in</span> file_list_tsv<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>DATA_IN_PATH <span class="token operator">+</span> <span class="token builtin">file</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000000</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'MB'</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">파일 크기 :
labeledTrainData.tsv          33.56MB
testData.tsv                  32.72MB
unlabeledTrainData.tsv        67.28MB</code></pre></div>
<h3 id="데이터-개수" style="position:relative;"><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EA%B0%9C%EC%88%98" aria-label="데이터 개수 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>데이터 개수</h3>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'전체 학습 데이터의 개수: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>train_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">전체 학습 데이터의 개수: 25000</code></pre></div>
<h3 id="각-리뷰의-문자-길이-분포" style="position:relative;"><a href="#%EA%B0%81-%EB%A6%AC%EB%B7%B0%EC%9D%98-%EB%AC%B8%EC%9E%90-%EA%B8%B8%EC%9D%B4-%EB%B6%84%ED%8F%AC" aria-label="각 리뷰의 문자 길이 분포 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>각 리뷰의 문자 길이 분포</h3>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">train_length <span class="token operator">=</span> train_data<span class="token punctuation">[</span><span class="token string">'review'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">)</span>
train_length<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">0    2302
1     946
2    2449
3    2245
4    2231
Name: review, dtype: int64</code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>train_length<span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'word'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>yscale<span class="token punctuation">(</span><span class="token string">'log'</span><span class="token punctuation">,</span> nonposy<span class="token operator">=</span><span class="token string">'clip'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Log-Histogram of length of review'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Length of review'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Number of review'</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Text(0, 0.5, &#39;Number of review&#39;)</code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 725px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/e2f888037d2b1be782dfbda78a617603/a0209/output_18_1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 45.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABt0lEQVQoz6WRz0sbQRTH91T7f/Tc2FSwB6F/gP9Aj4KQKFQEsyIm4JrkH/ASBE/iUQqKUmyQqge719aD62al5GCbVmIIZNbMZnZm3rc7G38ceqjQBx/em3nDZ4Z5lpVEp9OZDBl7zwaDHOt284yxfBiGuWR/1vd92/O8xUajUTA5CIKC2Td9c+6OXLKebbfb74zPCuPYhRDA9TX+J/r9/s9UGBHVUa8D5bLA1ZVKekO0VkT0Fw/9R6QRcs4vjG8kEuIQu7sg21ZUqRAdHxNJSQQM+XfoO2HDCJ8LIerY3gYViwqrq8DSErC+Dnhecre81z5i4j6n5YMwMMJnnLFDbG0ZoaRymVKKRSLHIVpbI2o2hyqtn/RCK+r1PmNzEyiVdPKPSKlUgGoVsG3g4OBJQ4mi6HI45W73EzY2oJaXuXScWDuOkCsrsUpqVSoJVasJtFpc3dwIdXsrFOdCci61UgMpZaySrOOYWK+XDsU6Pzt78b1aff1jbi5zOj09/qtQyHzN58e+zcyM/V5YyHyYmnr7cX5+Yr9WmwiOjrJN1x092dl50261Xn5x3fEL3882Pe/V/t5e9g+kDVEFkgoRBQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="png"
        title="png"
        src="/static/e2f888037d2b1be782dfbda78a617603/a0209/output_18_1.png"
        srcset="/static/e2f888037d2b1be782dfbda78a617603/5a46d/output_18_1.png 300w,
/static/e2f888037d2b1be782dfbda78a617603/0a47e/output_18_1.png 600w,
/static/e2f888037d2b1be782dfbda78a617603/a0209/output_18_1.png 725w"
        sizes="(max-width: 725px) 100vw, 725px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<ul>
<li>figsize: (가로, 세로) 형태의 튜플로 입력</li>
<li>bins: 히스토그램 값들에 대한 버켓 범위</li>
<li>range: x축 값의 범위</li>
<li>alpha: 그래프 색상 투명도</li>
<li>color: 그래프 색상</li>
<li>label: 그래프에 대한 라벨</li>
</ul>
<p>대부분 6000 이하 그중에서도 2000 이하에 분포되어 있음을 알 수 있다. 그리고 일부 데이터의 경우 이상치로 10000 이상의 값을 가지고 있다.</p>
<p>길이데 대해 몇가지 통계를 확인해 보자</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'리뷰 길이 최대 값: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>train_length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'리뷰 길이 최소 값: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>train_length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'리뷰 길이 평균 값: {:.2f}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>train_length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'리뷰 길이 표준편차: {:.2f}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>std<span class="token punctuation">(</span>train_length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'리뷰 길이 중간 값: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>median<span class="token punctuation">(</span>train_length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 사분위의 대한 경우는 0~100 스케일로 되어있음</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'리뷰 길이 제 1 사분위: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>percentile<span class="token punctuation">(</span>train_length<span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'리뷰 길이 제 3 사분위: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>percentile<span class="token punctuation">(</span>train_length<span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">리뷰 길이 최대 값: 13708
리뷰 길이 최소 값: 52
리뷰 길이 평균 값: 1327.71
리뷰 길이 표준편차: 1005.22
리뷰 길이 중간 값: 981.0
리뷰 길이 제 1 사분위: 703.0
리뷰 길이 제 3 사분위: 1617.0</code></pre></div>
<p>리뷰의 길이가 히스토그램에서 확인했던 것과 비슷하게 평균이 1300정도 이고, 최댓값이 13000이로 확인이 된다.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>train_length<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'counts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> showmeans<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">{&#39;whiskers&#39;: [&lt;matplotlib.lines.Line2D at 0x7f1694cad4a8&gt;,
  &lt;matplotlib.lines.Line2D at 0x7f1694cad7f0&gt;],
 &#39;caps&#39;: [&lt;matplotlib.lines.Line2D at 0x7f1694cadb38&gt;,
  &lt;matplotlib.lines.Line2D at 0x7f1694cade80&gt;],
 &#39;boxes&#39;: [&lt;matplotlib.lines.Line2D at 0x7f1694cad358&gt;],
 &#39;medians&#39;: [&lt;matplotlib.lines.Line2D at 0x7f1694902208&gt;],
 &#39;fliers&#39;: [&lt;matplotlib.lines.Line2D at 0x7f1694902860&gt;],
 &#39;means&#39;: [&lt;matplotlib.lines.Line2D at 0x7f1694902550&gt;]}</code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 724px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/be28cf4ea4e1f322fe3d832fe1377115/a242d/output_22_1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 42%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAAA7UlEQVQoz62RzY6CQBCE5+LPw3vXF/AV1IOJGw+KJMYQuJj1sAfDRjMCCf8zDWPNBg3rjutFkgrQ1fXRzTDGWJ9zPiiKYpFl2STP85lJcRzP4Bs91KfIz4MgGILHeijY6g0X4J8/wDRNF7pQ13UJkUmYkKqqIrSZfKHzGGx3Ay4bILW/iPf73fd9RUS/6q2+qgE6Gtg1AXXoFsRkyvM8JYT44xmBSZJ8NIZ4XEevqOW6Lkkpn60s2yt38LD572fXmJBfzoqkeHUoew1kYRiOyrJ0cPQryGoLTdbl/G0dvw42P/nWo99ojfw2iqLxFYoaSSKFjBL7AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="png"
        title="png"
        src="/static/be28cf4ea4e1f322fe3d832fe1377115/a242d/output_22_1.png"
        srcset="/static/be28cf4ea4e1f322fe3d832fe1377115/5a46d/output_22_1.png 300w,
/static/be28cf4ea4e1f322fe3d832fe1377115/0a47e/output_22_1.png 600w,
/static/be28cf4ea4e1f322fe3d832fe1377115/a242d/output_22_1.png 724w"
        sizes="(max-width: 724px) 100vw, 724px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<ul>
<li>labels : 입력한 데이터에 대한 라벨</li>
<li>showmeans : 평균값을 마크함</li>
</ul>
<p>데이터의 길이가 대부분 2000 이하로 평균이 1500 이하인데, 길이가 4000 이상인 이상치 데이터도 많이 분포되어 있는 것을 확인할 수 있다.</p>
<p>이제 리뷰에서 많이 사용된 단어로 어떤 것이 있는지 알아보자.</p>
<h3 id="많이-사용된-단어" style="position:relative;"><a href="#%EB%A7%8E%EC%9D%B4-%EC%82%AC%EC%9A%A9%EB%90%9C-%EB%8B%A8%EC%96%B4" aria-label="많이 사용된 단어 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>많이 사용된 단어</h3>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> wordcloud <span class="token keyword">import</span> WordCloud
cloud <span class="token operator">=</span> WordCloud<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">.</span>generate<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>train_data<span class="token punctuation">[</span><span class="token string">'review'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>cloud<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">(-0.5, 799.5, 599.5, -0.5)</code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1126px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/e09ca43ccc286082997c2180047d2176/b94e3/output_25_1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 75.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAADvUlEQVQ4yxWT227bRhiEaUfmabk8iFyS4lmkKIo6xnIkW03cxHFsFEFRIEVR9CboTa8joOhrFbzvaxTlC/QlWojUdHu9//47M9+soKr0s2X6fxPV+HNRX/5VV4N2OxfaIJHaqyJqRdtvzThsN9+4rR/o7ShjLbXstn7LWt2LW83xW8X0WtlL2itj2Ao6s39lUxfW7RTGroT1qsBwX8CcB5CXOa5Ygmjl4/0vBdhYx+Y5g6K6WD+PMN4yvP05RXHwoK2WEJkDYaDoX5xlAO8u/deo4p7crnrtsOjVSdiT+biXRknvlFFf7MNeCZ3+/vOk9xLa330f9rN3QX/4Kezrh6inu30v2sNeMAV2TCT++qVzCi/jMxNCDAUXUuhAfVVDDCLQooQ5GUPxGMKXEaKNi/xxAud2Aq0cQfEZtPUKxA0h6NQ42sMY1ExPConO1IxBTH5gOtDnMawygjpbQylmkIMUEhtDKqYY1AtIqw2k2RRKyPhMBdnwIJCheHR4NttH6/Tuk3XefrAxv9UwrRVkE4LlgeLwKKNa+yAWzzccwUx8qI4FK49hjhwuwOQOQmi+C0Fy9KMeOdjckdPHH+n56RMP/jXFmx8Yso2Bx48anr/ji1cUXqRj9WSjfvAw+Yph8d5DNKPI9g7Y6z2M+QQC3VhHz+Ekg+TkrO1zehhhWLuQWQhjnIGmJWi1hu3GSEmE9b2Fm1uR52iC1QnYhMErCJ8pIAU+pxyLx5GRobq4PiXS5GwaJqKLAiMhhaoHMPIKZDyHYY4xvbjhZyW81IcnZ0ikKVSTVyZnMOoC6siCoNT0mHgVbDk+xVp1zv0UqTwHiSIoDifNA7fKGKMgR6TOYFshouIO4eUUZl6D3MzhVUPe4VcgcQVBMOSjK3I7QnVKLstzGrr8Yg6pGkFbZNDvuLrHJYwsRi7MkAglfCdCKiXQohzKqoI+8UHXLzntFMKVbhzV/8lFxYnG2dkobRgVt7sueMciGGUOwpcpdQWV52rNt2Clg4A3Q7ZdiFEMnds1bzYQHcYpU/uLHCZQ71f/KPtZJ+/mnfa069Rd3Sn7ZUe/3nVke90p63WnHG465eFNNyimnWAMO6lMOzGLOzN3Oi6ik/2wEyTV/I0EGUgSgFxX0DYzaNc16M0M5v0S9nUKb5fBXXP6iwDRXY5xOUSdq1xZBpn/IsvnfSw2UFjMFUrGt0Tz/1AH5u/iC7UhstOIL2hDqdXY7qDxCrUZFnpjZ6QhodmMC9LsdqRZLIRGjlij1kWj0bAxtKS5GqjNf7oYeVtsyPnFAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="png"
        title="png"
        src="/static/e09ca43ccc286082997c2180047d2176/b94e3/output_25_1.png"
        srcset="/static/e09ca43ccc286082997c2180047d2176/5a46d/output_25_1.png 300w,
/static/e09ca43ccc286082997c2180047d2176/0a47e/output_25_1.png 600w,
/static/e09ca43ccc286082997c2180047d2176/b94e3/output_25_1.png 1126w"
        sizes="(max-width: 1126px) 100vw, 1126px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>워드 클라우드를 통해 살펴보면 가장 많이 사용된 단어는 br로 확인이 된다. br은 HTML 태그 이기때문에 이 태그들을 모두 제거 하는 전처리 작업이 필요하다.</p>
<h3 id="긍정부정-데이터의-분포" style="position:relative;"><a href="#%EA%B8%8D%EC%A0%95%EB%B6%80%EC%A0%95-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%9D%98-%EB%B6%84%ED%8F%AC" aria-label="긍정부정 데이터의 분포 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>긍정/부정 데이터의 분포</h3>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">fig<span class="token punctuation">,</span> axe <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>ncols<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>countplot<span class="token punctuation">(</span>train_data<span class="token punctuation">[</span><span class="token string">'sentiment'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f1694a64898&gt;</code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 402px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/4e485ce0672f989527cd94bc2f333542/0ec92/output_28_1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACQklEQVQoz63S309SYRjA8dNP2rrqMuZqq5mE/Jhka0sqaK75B3TZdVslSxOTRnKwmY1sNR1WjOHhEFyUrgt+GDaoUSy1RMFsZQScc1Ez7XRCAuW8zacXktbaWl30bN+dm2efnfe8h0gmk+sIPKERb1ViLmNyPBg3U8EJspITZw+MkfG3LJnlFkg24ibZkJ1kw461Bklm9Fbnh+mHPXPJd00Ez/Prsbf1RdjfOJ7mQNvthWNXfDh/uSZLANTm+zDGLEFpctRxWOprgNyAFnJWDX4eBe5qHcBkP8xzWQeBd0pvuJlNPDs4EkstS3QOpGilijhBjlOecwq7T9kEXywjABQF1qIWGOMugSUlAmOqEVizVEif314o+Ayw+CV/vQKKZp6OHg5OpRFGYJ+eXlXpaShV3+4Cic4O/lgGrxaBvaYBDAHbJcfJgL2kgLRhBxKCJljkv/YRYrF4Gwa3vB4PHwpOpZAMg6rfwJrmX8DeP4GdP0CtVivC4KZU7EnDfwHXRvQ85NXgIy/LWga/YUhQ6Z1I1eZE9e00wiDCIAJYQUyvBmEQMV1yxJhrEQYRBlcKASMs8LkblW+4ITMdPRJ5Mw9Kw13Ybxz62YGLwyBt88DjJFe+Zd7aCJ979gJvUeIUwOMb/mjaCRC9DJ+yeVsFJCYf+fcMR+JO6ekBl1J3m1Y037yjOGP11J210dUn++mh6CtqNc9Rs91q+mVHNT1zQeqKd0jcs8ZaOtFaRWXcLfdS7PsT5fP6PXbiH2Zj6ff629J38MzHGZItqEgAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="png"
        title="png"
        src="/static/4e485ce0672f989527cd94bc2f333542/0ec92/output_28_1.png"
        srcset="/static/4e485ce0672f989527cd94bc2f333542/5a46d/output_28_1.png 300w,
/static/4e485ce0672f989527cd94bc2f333542/0ec92/output_28_1.png 402w"
        sizes="(max-width: 402px) 100vw, 402px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>거의 동일한 개수로 분포되어 있음을 확인할 수 있다. 좀더 정확한 값을 확인해 보자.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"긍정 리뷰 개수: {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>train_data<span class="token punctuation">[</span><span class="token string">'sentiment'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"부정 리뷰 개수: {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>train_data<span class="token punctuation">[</span><span class="token string">'sentiment'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">긍정 리뷰 개수: 12500
부정 리뷰 개수: 12500</code></pre></div>
<h3 id="각-리뷰의-단어-개수-분포" style="position:relative;"><a href="#%EA%B0%81-%EB%A6%AC%EB%B7%B0%EC%9D%98-%EB%8B%A8%EC%96%B4-%EA%B0%9C%EC%88%98-%EB%B6%84%ED%8F%AC" aria-label="각 리뷰의 단어 개수 분포 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>각 리뷰의 단어 개수 분포</h3>
<p>각 리뷰를 단어 기준으로 나눠서 각 리뷰당 단어의 개수를 확인해 보자.
단어는 띄어쓰기 기준으로 하나의 단어라 생각하고 개수를 계산한다.
우선 각 단어의 길이를 가지는 변수를 하나 설정하자.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">train_word_counts <span class="token operator">=</span> train_data<span class="token punctuation">[</span><span class="token string">'review'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>train_word_counts<span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">'train'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Log-Histogram of word count in review'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>yscale<span class="token punctuation">(</span><span class="token string">'log'</span><span class="token punctuation">,</span> nonposy<span class="token operator">=</span><span class="token string">'clip'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Number of words'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Number of reviews'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Text(0, 0.5, &#39;Number of reviews&#39;)</code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 899px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/ee7ed12596b2d460721979cd35e8d106/681f1/output_34_1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 68%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACEElEQVQ4y6WST0sbQRjG3139AL0VYTVYCGpb8NiL4EFQ8OBNKHjyC2RzkJ5MIoL0UrBQ/AbSi1ehWFIRbJNCa3IoaRLX7TGuMSkb9n92Z97OZLrYpMEG+sLD87LM/OZ5dwZardZz17a3HMdJOZal2o6jep6XMgzjRaVS2alWq7l6vZ6t1WpZTdO2uVuWlWbrVce2VcfzVKfVSrUvLrbquv4MPMRv2Gwiahr+b7Xb7ZfQRTzH/X3EhQWffQuRkBApDXlPmQ9Tb12/Ag7sdDoZnrCI6+tIASKayVCKDEeIEO9Hq4gDTdPMgd9oFHFmpgdEAMRc7m6GMORI0cc+pPqA4e3tR5ybE0BZxh40nR7cce+/6wN2m81PfcAYuryMmM9j78J4ETIaMOIJZ2cFUJIELIZyHR7+Pf4/Ew4CucbHhR8c3AFHSehdXxeHAuOUe3til++LsQcviXkfMDCMwm9gSCWJMhcaGxO+tCSez5+KosFnFQOzENzcfOaXwtLQoQkXFxF3dxGPjxEN497RO6a5A26jcc7fIQFwiST5EUDAep/Kss88oCsrHk5MOOwAl2xuBuTkJKBHRz4plwMWq8uS+sR1Xby6wp+muQ2ls7OH5UQicQmgXEqSkgeY/g4wqcuy8hVg6nUy+eTV/PzTNwCP3wIkK2trkz/Y2i+rq1PvS6VpXdcVrVBQPmxsPHp3evrgF7Oihe5/pCqvAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="png"
        title="png"
        src="/static/ee7ed12596b2d460721979cd35e8d106/681f1/output_34_1.png"
        srcset="/static/ee7ed12596b2d460721979cd35e8d106/5a46d/output_34_1.png 300w,
/static/ee7ed12596b2d460721979cd35e8d106/0a47e/output_34_1.png 600w,
/static/ee7ed12596b2d460721979cd35e8d106/681f1/output_34_1.png 899w"
        sizes="(max-width: 899px) 100vw, 899px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>대부분의 단어가 1000개 미만의 단어를 가지고 있고, 대부분 200개 정도의 단어를 가지고 있다.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'리뷰 단어 개수 최대 값: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>train_word_counts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'리뷰 단어 개수 최소 값: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>train_word_counts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'리뷰 단어 개수 평균 값: {:.2f}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>train_word_counts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'리뷰 단어 개수 표준편차: {:.2f}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>std<span class="token punctuation">(</span>train_word_counts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'리뷰 단어 개수 중간 값: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>median<span class="token punctuation">(</span>train_word_counts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 사분위의 대한 경우는 0~100 스케일로 되어있음</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'리뷰 단어 개수 제 1 사분위: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>percentile<span class="token punctuation">(</span>train_word_counts<span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'리뷰 단어 개수 제 3 사분위: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>percentile<span class="token punctuation">(</span>train_word_counts<span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">리뷰 단어 개수 최대 값: 2470
리뷰 단어 개수 최소 값: 10
리뷰 단어 개수 평균 값: 233.79
리뷰 단어 개수 표준편차: 173.74
리뷰 단어 개수 중간 값: 174.0
리뷰 단어 개수 제 1 사분위: 127.0
리뷰 단어 개수 제 3 사분위: 284.0</code></pre></div>
<p>통계를 살펴보면 평균이 233개, 최댓값은 2470개의 단어를 가지고 있다. 그리고 3사분위 값이 284개로 리뷰의 75%가 300개 이하의 단어를 가지고 있음을 확인 할 수 있다.</p>
<h3 id="특수문자-및-대소문자-비율" style="position:relative;"><a href="#%ED%8A%B9%EC%88%98%EB%AC%B8%EC%9E%90-%EB%B0%8F-%EB%8C%80%EC%86%8C%EB%AC%B8%EC%9E%90-%EB%B9%84%EC%9C%A8" aria-label="특수문자 및 대소문자 비율 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>특수문자 및 대/소문자 비율</h3>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">qmarks <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>train_data<span class="token punctuation">[</span><span class="token string">'review'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token string">'?'</span> <span class="token keyword">in</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 물음표가 구두점으로 쓰임</span>
fullstop <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>train_data<span class="token punctuation">[</span><span class="token string">'review'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token string">'.'</span> <span class="token keyword">in</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 마침표</span>
capital_first <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>train_data<span class="token punctuation">[</span><span class="token string">'review'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isupper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#  첫번째 대문자</span>
capitals <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>train_data<span class="token punctuation">[</span><span class="token string">'review'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">[</span>y<span class="token punctuation">.</span>isupper<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> y <span class="token keyword">in</span> x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 대문자가 몇개</span>
numbers <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>train_data<span class="token punctuation">[</span><span class="token string">'review'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">[</span>y<span class="token punctuation">.</span>isdigit<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> y <span class="token keyword">in</span> x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 숫자가 몇개</span>
                  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'물음표가있는 질문: {:.2f}%'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>qmarks <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'마침표가 있는 질문: {:.2f}%'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>fullstop <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'첫 글자가 대문자 인 질문: {:.2f}%'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>capital_first <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'대문자가있는 질문: {:.2f}%'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>capitals <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'숫자가있는 질문: {:.2f}%'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>numbers <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">물음표가있는 질문: 29.55%
마침표가 있는 질문: 99.69%
첫 글자가 대문자 인 질문: 92.84%
대문자가있는 질문: 99.59%
숫자가있는 질문: 56.66%</code></pre></div>
<p>결과를 보면 대부분 마침표를 포함하고 있고, 대문자도 대부분 사용하고 있다. 따라서 전처리 과정에서 대문자의 경우 모두 소문자로 바꾸고 특수 문자의 경우 제거해야 한다. 이 과정은 학습에 방해가 되는 요소들을 제거하기 위함이다.</p>
<h2 id="데이터-전처리" style="position:relative;"><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%84%EC%B2%98%EB%A6%AC" aria-label="데이터 전처리 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>데이터 전처리</h2>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> re
<span class="token keyword">import</span> pandas
<span class="token keyword">import</span> numpy
<span class="token keyword">import</span> json
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup
<span class="token keyword">from</span> nltk<span class="token punctuation">.</span>corpus <span class="token keyword">import</span> stopwords
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>sequence <span class="token keyword">import</span> pad_sequences
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>text <span class="token keyword">import</span> Tokenizer</code></pre></div>
<p>어떤 방향으로 전처리해야 할지 결정하기 위해 데이터 하나를 자세히 보자.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">DATA_IN_PATH <span class="token operator">=</span> <span class="token string">'./data_in/'</span>

train_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>DATA_IN_PATH <span class="token operator">+</span> <span class="token string">'labeledTrainData.tsv'</span><span class="token punctuation">,</span> header <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> delimiter <span class="token operator">=</span> <span class="token string">'\t'</span><span class="token punctuation">,</span> quoting <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>train_data<span class="token punctuation">[</span><span class="token string">'review'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&quot;With all this stuff going down at the moment with MJ...bad m&#39;kay.&lt;br /&gt;&lt;br /&gt;...I hope he is not the latter.&quot;</code></pre></div>
<p>우선 <code class="language-text">&lt;br/&gt;</code>과 같은 HTML 태그와 <code class="language-text">\</code>,<code class="language-text">...</code> 같은 특수문자가 포함되어 있는것을 확인할 수 있는데, 이는 일반적으로 문장의 의미에 크게 영향을 주지 않기 때문에 <strong>BeautifulSoup</strong>과 <strong>re.sub</strong>을 이용해 제거하자.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">review <span class="token operator">=</span> train_data<span class="token punctuation">[</span><span class="token string">'review'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 리뷰들중 하나.</span>
review_text <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>review<span class="token punctuation">,</span> <span class="token string">"html5lib"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># HTML 태그 제거</span>
review_text <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">"[^a-zA-Z]"</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">,</span> review_text<span class="token punctuation">)</span> <span class="token comment"># 영어 문자를 제외한 나머지는 모두 공백으로 변경</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>review_text<span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> With all this stuff going ... I hope he is not the latter  </code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">stop_words <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>stopwords<span class="token punctuation">.</span>words<span class="token punctuation">(</span><span class="token string">'english'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 영어 불용어들의 set을 만듬</span>

review_text <span class="token operator">=</span> review_text<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 소문자변환 (NLTK에서 제공하는 불용어 사전은 모두 소문자로 되어있다.)</span>
words <span class="token operator">=</span> review_text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 단어리스트로 변환</span>
words <span class="token operator">=</span> <span class="token punctuation">[</span>w <span class="token keyword">for</span> w <span class="token keyword">in</span> words <span class="token keyword">if</span> <span class="token keyword">not</span> w <span class="token keyword">in</span> stop_words<span class="token punctuation">]</span> <span class="token comment"># 불용어를 제거한 리스트를 만듬</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>words<span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">[&#39;stuff&#39;, &#39;going&#39;, &#39;moment&#39;, &#39;mj&#39;, &#39;started&#39;, &#39;listening&#39;,,,&#39;hope&#39;, &#39;latter&#39;]</code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">clean_review <span class="token operator">=</span> <span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>words<span class="token punctuation">)</span> <span class="token comment"># 단어 리스트들을 다시 하나의 문장으로 합친다.</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>clean_review<span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">stuff going moment mj started listening ... iars hope latter</code></pre></div>
<p>전체 데이터에 적용하기 위해 함수화 하자.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">preprocessing</span><span class="token punctuation">(</span>review<span class="token punctuation">,</span> remove_stopwords<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 불용어 제거는 선택 가능하도록(경우에 따라 불용어 제거가 역호과를 가져올 수 있다.)</span>
    
    <span class="token comment"># 1. HTML 태그 제거</span>
    review_text <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>review<span class="token punctuation">,</span> <span class="token string">"html5lib"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 2. 영어가 아닌 특수문자들을 공백(" ")으로 바꾸기</span>
    review_text <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">"[^a-zA-Z]"</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">,</span> review_text<span class="token punctuation">)</span>

    <span class="token comment"># 3. 대문자들을 소문자로 바꾸고 공백단위로 텍스트들 나눠서 리스트로 만든다.</span>
    words <span class="token operator">=</span> review_text<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> remove_stopwords<span class="token punctuation">:</span> 
        <span class="token comment"># 4. 불용어들을 제거</span>
    
        <span class="token comment">#영어에 관련된 불용어 불러오기</span>
        stops <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>stopwords<span class="token punctuation">.</span>words<span class="token punctuation">(</span><span class="token string">"english"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># 불용어가 아닌 단어들로 이루어진 새로운 리스트 생성</span>
        words <span class="token operator">=</span> <span class="token punctuation">[</span>w <span class="token keyword">for</span> w <span class="token keyword">in</span> words <span class="token keyword">if</span> <span class="token keyword">not</span> w <span class="token keyword">in</span> stops<span class="token punctuation">]</span>
        <span class="token comment"># 5. 단어 리스트를 공백을 넣어서 하나의 글로 합친다.</span>
        clean_review <span class="token operator">=</span> <span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>words<span class="token punctuation">)</span>

    <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment"># 불용어 제거하지 않을 때</span>
        clean_review <span class="token operator">=</span> <span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>words<span class="token punctuation">)</span>

    <span class="token keyword">return</span> clean_review</code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">clean_train_reviews <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> review <span class="token keyword">in</span> train_data<span class="token punctuation">[</span><span class="token string">'review'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    clean_train_reviews<span class="token punctuation">.</span>append<span class="token punctuation">(</span>preprocessing<span class="token punctuation">(</span>review<span class="token punctuation">,</span> remove_stopwords<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 전처리된 데이터 확인</span>
clean_train_reviews<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&#39;stuff going moment mj started listening ... sickest liars hope latter&#39;</code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">clean_train_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'review'</span><span class="token punctuation">:</span> clean_train_reviews<span class="token punctuation">,</span> <span class="token string">'sentiment'</span><span class="token punctuation">:</span> train_data<span class="token punctuation">[</span><span class="token string">'sentiment'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">tokenizer <span class="token operator">=</span> Tokenizer<span class="token punctuation">(</span><span class="token punctuation">)</span>
tokenizer<span class="token punctuation">.</span>fit_on_texts<span class="token punctuation">(</span>clean_train_reviews<span class="token punctuation">)</span>
text_sequences <span class="token operator">=</span> tokenizer<span class="token punctuation">.</span>texts_to_sequences<span class="token punctuation">(</span>clean_train_reviews<span class="token punctuation">)</span></code></pre></div>
<p>위와 같이 하면 각 리뷰가 텍스트가 아닌 인덱스의 벡터로 구성될 것이다.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>text_sequences<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">[404, 70, 419, 8815, 506, 2456, 115, 54, 873, ,,, ,18688, 18689, 316, 1356]</code></pre></div>
<p>전체 데이터가 인덱스로 구성됨에 따라 각 인덱스가 어떤 단어를 의미하는지 확인할 수 있어야 하기 때문에 단어 사전이 필요하다.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">word_vocab <span class="token operator">=</span> tokenizer<span class="token punctuation">.</span>word_index
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>word_vocab<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"..."</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"전체 단어 개수 : "</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>word_vocab<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">{&#39;movie&#39;: 1, &#39;film&#39;: 2, &#39;one&#39;: 3, &#39;like&#39;: 4, &#39;good&#39;: 5, &#39;time&#39;: 6, &#39;even&#39;: 7, &#39;would&#39;: 8, &#39;story&#39;: 9 ...
전체 단어 개수 :  74066</code></pre></div>
<p> 총 74,000개 정도의 단어 이다. 단어 사전뿐 아니라 전체 단어의 개수도 이후 모델에서 사용되기 때문에 저장해 둔다.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">data_configs <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

data_configs<span class="token punctuation">[</span><span class="token string">'vocab'</span><span class="token punctuation">]</span> <span class="token operator">=</span> word_vocab
data_configs<span class="token punctuation">[</span><span class="token string">'vocab_size'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>word_vocab<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span></code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">MAX_SEQUENCE_LENGTH <span class="token operator">=</span> <span class="token number">174</span>  <span class="token comment"># 문장 최대 길이</span>

train_inputs <span class="token operator">=</span> pad_sequences<span class="token punctuation">(</span>text_sequences<span class="token punctuation">,</span> maxlen<span class="token operator">=</span>MAX_SEQUENCE_LENGTH<span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'post'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Shape of train data: '</span><span class="token punctuation">,</span> train_inputs<span class="token punctuation">.</span>shape<span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Shape of train data:  (25000, 174)</code></pre></div>
<p>패딩 처리를 위해 <code class="language-text">pad_sequences</code>함수를 사용하였다. 최대 길이를 174로 설정한 것은 앞서 단어 개수의 통계를 계산했을 때 나왔던 중간값이다.
보통 평균이 아닌 중간값을 사용하는 경우가 많은데, 일부 이상치 데이터로 인해 평균값이 왜곡될 우려가 있기때문이다.</p>
<p>패딩 처리를 통해 데이터의 형태가 25,000개의 데이터가 174라는 길이를 동일하게 가지게 되었다.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">train_labels <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>train_data<span class="token punctuation">[</span><span class="token string">'sentiment'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Shape of label tensor:'</span><span class="token punctuation">,</span> train_labels<span class="token punctuation">.</span>shape<span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Shape of label tensor: (25000,)</code></pre></div>
<p>numpy 배열로 만든 후 라벨의 형태를 확인해 보면 길이가 25,000인 벡터임을 확인할 수 있다.
이렇게 라벨까지 numpy 배열로 저장하면 모든 전처리 과정이 끝난다.</p>
<p>원본 데이터를 벡터화하는 과정을 그림을 통해 이해해 보자.
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 932px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/8c65c029635ba1dfbb6cb2c8d8cb257b/f6f78/oorigin-vector.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 77.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABcRAAAXEQHKJvM/AAADhElEQVQ4y22Uy28bdRDH91AuMXGctk6a4MaJ4zROmsSN3fQBCCGBhDghTkj9myrBGYi99q6feezbu2s7oXnQZLcVFzZwgIVLayHRHCJVVQ9ZD9/ftoU04vDRjMczP8/3N/MzN9+qPZs0RBpTS6cgCNFK/SuwSV0MZlrVYNashaRblSADmzIqwTT8ObMeJDQhiCt8MIr8EVjuw87G8+XtTRrQSxQ1yjQIBuQCRbQSjdt1urEjU/aBTPkdhW7uqrQCcvCXX3+e3dqgyU6TxuwaJWG5aV3soJtHCa18OA5Satm9v9s9+dhsemNa+eGcWXNmW1UHnTnXrXpI1m44i1bDmUfsht10lvCZ5S0hxi2atV9mjMpf4Om1VvXpewrf+9LefJnRhL+Thvhk3qr3ILvHLA7rXVaKbwG5PcjtoSlYvsflrcZLJiEHWR/sqPSuVSFO+pbeMUqUfrBJN380KLev0/sHZuinftgI44wMruNKt0ERS6Qo6gZZbVoXu/iFx+NqyRkBM5rw6Ov97ZNPIHnCEA8WzLq7wKSa9VD6wmvJuXbTudVZD2UndcGZApOAW7YaPy2b9T9XrObvd+01H5L/uNeRXyxo4pOELvyGu/MxUZ/ZJbvpQ7Y/ByDVj0kF/5Jc9EdU3sd2+JDtcx91Nk6/cLr0+WGb8pjaQLtGnPwdXTAFmtlT6NahRXnIvePYdBesHJqhzeyrlN5VKLOn0lXIj6Au2qkTh866WbP2OAtJU7oYSv5mb/vkU7N5hP08gCR30aqHYGguu4Ks1XDz7TUXkt3bgH0HuW5KF11uQhMeXlSKv15WeC+u8t6Ywh991ZaeZ1TBTxjiz7nO2hGW2lu0m951u+GNaiUP+d4lwOxFueixWszBg3SPg+4XbDpDLZGGTEwLXJBXKYIFj2NZ09vrlOg0KLW1TlNbazRtr1O8VQ3zYuarmrNwWOhnwypPw0rxNKYUAwb8PgiiciGISKvBoLwaDMAOS4VgVhGDSVkMhpRC8Cb/LBwme/xZV6JrutiPoDMEQ4bw/JgdZr5SoLhcojlJoCXle0pJVZqQBYoiHpP/y2UwyccxdIj76L8JnocVJGWRJlSRroKMWqNRBW//zEH/HojLPI6oRRqUC31A52Fds+IppUIj6DIu8ZRAp3gE4QHn87mMUT3GiyCMvY+Np/8DfyCU0tAh/BCtTEkN8Vd1b+X+A+YzBMNd2PttAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="oorigin-vector"
        title="oorigin-vector"
        src="/static/8c65c029635ba1dfbb6cb2c8d8cb257b/f6f78/oorigin-vector.png"
        srcset="/static/8c65c029635ba1dfbb6cb2c8d8cb257b/5a46d/oorigin-vector.png 300w,
/static/8c65c029635ba1dfbb6cb2c8d8cb257b/0a47e/oorigin-vector.png 600w,
/static/8c65c029635ba1dfbb6cb2c8d8cb257b/f6f78/oorigin-vector.png 932w"
        sizes="(max-width: 932px) 100vw, 932px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span>{: width="500px" }</p>
<p>이제 전처리한 데이터를 이후 모델링 과정에서 사용하기 위해 저장을 하도록 하자.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">TRAIN_INPUT_DATA <span class="token operator">=</span> <span class="token string">'train_input.npy'</span>
TRAIN_LABEL_DATA <span class="token operator">=</span> <span class="token string">'train_label.npy'</span>
TRAIN_CLEAN_DATA <span class="token operator">=</span> <span class="token string">'train_clean.csv'</span>
DATA_CONFIGS <span class="token operator">=</span> <span class="token string">'data_configs.json'</span>

<span class="token keyword">import</span> os
<span class="token comment"># 저장하는 디렉토리가 존재하지 않으면 생성</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>DATA_IN_PATH<span class="token punctuation">)</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>DATA_IN_PATH<span class="token punctuation">)</span>
    

<span class="token comment"># 전처리 된 데이터를 넘파이 형태로 저장</span>
np<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span>DATA_IN_PATH <span class="token operator">+</span> TRAIN_INPUT_DATA<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> train_inputs<span class="token punctuation">)</span>
np<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span>DATA_IN_PATH <span class="token operator">+</span> TRAIN_LABEL_DATA<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> train_labels<span class="token punctuation">)</span>

<span class="token comment"># 정제된 텍스트를 csv 형태로 저장</span>
clean_train_df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span>DATA_IN_PATH <span class="token operator">+</span> TRAIN_CLEAN_DATA<span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span>


<span class="token comment"># 데이터 사전을 json 형태로 저장</span>
json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>data_configs<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span>DATA_IN_PATH <span class="token operator">+</span> DATA_CONFIGS<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre></div>
<p>test 데이터도 동일하게 저장하자. 다만 test 데이터는 라벨 값이 없기 때문에 라벨은 따로 저장하지 않아도 된다. 추가로 test 데이터네 대해 저장해야 하는 값이 있는데 각 리뷰 데이터에 대해 리뷰에 대한 <code class="language-text">id</code>값을 저장해야 한다.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">test_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>DATA_IN_PATH <span class="token operator">+</span> <span class="token string">"testData.tsv"</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">"\t"</span><span class="token punctuation">,</span> quoting<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>

clean_test_reviews <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> review <span class="token keyword">in</span> test_data<span class="token punctuation">[</span><span class="token string">'review'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    clean_test_reviews<span class="token punctuation">.</span>append<span class="token punctuation">(</span>preprocessing<span class="token punctuation">(</span>review<span class="token punctuation">,</span> remove_stopwords <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


clean_test_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'review'</span><span class="token punctuation">:</span> clean_test_reviews<span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">:</span> test_data<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
test_id <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>test_data<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

text_sequences <span class="token operator">=</span> tokenizer<span class="token punctuation">.</span>texts_to_sequences<span class="token punctuation">(</span>clean_test_reviews<span class="token punctuation">)</span>
test_inputs <span class="token operator">=</span> pad_sequences<span class="token punctuation">(</span>text_sequences<span class="token punctuation">,</span> maxlen<span class="token operator">=</span>MAX_SEQUENCE_LENGTH<span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token string">'post'</span><span class="token punctuation">)</span>


TEST_INPUT_DATA <span class="token operator">=</span> <span class="token string">'test_input.npy'</span>
TEST_CLEAN_DATA <span class="token operator">=</span> <span class="token string">'test_clean.csv'</span>
TEST_ID_DATA <span class="token operator">=</span> <span class="token string">'test_id.npy'</span>

np<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span>DATA_IN_PATH <span class="token operator">+</span> TEST_INPUT_DATA<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> test_inputs<span class="token punctuation">)</span>
np<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span>DATA_IN_PATH <span class="token operator">+</span> TEST_ID_DATA<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> test_id<span class="token punctuation">)</span>
clean_test_df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span>DATA_IN_PATH <span class="token operator">+</span> TEST_CLEAN_DATA<span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span></code></pre></div>
<p>test 데이터를 전처리할 떄 한 가지 중요한 점은 토크나이저를 통해 인덱스 벡터로 만들 때 토크나이징 객체로 새롭게 만드는 것이 아니라, <code class="language-text">기존에 학습 데이터에 적용한 토크나이저 객체를 사용해야 한다는 것</code>이다. 만약 새롭게 만들 경우 Train 데이터와 Test 데이터에 대한 각 단어들의 인덱스가 달라져서 모델에 정상적으로 적용할 수 없기 때문이다.</p>
<p>지금까지의 결과를 아래와 같은 파일들에 각각 저장을 하였다.</p>
<blockquote>
<p>단어 인덱스 사전 및 개수 : data<em>configs.json<br/>
훈련 데이터 : train</em>input.npy, train<em>label.npy, train</em>clean.csv<br/>
테스트 데이터 : test<em>input.npy, test</em>clean.csv, test_id.npy</p>
</blockquote>
<p>이제 저장된 데이터를 이용해 다음 스탭을 진행하도록 하겠다.</p></section><hr/><div></div><footer class="post__PostFooter-z0x2sj-9 gDLYpk"><p>Published under <span><a class="post__FooterTagLink-z0x2sj-10 hKDtNq" href="/tag/ml-dl">ML-DL</a>, </span><span><a class="post__FooterTagLink-z0x2sj-10 hKDtNq" href="/tag/ml">ML</a>, </span><span><a class="post__FooterTagLink-z0x2sj-10 hKDtNq" href="/tag/nlp">NLP</a></span> on <time dateTime="2019-06-25T00:00:00.000Z">25 June, 2019</time>.</p></footer></article></div><div class="post__LeftSidebar-z0x2sj-1 guoPGM"><div class="post__TocWrapper-z0x2sj-3 hyzxOc"><nav class="toc__StyledNav-dzz3d3-0 kAaKev toc"></nav></div></div><button role="button" aria-label="Toggle table of contents" class="post__ToggleTocButton-z0x2sj-14 ewrmMm"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M432 416H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-128H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-128H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-128H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"></path></svg></button></div><section class="post__PostAddition-z0x2sj-11 dWgKtp"><div class="common__Container-sc-1wbwqlx-0 post__PostAdditionContent-z0x2sj-12 kWRivk"><div class="post__BioWrapper-z0x2sj-13 rrUdK"><section class="bio__StyledBio-j3ch0c-0 gmpFBk"><div class="avatar__StyledAvatar-sc-1papyes-0 cCbMYU gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:70px;height:70px"><img aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAEfUlEQVQ4y1WUbWxTVRjHL4YPLL4wYtwYg9FtdKwY5EUjwwDb4lxAEA1kycxUTFA0mChiNFPDNMNgVEwQiEJA3GQbrBvrqFBwBUb3ytp1YwO2MbqXru3t69Z262b0y897i53thyf3nHPv+d3/ef7PcwSXU8QpOpCfbpczHPLYYbcT8I9jc4h03e7F3NVNIOAnGJjAFfV9ZH+EIUSDIiE67ExPT9He1s7LW18n69lcslZnsWf3+zTob+D3T4Q3u5z/AyNPIRrkcT/8ICgpOVtWwZqMNSQ9lsjiBUkoFylIS05BmZZJ6cHvmJkJ4ZH2RGAxQI/bFQ55MTQVRHvpKqqUTFTJaSieWsrShBSSn0wmMzWDjNRlJMQnsG/f57g9njA0AgwfWQZ5Pe6wQp/XjdVmZ/uWHbz2Yg5PK5aTnqhAuTCNdEmhYlEKqckKUhIXEzc3nl/LzjE1GQinKJI6IaJOljsj5a229iIvLF/Lm1u3s161lizValRJy1EmKlmVtgKVYhkrlZnME+LYVbSbUGgyDIykTYg+7sx0iGNHfmZnTi57CnfyxkubKVyfR3HhLo5/tJ8f9r7H0QMfUrL3bVRLUnlGuZJhiwWfzxMWFAOUJ8FggLqaajavX8emFav5/XApRm0FFn0dYze1DOir8Q83ovn1e3bk5ZC3cQO3WtvDJsqC5NTFAqUXt1oM5K5ag/rEjzj7m2lXn8GsLqP/Ug1N5ScxXa7CqK9iR042u98qZKCvj4kJX3h/GOjzemZNmZoMYuowUpCfj99mpP2PCs58WUKXupyh62ouHPqW06UlTFga+ezdIgq2vcpk0D9bJXIIMkwOeRKQCvbBwADHS4sJ2jpwm29iNVxhfKSTgPSDoRYddy+r+cth5Ng3+zn4RYnUAKFZdTFHliey2nEpwU11Zdi76/GZGxHbriH23sTRo8dh+hO38QaBwUbOHT3A/Z5OJiQRnqjmiClsuVO8Xi/WwW4c3Rq8XTrEVkmV7jxdmnKGr19gpLEeq1FN57UKyQjZWVdM2woRQ6Lbz+l0YbtrwNd7CUuzlnu6i9zR1vGgpR7bLQ2D7WpGLf3SqTwxF0u4U6JvmIdj6aYRRcSRfkaaKhky1HJPU4O5shJLiwZLUwV9HTpcbk/MTSMXd7iXI4sOuw27FLYxq1SPfnq7TXRfOY2np15yuIbBq2ps5npuN/zC0J2Wh8D/QNEhyAB54JX62O/3MR3y09Bwgy3biugzVDLSUkXb+ZPoTx3DrDvF/ebfGL7bisvlxm4bmwXJguQQJoPjUt5EOk2dVFdr+ODjr3l0YRaqdQXY7hnw3K7lztUzNJ/7iQetVZLDlzlx5DCGpjb++TuETYKOSaIicGHfJ6VszCsiKTWbR+LXIiRsZG5SNunPF9Bj7mR8yCgZUYe1VY3VpGZaqs9Piw+RmpGLVquTjBGl+vXNqhSEJ55jzoJ1xCVuYP6STcSn5/N4Wj7zkrPRXzcQCnpxDPfjGOhg1HQB72gPxV8dQZiTQdz8VeS/8g7lZ2sYHR1GFO38C4HH48JXOTvxAAAAAElFTkSuQmCC" alt="winuss" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/f39bad8c29c07a4d4c5b9eb67697ccb3/75aa5/blogger.png 1x,
/static/f39bad8c29c07a4d4c5b9eb67697ccb3/97b93/blogger.png 1.5x,
/static/f39bad8c29c07a4d4c5b9eb67697ccb3/9adda/blogger.png 2x" /><img loading="lazy" width="70" height="70" srcset="/static/f39bad8c29c07a4d4c5b9eb67697ccb3/75aa5/blogger.png 1x,
/static/f39bad8c29c07a4d4c5b9eb67697ccb3/97b93/blogger.png 1.5x,
/static/f39bad8c29c07a4d4c5b9eb67697ccb3/9adda/blogger.png 2x" src="/static/f39bad8c29c07a4d4c5b9eb67697ccb3/75aa5/blogger.png" alt="winuss" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><h3 class="bio__AuthorName-j3ch0c-2 kStElJ">winuss</h3><p class="bio__AuthorDescription-j3ch0c-1 frcJlw">Every end is a <strong>new beginning</strong>.
            <a href="https://devtimes.com" rel="noopener" target="_blank">devtimes.com</a></p><ul class="social-channel-list__StyledSocialChannels-z1p8fq-0 cNysWr"><li class="social-channel-list__StyledSocialChannel-z1p8fq-1 htFYTF"><a href="https://github.com/winuss" target="_blank" rel="noopener" aria-label="github"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li></ul></section></div></div></section></main><footer class="style__StyledFooter-sc-1xdlo4d-0 hdhrBK"><div class="common__Container-sc-1wbwqlx-0 style__FooterContainer-sc-1xdlo4d-1 kcCrhV"><nav class="style__StyledNav-sc-1xdlo4d-4 cKJeHJ"><ul><li><a href="/rss.xml" rel="noopener noreferrer" class="style__FooterMenuItem-sc-1xdlo4d-5 evGsdC">RSS</a></li><li><a href="/sitemap.xml" rel="noopener noreferrer" class="style__FooterMenuItem-sc-1xdlo4d-5 evGsdC">Sitemap</a></li></ul></nav><div><p class="style__Copyright-sc-1xdlo4d-2 dkniVZ"><strong>DevTimes</strong> © <!-- -->2021</p><p class="style__DesignBy-sc-1xdlo4d-3 eysmNL">Theme by <a href="https://nehalist.io" target="_blank" rel="noopener">nehalist.io</a></p></div></div></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-168375315-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/nb-text-classification-pre";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-a8b2574222d925c54afd.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-057dc180d56b15804385.js"],"component---src-pages-archive-tsx":["/component---src-pages-archive-tsx-fdf2cd80a3f85b7fc325.js"],"component---src-pages-tags-tsx":["/component---src-pages-tags-tsx-958d9cb016ae8b948b75.js"],"component---src-templates-page-tsx":["/component---src-templates-page-tsx-7ec48fbcec09fea3ec81.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx-8a7ad919cf47b755089e.js"],"component---src-templates-posts-tsx":["/component---src-templates-posts-tsx-0e5d08b16e0a44a2a740.js"],"component---src-templates-tag-tsx":["/component---src-templates-tag-tsx-93f232bc138f470217e2.js"]};/*]]>*/</script><script src="/component---src-templates-post-tsx-8a7ad919cf47b755089e.js" async=""></script><script src="/6c18e55fdd71cb6af87612710cbe2c0cb61bdd56-92ca3db2def247415ce0.js" async=""></script><script src="/1bfc9850-693458f4bfc03c5b78c9.js" async=""></script><script src="/styles-85581d4dae49207538a9.js" async=""></script><script src="/app-a8b2574222d925c54afd.js" async=""></script><script src="/framework-737c3e16d462c41141c7.js" async=""></script><script src="/webpack-runtime-54fc4c4fe4b49e1e33de.js" async=""></script></body></html>