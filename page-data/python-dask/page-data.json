{"componentChunkName":"component---src-templates-post-tsx","path":"/python-dask","result":{"data":{"post":{"headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"Python 병렬 처리를 위한 Dask","path":"/python-dask","tags":["Python"],"excerpt":"시계열 자료는 인덱스가 날짜 혹은 시간인 데이터를 말한다. Pandas에서 시계열 자료를 생성하려면 인덱스를 `DatetimeIndex` 자료형으로 만들어야 한다.","created":"2020-11-01T00:00:00.000Z","createdPretty":"01 November, 2020","updated":"2020-11-01T00:00:00.000Z","updatedPretty":"01 November, 2020","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAA5ElEQVQoz3WRXW+CQBBF+f0+NSSmaY0f8clXHxvTqAhUFEhXRVnQiv6R25nRtSvVh5M7SzYnd1gn3h2x3P4IPC+yA8JVAV9pzL5zyUcE1zuBKgTzzWGJwUg5IxJHNPMlJlyXgjkb/JUWRErp1BvaTYcjD166paY7fEYKkyS7NbmTXmUsdex2hiSvENC6rf4A7nsXzXYfbquHhvuKl7cOpmkmbW35P2F9bW7IjBcKXrwmNhiFCT78WP7tRWS1tVd+JmUSfaKshFSfiRPmm/3fo9hCpZ83lCQur14KPN82oPyqr03zL7ig3+ECPaG6AAAAAElFTkSuQmCC","aspectRatio":2.857142857142857,"src":"/static/7ded931b1fc04adae4f34d5c9c234915/90823/cover.png","srcSet":"/static/7ded931b1fc04adae4f34d5c9c234915/dc47e/cover.png 200w,\n/static/7ded931b1fc04adae4f34d5c9c234915/9f2d5/cover.png 400w,\n/static/7ded931b1fc04adae4f34d5c9c234915/90823/cover.png 800w","sizes":"(max-width: 800px) 100vw, 800px"}}}},"html":"<p>큰 데이터를 처리하기 위해서는 병렬처리가 효율적인데, 그래서 Apache Spark의 pyspark를 많이들 사용한다. 속도는 매우 빠르지만 Pandas에 익숙한 사람들은 불편한 점이 있다. 이를 해소시켜 줄만한 라이브러리가 바로 Dask이다.\n(그 외 modin, ray, vaex등이 있는듯 하니 관심있다면 찾아보자.)</p>\n<h2 id=\"병렬-컴퓨팅parallel-computing이란\" style=\"position:relative;\"><a href=\"#%EB%B3%91%EB%A0%AC-%EC%BB%B4%ED%93%A8%ED%8C%85parallel-computing%EC%9D%B4%EB%9E%80\" aria-label=\"병렬 컴퓨팅parallel computing이란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>병렬 컴퓨팅(Parallel Computing)이란?</h2>\n<p>여러 단계 별로 구성된 작업을 수행할 때 각 단계에서 이전 작업이 완료되기를 기다리지 않고 이들이 동시에 처리되도록 하는 것이다.</p>\n<p>따라서 난이도는 각 작업의 특징에 따라 달라지는데, 각 작업의 시작과 끝을 제외하고 각 단계가 서로 독립적으로 수행되는 작업은 병렬화가 쉽고, 각 단계 사이의 많은 데이터가 전송되고 교환되어야 하는 작업은 병렬화가 어렵다.</p>\n<h2 id=\"dask-란\" style=\"position:relative;\"><a href=\"#dask-%EB%9E%80\" aria-label=\"dask 란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dask 란?</h2>\n<p>Dask는 Python 라이브러리로 기능면에서는 Apache Spark와 비슷하지만 numpy, pandas와 긴밀하게 연결되어 있어서 python 사용자들이 Spark보다 훨씬 쉽게 배우고 활용할 수 있고, 다임과 같은 두 가지 기능을 가진다.</p>\n<ol>\n<li>가상 데이터프레임</li>\n<li>병렬처리용 작업 스케줄러</li>\n</ol>\n<h2 id=\"가상-데이터프레임\" style=\"position:relative;\"><a href=\"#%EA%B0%80%EC%83%81-%EB%8D%B0%EC%9D%B4%ED%84%B0%ED%94%84%EB%A0%88%EC%9E%84\" aria-label=\"가상 데이터프레임 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>가상 데이터프레임</h2>\n<p>가상 데이터프레임은 Pandas 데이터프레임과 비슷한 기능을 제공하지만 실제로 모든 데이터가 메모리 상에 로드되어 있는 것이 아니라 하나 이상의 파일 혹인 데이터베이스에 존재하는 채로 처리할 수 있는 기능이다. 따라서 메모리 크기와 관계 없이 엄청나게 큰 CSV 파일을 가상 데이터프레임으로 로드하거나 같은 형식의 데이터를 가진 여러개의 CSV 파일을 하나의 가상 데이터프레임에 로드할 수 있다.</p>\n<p>실제로 Dask의 가상 데이터프레임을 어떻게 쓸 수 있는지  알아보기 위해 간단한 CSV 파일을 만들어 살펴보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>writefile data1<span class=\"token punctuation\">.</span>csv\ntime<span class=\"token punctuation\">,</span>temperature<span class=\"token punctuation\">,</span>humidity\n<span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span><span class=\"token number\">58</span>\n<span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token number\">57</span>\n<span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span><span class=\"token number\">57</span>\n<span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">26</span><span class=\"token punctuation\">,</span><span class=\"token number\">55</span>\n<span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span><span class=\"token number\">53</span>\n<span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span><span class=\"token number\">59</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Writing data1.csv</code></pre></div>\n<p>Dask 패키지가 설치 되어 있지 않다면 설치를 하고 해당 패키지를 임포트하자.</p>\n<p>Install</p>\n<ul>\n<li>conda install dask (anaconda environment)</li>\n<li>pip install \"dask[complete]\" (pip based installation)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> dask<span class=\"token punctuation\">.</span>dataframe <span class=\"token keyword\">as</span> dd</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> dd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"data1.csv\"</span><span class=\"token punctuation\">)</span>\ndf</code></pre></div>\n<div><strong>Dask DataFrame Structure:</strong></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>time</th>\n      <th>temperature</th>\n      <th>humidity</th>\n    </tr>\n    <tr>\n      <th>npartitions=1</th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th></th>\n      <td>int64</td>\n      <td>int64</td>\n      <td>int64</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<div>Dask Name: read-csv, 1 tasks</div>\n<p>사용법을 보면 기존에 Pandas 데이터프레임과 유사하지만 실제 결과를 보면 아직 데이터를 메모리에 읽지 않았기 때문에 값은 표시되지 않는다.</p>\n<p>값을 실제로 표시하려면 <code class=\"language-text\">head</code>, <code class=\"language-text\">tail</code> 명령을 내리면 해당 데이터를 읽어서 표시한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>time</th>\n      <th>temperature</th>\n      <th>humidity</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>22</td>\n      <td>58</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>21</td>\n      <td>57</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2</td>\n      <td>25</td>\n      <td>57</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3</td>\n      <td>26</td>\n      <td>55</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4</td>\n      <td>22</td>\n      <td>53</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>temperature<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">dd.Scalar&lt;series-..., dtype=float64&gt;</code></pre></div>\n<p>위의 경우 temperature 열의 평균을 구하기 위해 명령 입력하였지만 결과가 나오지 않는다. 그 이유는 <code class=\"language-text\">mean</code>는 연산 반환값의 결과가 아닌 작업(task)이기 때문이다. 구체적으로 어떤 작업인지를 보려면 <code class=\"language-text\">visualize</code> 매서드를 사용하여 작업 그래프(graph)를 볼 수 있다. 작업 그래프란 이 계산을 하기 위해 실제로 CPU가 해야할 일들의 순서도라고 생각하면 된다.</p>\n<p>이 작업의 값을 실제로 구하려면 결과로 받은 작업 객체의 <code class=\"language-text\">compute</code> 매서드를 호출해야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>temperature<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>compute<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">23.166666666666668</code></pre></div>\n<p>이번에는 이 값을 화씨로 변환해 보자</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>temperature <span class=\"token operator\">*</span> <span class=\"token number\">9</span> <span class=\"token operator\">/</span> <span class=\"token number\">5</span> <span class=\"token operator\">+</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>compute<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0    71.6\n1    69.8\n2    77.0\n3    78.8\n4    71.6\n5    73.4\nName: temperature, dtype: float64</code></pre></div>\n<p>이번에는 이 값으로 원래의 temperature 열을 갱신해보자. 이 때는 Pandas의 문법을 쓰지 못하고 다음과 같이 <code class=\"language-text\">assign</code> 메서드를 사용해야 한다. <code class=\"language-text\">assign</code> 메서드를 사용할 때는 <code class=\"language-text\">compute</code>를 할 필요가 없다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>assign<span class=\"token punctuation\">(</span>temperature<span class=\"token operator\">=</span>df<span class=\"token punctuation\">.</span>temperature <span class=\"token operator\">*</span> <span class=\"token number\">9</span> <span class=\"token operator\">/</span> <span class=\"token number\">5</span> <span class=\"token operator\">+</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>time</th>\n      <th>temperature</th>\n      <th>humidity</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>71.6</td>\n      <td>58</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>69.8</td>\n      <td>57</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2</td>\n      <td>77.0</td>\n      <td>57</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3</td>\n      <td>78.8</td>\n      <td>55</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4</td>\n      <td>71.6</td>\n      <td>53</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<p>자료형을 변환하거나 새로운 열을 추가하는 것도 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>assign<span class=\"token punctuation\">(</span>title<span class=\"token operator\">=</span>df<span class=\"token punctuation\">.</span>temperature<span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\" degree\"</span><span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>time</th>\n      <th>temperature</th>\n      <th>humidity</th>\n      <th>title</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>71.6</td>\n      <td>58</td>\n      <td>71.6 degree</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>69.8</td>\n      <td>57</td>\n      <td>69.8 degree</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2</td>\n      <td>77.0</td>\n      <td>57</td>\n      <td>77.0 degree</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3</td>\n      <td>78.8</td>\n      <td>55</td>\n      <td>78.8 degree</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4</td>\n      <td>71.6</td>\n      <td>53</td>\n      <td>71.6 degree</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<p>Apache Spark를 사용해본 사람이라면 Transformation과 Action의 개념과 유사하다는 것을 눈치 챘을것이다!</p>\n<h2 id=\"복수-데이터에-대한-가상-데이터프레임\" style=\"position:relative;\"><a href=\"#%EB%B3%B5%EC%88%98-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%97%90-%EB%8C%80%ED%95%9C-%EA%B0%80%EC%83%81-%EB%8D%B0%EC%9D%B4%ED%84%B0%ED%94%84%EB%A0%88%EC%9E%84\" aria-label=\"복수 데이터에 대한 가상 데이터프레임 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>복수 데이터에 대한 가상 데이터프레임</h2>\n<p>Dask는 가상 데이터프레임으로 원천 데이터 파일을 하나가 아닌 복수로 설정할 수도 있다. 예를 들어 앞서 보았던 <code class=\"language-text\">data1.dsv</code> 파일 이외에도 다음과 같이 <code class=\"language-text\">data2.csv</code>, <code class=\"language-text\">data3.csv</code> 파일이 있을 경우, 이 파일을 한 번에 하나의 데이터프레임으로 읽어들일 수도 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>writefile data2<span class=\"token punctuation\">.</span>csv\ntime<span class=\"token punctuation\">,</span>temperature<span class=\"token punctuation\">,</span>humidity\n<span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span><span class=\"token number\">58</span>\n<span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token number\">57</span>\n<span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span><span class=\"token number\">57</span>\n<span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">26</span><span class=\"token punctuation\">,</span><span class=\"token number\">55</span>\n<span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span><span class=\"token number\">53</span>\n<span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span><span class=\"token number\">59</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Writing data2.csv</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>writefile data3<span class=\"token punctuation\">.</span>csv\ntime<span class=\"token punctuation\">,</span>temperature<span class=\"token punctuation\">,</span>humidity\n<span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span><span class=\"token number\">58</span>\n<span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token number\">57</span>\n<span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span><span class=\"token number\">57</span>\n<span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">26</span><span class=\"token punctuation\">,</span><span class=\"token number\">55</span>\n<span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span><span class=\"token number\">53</span>\n<span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span><span class=\"token number\">59</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Writing data3.csv</code></pre></div>\n<p>복수 파일은 와일드카드(*) 기호를 이용하여 읽는다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> dd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">'data*.csv'</span><span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>compute<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">time           18\ntemperature    18\nhumidity       18\ndtype: int64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>temperature<span class=\"token punctuation\">.</span>describe<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>compute<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">count    18.000000\nmean     23.166667\nstd       1.823055\nmin      21.000000\n25%      22.000000\n50%      22.500000\n75%      24.500000\nmax      26.000000\nName: temperature, dtype: float64</code></pre></div>\n<h2 id=\"대량-데이터의-병렬-처리\" style=\"position:relative;\"><a href=\"#%EB%8C%80%EB%9F%89-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%9D%98-%EB%B3%91%EB%A0%AC-%EC%B2%98%EB%A6%AC\" aria-label=\"대량 데이터의 병렬 처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>대량 데이터의 병렬 처리</h2>\n<p>자 이제 Dask로 대량의 데이터를 처리해보자. 샘플로 쓸 데이터는 미국 정부가 발표하는 공개 정보 중 하나로 시카고의 범죄 관련 데이터이다.</p>\n<ul>\n<li><a href=\"https://catalog.data.gov/dataset/crimes-2001-to-present-398a4\">https://catalog.data.gov/dataset/crimes-2001-to-present-398a4</a></li>\n</ul>\n<p>다음 명령으로 이 데이터를 다운로드 받을 수 있다. CSV 파일의 크기가 1.3GB가 넘으므로 다운로드에 10분 이상 걸릴수 있다.</p>\n<p>(만약 윈도우라면 wget을 사용하기 위해 <a href=\"https://eternallybored.org/misc/wget/\">https://eternallybored.org/misc/wget/</a> 여기에서 wget 최신 버전을 받고 c:\\windows\\system32에 위치시키면 된다.)</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">!wget <span class=\"token operator\">-</span>O crime<span class=\"token punctuation\">.</span>csv https<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>data<span class=\"token punctuation\">.</span>cityofchicago<span class=\"token punctuation\">.</span>org<span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>views<span class=\"token operator\">/</span>ijzp<span class=\"token operator\">-</span>q8t2<span class=\"token operator\">/</span>rows<span class=\"token punctuation\">.</span>csv?accessType<span class=\"token operator\">=</span>DOWNLOAD</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">...... .......... .......... ..........  291K\n1218900K .......... .......... .......... .......... .......... 11.7M\n1218950K .......... .......... .......... .......... .......... 9.51M\n1219000K .......... .......... .......... .......... .......... 14.1M\n1219050K .......... .......... .......... .......... .......... 12.5M\n1219100K .......... .......... .......... .......... .......... 10.1M\n1219150K .......... .......... .......... .......... ..........  292K\n1219200K .......... .......... .......... .......... .......... 9.68M\n1219250K .......... .......... .......... .......... .......... 11.6M\n1219300K .......... .......... .......... .......... .......... 12.1M\n1219350K .......... .......... .......... .......... .......... 11.0M\n1219400K .......... .......... .......... .......... .......... 10.7M\n1219450K .......... .......... .......... .......... ..........  293K\n1219500K .......... .......... .......... .......... .......... 11.5M\n1219550K .......... .......... .......... .......... .......... 11.2M\n1219600K .......... .......... .......... .......... .......... 9.82M\n1219650K .......... .......... .......... .......... .......... 11.7M\n1219700K .......... .......... .......... .......... .......... 11.9M\n1219750K .......... .......... .......... .......... ..........  238K\n1219800K .......... .......... .......... .......... .......... 11.3M\n1219850K .......... .......... .......... .......... .......... 11.7M\n1219900K .......... .......... .......... .......... .......... 12.0M\n1219950K .......... .......... .......... .......... .......... 11.7M\n1220000K .......... .......... .......... .......... .......... 9.24M\n1220050K .......... .......... .......... .......... ..........  293K\n1220100K .......... .......... .......... .......... .......... 11.9M\n1220150K .......... .......... .......... .......... .......... 12.2M\n1220200K .......... .......... .......... .......... .......... 11.2M\n1220250K .......... .......... .......... .......... .......... 11.3M\n1220300K .......... .......... .......... .......... .......... 12.1M\n1220350K .......... .......... .......... .......... ..........  292K\n1220400K .......... .......... .......... .......... .......... 11.8M\n1220450K .......... .......... .......... .......... .......... 11.6M\n1220500K .......... .......... .......... .......... .......... 9.90M\n1220550K .......... .......... .......... .......... .......... 8.73M\n1220600K .......... .......... .......... .......... .......... 12.4M\n1220650K .......... .......... .......... .......... .......... 3.45M\n1220700K .......... .......... .......... .......... ..........  315K\n1220750K .......... .......... .......... .......... .......... 12.7M\n1220800K .......... .......... .......... .......... .......... 9.12M\n1220850K .......... .......... .......... .......... .......... 9.26M\n1220900K .......... .......... .......... .......... .......... 11.2M\n1220950K .......... .......... .......... .......... .......... 12.1M\n1221000K .......... .......... .......... .......... ..........  296K\n1221050K .......... .......... .......... .......... .......... 13.0M\n1221100K .......... .......... .......... .......... .......... 12.3M\n1221150K .......... .......... .......... .......... .......... 10.1M\n1221200K .......... .......... .......... .......... .......... 8.55M\n1221250K .......... .......... .......... .......... .......... 11.6M\n1221300K .......... .......... .......... .......... ..........  249K\n1221350K .......... .......... .......... .......... .......... 12.1M\n1221400K .......... .......... .......... .......... .......... 10.8M\n1221450K .......... .......... .......... .......... .......... 10.7M\n1221500K .......... .......... .......... .......... .......... 13.7M\n1221550K .......... .......... .......... .......... .......... 11.8M\n1221600K .......... .......... .......... .......... ..........  665K\n1221650K .......... .......... .......... .......... ..........  502K\n1221700K .......... .......... .......... .......... .......... 12.0M\n1221750K .......... .......... .......... .......... .......... 9.97M\n1221800K .......... .......... .......... .......... .......... 13.0M\n1221850K .......... .......... .......... .......... .......... 11.0M\n1221900K .......... .......... .......... .......... .......... 12.7M\n1221950K .......... .......... .......... .......... ..........  293K\n1222000K .......... .......... .......... .......... .......... 12.0M\n1222050K .......... .......... .......... .......... .......... 11.6M\n1222100K .......... .......... .......... .......... .......... 11.7M\n1222150K .......... .......... .......... .......... .......... 12.0M\n1222200K .......... .......... .......... .......... .......... 11.1M\n1222250K .......... .......... .......... .......... .......... 1.50M\n1222300K .......... .......... .......... .......... ..........  355K\n1222350K .......... .......... .......... .......... .......... 10.3M\n1222400K .......... .......... .......... .......... .......... 8.38M\n1222450K .......... .......... .......... .......... .......... 11.3M\n1222500K .......... .......... .......... .......... .......... 12.0M\n1222550K .......... .......... .......... .......... .......... 10.6M\n1222600K .......... .......... .......... .......... ..........  297K\n1222650K .......... .......... .......... .......... .......... 14.1M\n1222700K .......... .......... .......... .......... .......... 9.30M\n1222750K .......... .......... .......... .......... .......... 11.5M\n1222800K .......... .......... .......... .......... .......... 9.04M\n1222850K .......... .......... .......... .......... .......... 11.0M\n1222900K .......... .......... .......... .......... ..........  685K\n1222950K .......... .......... .......... .......... ..........  376K\n1223000K .......... .......... .......... .......... .......... 10.8M\n1223050K .......... .......... .......... .......... .......... 11.9M\n1223100K .......... .......... .......... .......... .......... 11.5M\n1223150K .......... .......... .......... .......... .......... 12.4M\n1223200K .......... .......... .......... .......... .......... 9.14M\n1223250K .......... .......... .......... .......... ..........  296K\n1223300K .......... .......... .......... .......... .......... 11.7M\n1223350K .......... .......... .......... .......... .......... 12.1M\n1223400K .......... .......... .......... .......... .......... 10.1M\n1223450K .......... .......... .......... .......... .......... 13.1M\n1223500K .......... .......... .......... .......... .......... 11.4M\n1223550K .......... .......... .......... .......... .......... 12.3M\n1223600K .......... .......... .......... .......... ..........  294K\n1223650K .......... .......... .......... .......... .......... 12.2M\n1223700K .......... .......... .......... .......... .......... 11.6M\n1223750K .......... .......... .......... .......... .......... 11.6M\n1223800K .......... .......... .......... .......... .......... 10.2M\n1223850K .......... .......... .......... .......... .......... 12.9M\n1223900K .......... .......... .......... .......... ..........  294K\n1223950K .......... .......... .......... .......... .......... 16.0M\n1224000K .......... .......... .......... .......... .......... 9.55M\n1224050K .......... .......... .......... .......... .......... 11.6M\n1224100K .......... .......... .......... .......... .......... 11.2M\n1224150K .......... .......... .......... .......... .......... 11.9M\n1224200K .......... .......... .......... .......... .......... 1.24M\n1224250K .......... .......... .......... .......... ..........  372K\n1224300K .......... .......... .......... .......... .......... 13.5M\n1224350K .......... .......... .......... .......... .......... 12.1M\n1224400K .......... .......... .......... .......... .......... 8.88M\n1224450K .......... .......... .......... .......... .......... 11.2M\n1224500K .......... .......... .......... .......... .......... 11.7M\n1224550K .......... .......... .......... .......... ..........  244K\n1224600K .......... .......... .......... .......... .......... 11.3M\n1224650K .......... .......... .......... .......... .......... 10.3M\n1224700K .......... .......... .......... .......... .......... 13.8M\n1224750K .......... .......... .......... .......... .......... 12.3M\n1224800K .......... .......... .......... .......... .......... 9.29M\n1224850K .......... .......... .......... .......... .......... 11.6M\n1224900K .......... .......... .......... .......... ..........  296K\n1224950K .......... .......... .......... .......... .......... 7.57M\n1225000K .......... .......... .......... .......... .......... 11.0M\n1225050K .......... .......... .......... .......... .......... 14.8M\n1225100K .......... .......... .......... .......... .......... 11.1M\n1225150K .......... .......... .......... .......... .......... 12.4M\n1225200K .......... .......... .......... .......... ..........  297K\n1225250K .......... .......... .......... .......... .......... 11.7M\n1225300K .......... .......... .......... .......... .......... 8.52M\n1225350K .......... .......... .......... .......... .......... 11.6M\n1225400K .......... .......... .......... .......... .......... 11.4M\n1225450K .......... .......... .......... .......... .......... 8.07M\n1225500K .......... .......... .......... .......... .......... 11.7M\n1225550K .......... .......... .......... .......... ..........  301K\n1225600K .......... .......... .......... .......... .......... 7.09M\n1225650K .......... .......... .......... .......... .......... 14.4M\n1225700K .......... .......... .......... .......... .......... 9.71M\n1225750K .......... .......... .......... .......... .......... 9.20M\n1225800K .......... .......... .......... .......... .......... 11.6M\n1225850K .......... .......... .......... .......... ..........  302K\n1225900K .......... .......... .......... .......... .......... 10.3M\n1225950K .......... .......... .......... .......... .......... 9.68M\n1226000K .......... .......... .......... .......... .......... 9.45M\n1226050K .......... .......... .......... .......... .......... 11.7M\n1226100K .......... .......... .......... .......... .......... 8.02M\n1226150K .......... .......... .......... .......... .......... 11.8M\n1226200K .......... .......... .......... .......... ..........  247K\n1226250K .......... .......... .......... .......... .......... 12.0M\n1226300K .......... .......... .......... .......... .......... 11.7M\n1226350K .......... .......... .......... .......... .......... 11.3M\n1226400K .......... .......... .......... .......... .......... 9.61M\n1226450K .......... .......... .......... .......... .......... 12.1M\n1226500K .......... .......... .......... .......... ..........  295K\n1226550K .......... .......... .......... .......... .......... 13.4M\n1226600K .......... .......... .......... .......... .......... 10.9M\n1226650K .......... .......... .......... .......... .......... 12.1M\n1226700K .......... .......... .......... .......... .......... 9.85M\n1226750K .......... .......... .......... .......... .......... 14.1M\n1226800K .......... .......... .......... .......... .......... 2.31M\n1226850K .......... .......... .......... .......... ..........  327K\n1226900K .......... .......... .......... .......... .......... 11.7M\n1226950K .......... .......... .......... .......... .......... 11.4M\n1227000K .......... .......... .......... .......... .......... 11.1M\n1227050K .......... .......... .......... .......... .......... 9.91M\n1227100K .......... .......... .......... .......... .......... 13.9M\n1227150K .......... .......... .......... .......... ..........  296K\n1227200K .......... .......... .......... .......... .......... 8.93M\n1227250K .......... .......... .......... .......... .......... 12.0M\n1227300K .......... .......... .......... .......... .......... 11.2M\n1227350K .......... .......... .......... .......... .......... 12.1M\n1227400K .......... .......... .......... .......... .......... 11.2M\n1227450K .......... .......... .......... .......... .......... 9.48M\n1227500K .......... .......... .......... .......... ..........  299K\n1227550K .......... .......... .......... .......... .......... 10.4M\n1227600K .......... .......... .......... .......... .......... 9.38M\n1227650K .......... .......... .......... .......... .......... 12.0M\n1227700K .......... .......... .......... .......... .......... 11.5M\n1227750K .......... .......... .......... .......... .......... 9.85M\n1227800K .......... .......... .......... .......... ..........  247K\n1227850K .......... .......... .......... .......... .......... 13.2M\n1227900K .......... .......... .......... .......... ..........  532K\n1227950K .......... .......... .......... .......... .......... 15.7M\n1228000K .......... .......... .......... .......... .......... 19.8M\n1228050K .......... .......... .......... .......... .......... 23.8M\n1228100K .......... .......... .......... .......... .......... 33.4M\n1228150K .......... .......... .......... .......... ..........  571K\n1228200K .......... .......... .......... .......... .......... 11.0M\n1228250K .......... .......... .......... .......... .......... 10.5M\n1228300K .......... .......... .......... .......... .......... 12.0M\n1228350K .......... .......... .......... .......... .......... 11.1M\n1228400K .......... .......... .......... .......... .......... 10.6M\n1228450K .......... .......... .......... .......... .......... 1.27M\n1228500K .......... .......... .......... .......... ..........  374K\n1228550K .......... .......... .......... .......... .......... 11.0M\n1228600K .......... .......... .......... .......... .......... 11.2M\n1228650K .......... .......... .......... .......... .......... 12.3M\n1228700K .......... .......... .......... .......... .......... 11.6M\n1228750K .......... .......... .......... .......... .......... 11.6M\n1228800K .......... .......... .......... .......... ..........  295K\n1228850K .......... .......... .......... .......... .......... 11.6M\n1228900K .......... .......... .......... .......... .......... 11.9M\n1228950K .......... .......... .......... .......... .......... 9.56M\n1229000K .......... .......... .......... .......... .......... 10.9M\n1229050K .......... .......... .......... .......... .......... 14.5M\n1229100K .......... .......... .......... .......... .......... 12.2M\n1229150K .......... .......... .......... .......... ..........  296K\n1229200K .......... .......... .......... .......... .......... 11.8M\n1229250K .......... .......... .......... .......... .......... 11.2M\n1229300K .......... .......... .......... .......... .......... 12.0M\n1229350K .......... .......... .......... .......... .......... 10.5M\n1229400K .......... .......... .......... .......... .......... 12.1M\n1229450K .......... .......... .......... .......... .......... 11.9M\n1229500K .......... .......... .......... .......... ..........  245K\n1229550K .......... .......... .......... .......... .......... 10.8M\n1229600K .......... .......... .......... .......... .......... 11.7M\n1229650K .......... .......... .......... .......... .......... 11.6M\n1229700K .......... .......... .......... .......... .......... 12.0M\n1229750K .......... .......... .......... .......... .......... 11.0M\n1229800K .......... .......... .......... .......... ..........  297K\n1229850K .......... .......... .......... .......... .......... 13.2M\n1229900K .......... .......... .......... .......... .......... 11.9M\n1229950K .......... .......... .......... .......... .......... 8.50M\n1230000K .......... .......... .......... .......... .......... 13.2M\n1230050K .......... .......... .......... .......... .......... 11.5M\n1230100K .......... .......... .......... .......... .......... 12.3M\n1230150K .......... .......... .......... .......... ..........  296K\n1230200K .......... .......... .......... .......... .......... 14.5M\n1230250K .......... .......... .......... .......... .......... 11.9M\n1230300K .......... .......... .......... .......... .......... 10.7M\n1230350K .......... .......... .......... .......... .......... 10.3M\n1230400K .......... .......... .......... .......... .......... 11.6M\n1230450K .......... .......... .......... .......... .......... 11.4M\n1230500K .......... .......... .......... .......... ..........  299K\n1230550K .......... .......... .......... .......... .......... 11.4M\n1230600K .......... .......... .......... .......... .......... 11.9M\n1230650K .......... .......... .......... .......... .......... 8.88M\n1230700K .......... .......... .......... .......... .......... 17.3M\n1230750K .......... .......... .......... .......... .......... 9.29M\n1230800K .......... .......... .......... .......... .......... 11.7M\n1230850K .......... .......... .......... .......... ..........  298K\n1230900K .......... .......... .......... .......... .......... 13.7M\n1230950K .......... .......... .......... .......... .......... 8.85M\n1231000K .......... .......... .......... .......... .......... 12.1M\n1231050K .......... .......... .......... .......... .......... 15.8M\n1231100K .......... .......... .......... .......... .......... 10.8M\n1231150K .......... .......... .......... .......... .......... 9.94M\n1231200K .......... .......... .......... .......... ..........  247K\n1231250K .......... .......... .......... .......... .......... 11.8M\n1231300K .......... .......... .......... .......... .......... 9.64M\n1231350K .......... .......... .......... .......... .......... 13.5M\n1231400K .......... .......... .......... .......... .......... 12.5M\n1231450K .......... .......... .......... .......... .......... 11.5M\n1231500K .......... .......... .......... .......... .......... 11.7M\n1231550K .......... .......... .......... .......... ..........  139K\n1231600K .......... .......... .......... .......... .......... 17.9M\n1231650K .......... .......... .......... .......... .......... 28.4M\n1231700K .......... .......... .......... .......... .......... 21.4M\n1231750K .......... .......... .......... .......... .......... 21.0M\n1231800K .......... .......... .......... .......... .......... 14.8M\n1231850K .......... .......... .......... .......... .......... 22.9M\n1231900K .......... .......... .......... .......... .......... 27.3M\n1231950K .......... .......... .......... .......... .......... 26.0M\n1232000K .......... .......... .......... .......... .......... 20.2M\n1232050K .......... .......... .......... .......... .......... 21.5M\n1232100K .......... .......... .......... .......... .......... 24.6M\n1232150K .......... .......... .......... .......... ..........  297K\n1232200K .......... .......... .......... .......... .......... 8.90M\n1232250K .......... .......... .......... .......... .......... 7.73M\n1232300K .......... .......... .......... .......... .......... 9.98M\n1232350K .......... .......... .......... .......... .......... 6.42M\n1232400K .......... .......... .......... .......... ..........  298K\n1232450K .......... .......... .......... .......... .......... 9.66M\n1232500K .......... .......... .......... .......... .......... 8.40M\n1232550K .......... .......... .......... .......... .......... 7.90M\n1232600K .......... .......... .......... .......... .......... 9.12M\n1232650K .......... .......... .......... .......... .......... 7.96M\n1232700K .......... .......... .......... .......... ..........  248K\n1232750K .......... .......... .......... .......... .......... 9.37M\n1232800K .......... .......... .......... .......... .......... 12.2M\n1232850K .......... .......... .......... .......... .......... 11.7M\n1232900K .......... .......... .......... .......... .......... 11.8M\n1232950K .......... .......... .......... .......... ..........  668K\n1233000K .......... .......... .......... .......... ..........  486K\n1233050K .......... .......... ..                               15.4M=13m22s\n\n2020-11-10 11:06:21 (1.50 MB/s) - &#39;crime.csv&#39; saved [1262665799]</code></pre></div>\n<p>파일을 다운로드 받은 후에는 가상 데이터프레임으로 읽어들인다. 구체적인 데이터를 아직 모르기 때문에 우선 문자열 자료형으로 읽어들인다. 또 <code class=\"language-text\">error_bad_lines</code> 옵션을 <code class=\"language-text\">False</code>로 해서 오류가 나는 데이터는 생략하도록 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> dd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"crime.csv\"</span><span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> error_bad_lines<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> warn_bad_lines<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\ndf</code></pre></div>\n<div><strong>Dask DataFrame Structure:</strong></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ID</th>\n      <th>Case Number</th>\n      <th>Date</th>\n      <th>Block</th>\n      <th>IUCR</th>\n      <th>Primary Type</th>\n      <th>Description</th>\n      <th>Location Description</th>\n      <th>Arrest</th>\n      <th>Domestic</th>\n      <th>Beat</th>\n      <th>District</th>\n      <th>Ward</th>\n      <th>Community Area</th>\n      <th>FBI Code</th>\n      <th>X Coordinate</th>\n      <th>Y Coordinate</th>\n      <th>Year</th>\n      <th>Updated On</th>\n      <th>Latitude</th>\n      <th>Longitude</th>\n      <th>Location</th>\n    </tr>\n    <tr>\n      <th>npartitions=20</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th></th>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n      <td>object</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<div>Dask Name: read-csv, 20 tasks</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>tail<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ID</th>\n      <th>Case Number</th>\n      <th>Date</th>\n      <th>Block</th>\n      <th>IUCR</th>\n      <th>Primary Type</th>\n      <th>Description</th>\n      <th>Location Description</th>\n      <th>Arrest</th>\n      <th>Domestic</th>\n      <th>...</th>\n      <th>Ward</th>\n      <th>Community Area</th>\n      <th>FBI Code</th>\n      <th>X Coordinate</th>\n      <th>Y Coordinate</th>\n      <th>Year</th>\n      <th>Updated On</th>\n      <th>Latitude</th>\n      <th>Longitude</th>\n      <th>Location</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>196819</th>\n      <td>7026076</td>\n      <td>HR432572</td>\n      <td>07/15/2009 04:00:00 PM</td>\n      <td>007XX E 79TH ST</td>\n      <td>0620</td>\n      <td>BURGLARY</td>\n      <td>UNLAWFUL ENTRY</td>\n      <td>APARTMENT</td>\n      <td>false</td>\n      <td>false</td>\n      <td>...</td>\n      <td>6</td>\n      <td>44</td>\n      <td>05</td>\n      <td>1182734</td>\n      <td>1852793</td>\n      <td>2009</td>\n      <td>02/28/{</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>196820</th>\n      <td>\"error\" : true</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>196821</th>\n      <td>\"message\" : \"Internal error\"</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>196822</th>\n      <td>\"status\" : 500</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>196823</th>\n      <td>}</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 22 columns</p>\n</div>\n<p>이제 이 데이터프레임으로 분석을 시작해보자. 데이터 크기가 큰 만큼 시간이 오래 걸리기 때문에 친절하게도 Dask는 작업 진행도를 알 수 있는 <code class=\"language-text\">ProgressBar</code>라는 것을 제공한다. 다음과 같이 <code class=\"language-text\">ProgressBar</code>를 만들고 등록한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> dask<span class=\"token punctuation\">.</span>diagnostics <span class=\"token keyword\">import</span> ProgressBar \n\npbar <span class=\"token operator\">=</span> ProgressBar<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npbar<span class=\"token punctuation\">.</span>register<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>일단 등록하면 작업의 진행도를 프로그레스바 형태로 알려준다. 우선 각 열의 데이터 개수를 세어보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>time\ndf<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>compute<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[########################################] | 100% Completed | 21.9s\nWall time: 21.9 s\n\n\n\n\n\nID                      5366005\nCase Number             5365999\nDate                    5366001\nBlock                   5366001\nIUCR                    5366001\nPrimary Type            5366001\nDescription             5366001\nLocation Description    5359222\nArrest                  5366001\nDomestic                5366001\nBeat                    5366001\nDistrict                5365954\nWard                    4751265\nCommunity Area          4753051\nFBI Code                5366001\nX Coordinate            5285054\nY Coordinate            5285054\nYear                    5366001\nUpdated On              5366001\nLatitude                5285053\nLongitude               5285053\nLocation                5285053\ndtype: int64</code></pre></div>\n<p>데이터양이 많은 경우 이렇게 데이터 수를 세는 것만으로도 20초가 넘게 걸렸다.</p>\n<p>Dask는 이러한 대량 데이터의 분석 작업을 돕기 위한 작업 스케줄러(task scheduler)라는 것을 제공한다. 작업 스케줄러는 하나의 작업을 여러개의 쓰레드, 프로세스, 노드 등이 나누어 분담하도록 한다.</p>\n<p>현재 Dask에서 제공하는 스케줄러의 종류는 다음과 같다.</p>\n<ul>\n<li>dask.get : 단일 쓰레드</li>\n<li>dask.threaded.get : 멀티 쓰레드 풀(pool)</li>\n<li>dask.mutiprocessing.get : 멀티 프로세스 풀</li>\n<li>distributed.Client.get : 여러대의 컴퓨터에서 분산 처리</li>\n</ul>\n<p>병렬처리를 위해서는 어떠한 병렬 처리 방식을 사용할지, 작업 프로세스의 갯수는 어떻게 할지 등은 <code class=\"language-text\">compute</code> 명령에서 인수로 설정해야 한다.</p>\n<p>다음 코드는 멀티프로세싱을 하고 2개의 CPU 코어를 동시에 사용하도록 설정한 예이다. (물론 이 코드가 실행되는 컴튜터가 실제로 2개 이상의 코어를 가지고 있어야 성능이 개선된다.)</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>time\ndf<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>compute<span class=\"token punctuation\">(</span>scheduler<span class=\"token operator\">=</span><span class=\"token string\">'processes'</span><span class=\"token punctuation\">,</span> num_workers<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[########################################] | 100% Completed | 15.6s\nWall time: 15.6 s\n\n\n\n\n\nID                      5366005\nCase Number             5365999\nDate                    5366001\nBlock                   5366001\nIUCR                    5366001\nPrimary Type            5366001\nDescription             5366001\nLocation Description    5359222\nArrest                  5366001\nDomestic                5366001\nBeat                    5366001\nDistrict                5365954\nWard                    4751265\nCommunity Area          4753051\nFBI Code                5366001\nX Coordinate            5285054\nY Coordinate            5285054\nYear                    5366001\nUpdated On              5366001\nLatitude                5285053\nLongitude               5285053\nLocation                5285053\ndtype: int64</code></pre></div>\n<p>실행되는 컴퓨터의 사양에 따라 다르긴 하겠지만, 처리속도가 빨라진 것을 볼 수 있다. </p>\n<p>좀더 자세히 알아 보고 싶다면, 공식 문서를 살펴보자.</p>\n<blockquote>\n<p>DASK Document (<a href=\"https://docs.dask.org/\">https://docs.dask.org/</a>)</p>\n</blockquote>\n<p>출처 : 데이터사이언스 스쿨(<a href=\"http://datascienceschool.net\">http://datascienceschool.net</a>)</p>"},"primaryTag":{"name":"Python","color":"#445788"}},"pageContext":{"postId":"05a3aea1-6c02-5466-8d7a-0f71b92198cc","primaryTag":"Python"}}}