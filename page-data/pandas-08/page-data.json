{"componentChunkName":"component---src-templates-post-tsx","path":"/pandas-08","result":{"data":{"post":{"headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"DataFrame 시계열 자료 다루기","path":"/pandas-08","tags":["Python"],"excerpt":"시계열 자료는 인덱스가 날짜 혹은 시간인 데이터를 말한다. Pandas에서 시계열 자료를 생성하려면 인덱스를 `DatetimeIndex` 자료형으로 만들어야 한다.","created":"2020-10-31T00:00:00.000Z","createdPretty":"31 October, 2020","updated":"2020-10-31T00:00:00.000Z","updatedPretty":"31 October, 2020","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAA5ElEQVQoz3WRXW+CQBBF+f0+NSSmaY0f8clXHxvTqAhUFEhXRVnQiv6R25nRtSvVh5M7SzYnd1gn3h2x3P4IPC+yA8JVAV9pzL5zyUcE1zuBKgTzzWGJwUg5IxJHNPMlJlyXgjkb/JUWRErp1BvaTYcjD166paY7fEYKkyS7NbmTXmUsdex2hiSvENC6rf4A7nsXzXYfbquHhvuKl7cOpmkmbW35P2F9bW7IjBcKXrwmNhiFCT78WP7tRWS1tVd+JmUSfaKshFSfiRPmm/3fo9hCpZ83lCQur14KPN82oPyqr03zL7ig3+ECPaG6AAAAAElFTkSuQmCC","aspectRatio":2.857142857142857,"src":"/static/7ded931b1fc04adae4f34d5c9c234915/90823/cover.png","srcSet":"/static/7ded931b1fc04adae4f34d5c9c234915/dc47e/cover.png 200w,\n/static/7ded931b1fc04adae4f34d5c9c234915/9f2d5/cover.png 400w,\n/static/7ded931b1fc04adae4f34d5c9c234915/90823/cover.png 800w","sizes":"(max-width: 800px) 100vw, 800px"}}}},"html":"<h2 id=\"datetimeindex-인덱스\" style=\"position:relative;\"><a href=\"#datetimeindex-%EC%9D%B8%EB%8D%B1%EC%8A%A4\" aria-label=\"datetimeindex 인덱스 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DatetimeIndex 인덱스</h2>\n<p>시계열 자료는 인덱스가 날짜 혹은 시간인 데이터를 말한다. Pandas에서 시계열 자료를 생성하려면 인덱스를 <code class=\"language-text\">DatetimeIndex</code> 자료형으로 만들어야 한다. <code class=\"language-text\">DatetimeIndex</code>는 특정한 순간에 기록된 타임스탬프(timestamp) 형식의 시계열 자료를 다루기 위한 인덱스이다. 타임스탬프 인덱스의 라벨값이 반드시 일정한 간격일 필요는 없다.</p>\n<p><code class=\"language-text\">DatetimeIndex</code> 인덱스는 다음과 같은 보조 함수를 사용하여 생성한다.</p>\n<ul>\n<li>pd.to_datetime 함수</li>\n<li>pd.date_range 함수</li>\n</ul>\n<p><code class=\"language-text\">pd.to_datetime</code> 함수를 쓰면 날짜/시간을 나타내는 문자열을 자동으로 datetime 자료형으로 바꾼 후 <code class=\"language-text\">DatetimeIndex</code> 자료형 인덱스를 생성한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd \ndate_str <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"2018, 1, 1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2018, 1, 4\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2018, 1, 5\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2018, 1, 6\"</span><span class=\"token punctuation\">]</span>\nidx <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>to_datetime<span class=\"token punctuation\">(</span>date_str<span class=\"token punctuation\">)</span>\nidx</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">DatetimeIndex([&#39;2018-01-01&#39;, &#39;2018-01-04&#39;, &#39;2018-01-05&#39;, &#39;2018-01-06&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)</code></pre></div>\n<p>이렇게 만들어진 인덱스를 사용하여 시리즈나 데이터프레임을 생성하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np \nnp<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>seed<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\ns <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>randn<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span>idx<span class=\"token punctuation\">)</span>\ns</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2018-01-01    1.764052\n2018-01-04    0.400157\n2018-01-05    0.978738\n2018-01-06    2.240893\ndtype: float64</code></pre></div>\n<p><code class=\"language-text\">pd.to_datetime</code> 함수를 쓰면 모든 날짜/시간을 일일히 입력할 필요없이 시작일과 종료일 또는 시작일과 기간을 입력하면 범위 내의 인덱스를 생성해 준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pd<span class=\"token punctuation\">.</span>date_range<span class=\"token punctuation\">(</span><span class=\"token string\">\"2018-4-1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2018-4-30\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">DatetimeIndex([&#39;2018-04-01&#39;, &#39;2018-04-02&#39;, &#39;2018-04-03&#39;, &#39;2018-04-04&#39;,\n               &#39;2018-04-05&#39;, &#39;2018-04-06&#39;, &#39;2018-04-07&#39;, &#39;2018-04-08&#39;,\n               &#39;2018-04-09&#39;, &#39;2018-04-10&#39;, &#39;2018-04-11&#39;, &#39;2018-04-12&#39;,\n               &#39;2018-04-13&#39;, &#39;2018-04-14&#39;, &#39;2018-04-15&#39;, &#39;2018-04-16&#39;,\n               &#39;2018-04-17&#39;, &#39;2018-04-18&#39;, &#39;2018-04-19&#39;, &#39;2018-04-20&#39;,\n               &#39;2018-04-21&#39;, &#39;2018-04-22&#39;, &#39;2018-04-23&#39;, &#39;2018-04-24&#39;,\n               &#39;2018-04-25&#39;, &#39;2018-04-26&#39;, &#39;2018-04-27&#39;, &#39;2018-04-28&#39;,\n               &#39;2018-04-29&#39;, &#39;2018-04-30&#39;],\n              dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pd<span class=\"token punctuation\">.</span>date_range<span class=\"token punctuation\">(</span>start<span class=\"token operator\">=</span><span class=\"token string\">\"2018-4-1\"</span><span class=\"token punctuation\">,</span> periods<span class=\"token operator\">=</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">DatetimeIndex([&#39;2018-04-01&#39;, &#39;2018-04-02&#39;, &#39;2018-04-03&#39;, &#39;2018-04-04&#39;,\n               &#39;2018-04-05&#39;, &#39;2018-04-06&#39;, &#39;2018-04-07&#39;, &#39;2018-04-08&#39;,\n               &#39;2018-04-09&#39;, &#39;2018-04-10&#39;, &#39;2018-04-11&#39;, &#39;2018-04-12&#39;,\n               &#39;2018-04-13&#39;, &#39;2018-04-14&#39;, &#39;2018-04-15&#39;, &#39;2018-04-16&#39;,\n               &#39;2018-04-17&#39;, &#39;2018-04-18&#39;, &#39;2018-04-19&#39;, &#39;2018-04-20&#39;,\n               &#39;2018-04-21&#39;, &#39;2018-04-22&#39;, &#39;2018-04-23&#39;, &#39;2018-04-24&#39;,\n               &#39;2018-04-25&#39;, &#39;2018-04-26&#39;, &#39;2018-04-27&#39;, &#39;2018-04-28&#39;,\n               &#39;2018-04-29&#39;, &#39;2018-04-30&#39;],\n              dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)</code></pre></div>\n<p><code class=\"language-text\">freq</code> 인수로 특정한 날짜만 생성되도록 할 수도 있다. 많이 사용되는 <code class=\"language-text\">freq</code> 인수값은 다음과 같다.</p>\n<ul>\n<li>s: 초</li>\n<li>T: 분</li>\n<li>H: 시간</li>\n<li>D: 일(day)</li>\n<li>B: 주말이 아닌 평일</li>\n<li>W: 주(일요일)</li>\n<li>W-MON: 주(월요일)</li>\n<li>M: 각 달(month)의 마지막 날</li>\n<li>MS: 각 달의 첫날</li>\n<li>BM: 주말이 아닌 평일 중에서 각 달의 마지막 날</li>\n<li>BMS: 주말이 아닌 평일 중에서 각 달의 첫날</li>\n<li>WOM-2THU: 각 달의 두번째 목요일</li>\n<li>Q-JAN: 각 분기의 첫달의 마지막 날</li>\n<li>Q-DEC: 각 분기의 마지막 달의 마지막 날</li>\n</ul>\n<p>보다 자세한 내용은 다음 웹사이트를 참조하자.</p>\n<ul>\n<li><a href=\"https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#dateoffset-objects\">https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#dateoffset-objects</a></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pd<span class=\"token punctuation\">.</span>date_range<span class=\"token punctuation\">(</span><span class=\"token string\">\"2018-4-1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2018-4-30\"</span><span class=\"token punctuation\">,</span> freq<span class=\"token operator\">=</span><span class=\"token string\">\"B\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 평일만..</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">DatetimeIndex([&#39;2018-04-02&#39;, &#39;2018-04-03&#39;, &#39;2018-04-04&#39;, &#39;2018-04-05&#39;,\n               &#39;2018-04-06&#39;, &#39;2018-04-09&#39;, &#39;2018-04-10&#39;, &#39;2018-04-11&#39;,\n               &#39;2018-04-12&#39;, &#39;2018-04-13&#39;, &#39;2018-04-16&#39;, &#39;2018-04-17&#39;,\n               &#39;2018-04-18&#39;, &#39;2018-04-19&#39;, &#39;2018-04-20&#39;, &#39;2018-04-23&#39;,\n               &#39;2018-04-24&#39;, &#39;2018-04-25&#39;, &#39;2018-04-26&#39;, &#39;2018-04-27&#39;,\n               &#39;2018-04-30&#39;],\n              dtype=&#39;datetime64[ns]&#39;, freq=&#39;B&#39;)</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pd<span class=\"token punctuation\">.</span>date_range<span class=\"token punctuation\">(</span><span class=\"token string\">\"2018-1-1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2018-12-31\"</span><span class=\"token punctuation\">,</span> freq<span class=\"token operator\">=</span><span class=\"token string\">\"W\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 일요일만</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">DatetimeIndex([&#39;2018-01-07&#39;, &#39;2018-01-14&#39;, &#39;2018-01-21&#39;, &#39;2018-01-28&#39;,\n               &#39;2018-02-04&#39;, &#39;2018-02-11&#39;, &#39;2018-02-18&#39;, &#39;2018-02-25&#39;,\n               &#39;2018-03-04&#39;, &#39;2018-03-11&#39;, &#39;2018-03-18&#39;, &#39;2018-03-25&#39;,\n               &#39;2018-04-01&#39;, &#39;2018-04-08&#39;, &#39;2018-04-15&#39;, &#39;2018-04-22&#39;,\n               &#39;2018-04-29&#39;, &#39;2018-05-06&#39;, &#39;2018-05-13&#39;, &#39;2018-05-20&#39;,\n               &#39;2018-05-27&#39;, &#39;2018-06-03&#39;, &#39;2018-06-10&#39;, &#39;2018-06-17&#39;,\n               &#39;2018-06-24&#39;, &#39;2018-07-01&#39;, &#39;2018-07-08&#39;, &#39;2018-07-15&#39;,\n               &#39;2018-07-22&#39;, &#39;2018-07-29&#39;, &#39;2018-08-05&#39;, &#39;2018-08-12&#39;,\n               &#39;2018-08-19&#39;, &#39;2018-08-26&#39;, &#39;2018-09-02&#39;, &#39;2018-09-09&#39;,\n               &#39;2018-09-16&#39;, &#39;2018-09-23&#39;, &#39;2018-09-30&#39;, &#39;2018-10-07&#39;,\n               &#39;2018-10-14&#39;, &#39;2018-10-21&#39;, &#39;2018-10-28&#39;, &#39;2018-11-04&#39;,\n               &#39;2018-11-11&#39;, &#39;2018-11-18&#39;, &#39;2018-11-25&#39;, &#39;2018-12-02&#39;,\n               &#39;2018-12-09&#39;, &#39;2018-12-16&#39;, &#39;2018-12-23&#39;, &#39;2018-12-30&#39;],\n              dtype=&#39;datetime64[ns]&#39;, freq=&#39;W-SUN&#39;)</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pd<span class=\"token punctuation\">.</span>date_range<span class=\"token punctuation\">(</span><span class=\"token string\">\"2018-1-1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2018-12-31\"</span><span class=\"token punctuation\">,</span> freq<span class=\"token operator\">=</span><span class=\"token string\">\"W-MON\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 월요일</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">DatetimeIndex([&#39;2018-01-01&#39;, &#39;2018-01-08&#39;, &#39;2018-01-15&#39;, &#39;2018-01-22&#39;,\n               &#39;2018-01-29&#39;, &#39;2018-02-05&#39;, &#39;2018-02-12&#39;, &#39;2018-02-19&#39;,\n               &#39;2018-02-26&#39;, &#39;2018-03-05&#39;, &#39;2018-03-12&#39;, &#39;2018-03-19&#39;,\n               &#39;2018-03-26&#39;, &#39;2018-04-02&#39;, &#39;2018-04-09&#39;, &#39;2018-04-16&#39;,\n               &#39;2018-04-23&#39;, &#39;2018-04-30&#39;, &#39;2018-05-07&#39;, &#39;2018-05-14&#39;,\n               &#39;2018-05-21&#39;, &#39;2018-05-28&#39;, &#39;2018-06-04&#39;, &#39;2018-06-11&#39;,\n               &#39;2018-06-18&#39;, &#39;2018-06-25&#39;, &#39;2018-07-02&#39;, &#39;2018-07-09&#39;,\n               &#39;2018-07-16&#39;, &#39;2018-07-23&#39;, &#39;2018-07-30&#39;, &#39;2018-08-06&#39;,\n               &#39;2018-08-13&#39;, &#39;2018-08-20&#39;, &#39;2018-08-27&#39;, &#39;2018-09-03&#39;,\n               &#39;2018-09-10&#39;, &#39;2018-09-17&#39;, &#39;2018-09-24&#39;, &#39;2018-10-01&#39;,\n               &#39;2018-10-08&#39;, &#39;2018-10-15&#39;, &#39;2018-10-22&#39;, &#39;2018-10-29&#39;,\n               &#39;2018-11-05&#39;, &#39;2018-11-12&#39;, &#39;2018-11-19&#39;, &#39;2018-11-26&#39;,\n               &#39;2018-12-03&#39;, &#39;2018-12-10&#39;, &#39;2018-12-17&#39;, &#39;2018-12-24&#39;,\n               &#39;2018-12-31&#39;],\n              dtype=&#39;datetime64[ns]&#39;, freq=&#39;W-MON&#39;)</code></pre></div>\n<h2 id=\"shift-연산\" style=\"position:relative;\"><a href=\"#shift-%EC%97%B0%EC%82%B0\" aria-label=\"shift 연산 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>shift 연산</h2>\n<p>시계열 데이터의 인덱스는 시간이나 날짜를 나타내기 때문에 날짜 이동 등의 다양한 연산이 가능하다. 예를 들어 <code class=\"language-text\">shift</code>연산을 사용하면 인덱스는 그대로 두고 데이터만 이동할 수도 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>seed<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nts <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>randn<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>date_range<span class=\"token punctuation\">(</span><span class=\"token string\">\"2018-1-1\"</span><span class=\"token punctuation\">,</span> periods<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> freq<span class=\"token operator\">=</span><span class=\"token string\">\"M\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nts</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2018-01-31    1.764052\n2018-02-28    0.400157\n2018-03-31    0.978738\n2018-04-30    2.240893\nFreq: M, dtype: float64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ts<span class=\"token punctuation\">.</span>shift<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2018-01-31         NaN\n2018-02-28    1.764052\n2018-03-31    0.400157\n2018-04-30    0.978738\nFreq: M, dtype: float64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ts<span class=\"token punctuation\">.</span>shift<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2018-01-31    0.400157\n2018-02-28    0.978738\n2018-03-31    2.240893\n2018-04-30         NaN\nFreq: M, dtype: float64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ts<span class=\"token punctuation\">.</span>shift<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> freq<span class=\"token operator\">=</span><span class=\"token string\">\"M\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2018-02-28    1.764052\n2018-03-31    0.400157\n2018-04-30    0.978738\n2018-05-31    2.240893\nFreq: M, dtype: float64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ts<span class=\"token punctuation\">.</span>shift<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> freq<span class=\"token operator\">=</span><span class=\"token string\">\"W\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2018-02-04    1.764052\n2018-03-04    0.400157\n2018-04-01    0.978738\n2018-05-06    2.240893\ndtype: float64</code></pre></div>\n<h2 id=\"resample-연산\" style=\"position:relative;\"><a href=\"#resample-%EC%97%B0%EC%82%B0\" aria-label=\"resample 연산 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>resample 연산</h2>\n<p><strong>resample</strong> 연산을 쓰면 시간 간격을 재조정하는 리샘플링(resampling)이 가능하다. 이 때 시간 구간이 작아지면 데이터 양이 증가한다고 해서 업-샘플링(up-sampling)이라 하고 시간 구간이 커지면 데이터 양이 감소한다고 해서 다운-샘플링(down-sampling)이라 부른다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ts <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>randn<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>date_range<span class=\"token punctuation\">(</span><span class=\"token string\">\"2018-1-1\"</span><span class=\"token punctuation\">,</span> periods<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> freq<span class=\"token operator\">=</span><span class=\"token string\">\"D\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nts<span class=\"token punctuation\">.</span>tail<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2018-03-22    0.625231\n2018-03-23   -1.602058\n2018-03-24   -1.104383\n2018-03-25    0.052165\n2018-03-26   -0.739563\n2018-03-27    1.543015\n2018-03-28   -1.292857\n2018-03-29    0.267051\n2018-03-30   -0.039283\n2018-03-31   -1.168093\n2018-04-01    0.523277\n2018-04-02   -0.171546\n2018-04-03    0.771791\n2018-04-04    0.823504\n2018-04-05    2.163236\n2018-04-06    1.336528\n2018-04-07   -0.369182\n2018-04-08   -0.239379\n2018-04-09    1.099660\n2018-04-10    0.655264\nFreq: D, dtype: float64</code></pre></div>\n<p>다운-샘플링의 경우에는 원래의 데이터가 그룹으로 묶이기 때문에 그룹바이(groupby)때와 같이 그룹 연산을 해서 대표값을 구해야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ts<span class=\"token punctuation\">.</span>resample<span class=\"token punctuation\">(</span><span class=\"token string\">'W'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2018-01-07    0.697206\n2018-01-14    0.468797\n2018-01-21    0.249052\n2018-01-28    0.301938\n2018-02-04    0.023198\n2018-02-11    0.283486\n2018-02-18   -0.096136\n2018-02-25   -0.446708\n2018-03-04    0.155312\n2018-03-11    0.200799\n2018-03-18   -0.376808\n2018-03-25   -0.895860\n2018-04-01   -0.129493\n2018-04-08    0.616422\n2018-04-15    0.877462\nFreq: W-SUN, dtype: float64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ts<span class=\"token punctuation\">.</span>resample<span class=\"token punctuation\">(</span><span class=\"token string\">'M'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2018-01-31   -1.173123\n2018-02-28    0.676433\n2018-03-31    0.087551\n2018-04-30    0.523277\nFreq: M, dtype: float64</code></pre></div>\n<p>날짜가 아닌 시/분 단위에서는 구간위 왼쪽 한계값(가장 빠른 값)은 포함하고 오른쪽 한계값(가장 늦은 값)은 포함하지 않는다. 즉, 가장 늦은 값은 다음 구간에 포함된다. 예를 들어 10분 간경으로 구간을 만들면 10의 배수가 되는 시각은 구간의 시작점이 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ts <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>randn<span class=\"token punctuation\">(</span><span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>date_range<span class=\"token punctuation\">(</span><span class=\"token string\">\"2018-1-1\"</span><span class=\"token punctuation\">,</span> periods<span class=\"token operator\">=</span><span class=\"token number\">60</span><span class=\"token punctuation\">,</span> freq<span class=\"token operator\">=</span><span class=\"token string\">\"T\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nts<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2018-01-01 00:00:00    2.259309\n2018-01-01 00:01:00   -0.042257\n2018-01-01 00:02:00   -0.955945\n2018-01-01 00:03:00   -0.345982\n2018-01-01 00:04:00   -0.463596\n2018-01-01 00:05:00    0.481481\n2018-01-01 00:06:00   -1.540797\n2018-01-01 00:07:00    0.063262\n2018-01-01 00:08:00    0.156507\n2018-01-01 00:09:00    0.232181\n2018-01-01 00:10:00   -0.597316\n2018-01-01 00:11:00   -0.237922\n2018-01-01 00:12:00   -1.424061\n2018-01-01 00:13:00   -0.493320\n2018-01-01 00:14:00   -0.542861\n2018-01-01 00:15:00    0.416050\n2018-01-01 00:16:00   -1.156182\n2018-01-01 00:17:00    0.781198\n2018-01-01 00:18:00    1.494485\n2018-01-01 00:19:00   -2.069985\nFreq: T, dtype: float64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ts<span class=\"token punctuation\">.</span>resample<span class=\"token punctuation\">(</span><span class=\"token string\">'10T'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2018-01-01 00:00:00   -0.155837\n2018-01-01 00:10:00   -3.829915\n2018-01-01 00:20:00   -0.115280\n2018-01-01 00:30:00   -3.234560\n2018-01-01 00:40:00   -4.452304\n2018-01-01 00:50:00   -0.906751\nFreq: 10T, dtype: float64</code></pre></div>\n<p>왼쪽이 아니라 오른쪽 한계값을 구간에 포함하려면 <code class=\"language-text\">closed=&quot;right&quot;</code> 인수를 사용한다. 이 때는 10의 배수가 되는 시각이 앞 구간에 포함된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ts<span class=\"token punctuation\">.</span>resample<span class=\"token punctuation\">(</span><span class=\"token string\">'10T'</span><span class=\"token punctuation\">,</span> closed<span class=\"token operator\">=</span><span class=\"token string\">\"right\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2017-12-31 23:50:00    2.259309\n2018-01-01 00:00:00   -3.012462\n2018-01-01 00:10:00   -2.806340\n2018-01-01 00:20:00   -1.354903\n2018-01-01 00:30:00   -4.004135\n2018-01-01 00:40:00   -3.180252\n2018-01-01 00:50:00   -0.595865\nFreq: 10T, dtype: float64</code></pre></div>\n<p><code class=\"language-text\">ohlc</code> 매서드는 구간의 시고저종(open, high, low, close)값을 구한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ts<span class=\"token punctuation\">.</span>resample<span class=\"token punctuation\">(</span><span class=\"token string\">'5T'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ohlc<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre></div>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>open</th>\n      <th>high</th>\n      <th>low</th>\n      <th>close</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2018-01-01 00:00:00</th>\n      <td>2.259309</td>\n      <td>2.259309</td>\n      <td>-0.955945</td>\n      <td>-0.463596</td>\n    </tr>\n    <tr>\n      <th>2018-01-01 00:05:00</th>\n      <td>0.481481</td>\n      <td>0.481481</td>\n      <td>-1.540797</td>\n      <td>0.232181</td>\n    </tr>\n    <tr>\n      <th>2018-01-01 00:10:00</th>\n      <td>-0.597316</td>\n      <td>-0.237922</td>\n      <td>-1.424061</td>\n      <td>-0.542861</td>\n    </tr>\n    <tr>\n      <th>2018-01-01 00:15:00</th>\n      <td>0.416050</td>\n      <td>1.494485</td>\n      <td>-2.069985</td>\n      <td>-2.069985</td>\n    </tr>\n    <tr>\n      <th>2018-01-01 00:20:00</th>\n      <td>0.426259</td>\n      <td>0.676908</td>\n      <td>-0.637437</td>\n      <td>-0.132881</td>\n    </tr>\n    <tr>\n      <th>2018-01-01 00:25:00</th>\n      <td>-0.297791</td>\n      <td>1.152332</td>\n      <td>-1.676004</td>\n      <td>1.079619</td>\n    </tr>\n    <tr>\n      <th>2018-01-01 00:30:00</th>\n      <td>-0.813364</td>\n      <td>0.521065</td>\n      <td>-1.466424</td>\n      <td>0.141953</td>\n    </tr>\n    <tr>\n      <th>2018-01-01 00:35:00</th>\n      <td>-0.319328</td>\n      <td>0.694749</td>\n      <td>-1.383364</td>\n      <td>-1.383364</td>\n    </tr>\n    <tr>\n      <th>2018-01-01 00:40:00</th>\n      <td>-1.582938</td>\n      <td>0.610379</td>\n      <td>-1.582938</td>\n      <td>-0.596314</td>\n    </tr>\n    <tr>\n      <th>2018-01-01 00:45:00</th>\n      <td>-0.052567</td>\n      <td>0.523891</td>\n      <td>-1.936280</td>\n      <td>0.088422</td>\n    </tr>\n    <tr>\n      <th>2018-01-01 00:50:00</th>\n      <td>-0.310886</td>\n      <td>1.955912</td>\n      <td>-2.772593</td>\n      <td>1.955912</td>\n    </tr>\n    <tr>\n      <th>2018-01-01 00:55:00</th>\n      <td>0.390093</td>\n      <td>0.493742</td>\n      <td>-0.652409</td>\n      <td>-0.116104</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<p>업-샘플링의 경우에는 실제로 존재하지 않는 데이터를 만들어야 한다. 이 때는 앞에서 나온 데이터를 뒤에서 그대로 쓰는 forward filling 방식과 뒤에서 나올 데이터를 앞에서 미리 쓰는 backward filling 방식을 사용할 수 있다. 각각 <code class=\"language-text\">ffill</code>, <code class=\"language-text\">bfill</code> 매서드를 이용한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ts<span class=\"token punctuation\">.</span>resample<span class=\"token punctuation\">(</span><span class=\"token string\">'30s'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ffill<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2018-01-01 00:00:00    2.259309\n2018-01-01 00:00:30    2.259309\n2018-01-01 00:01:00   -0.042257\n2018-01-01 00:01:30   -0.042257\n2018-01-01 00:02:00   -0.955945\n2018-01-01 00:02:30   -0.955945\n2018-01-01 00:03:00   -0.345982\n2018-01-01 00:03:30   -0.345982\n2018-01-01 00:04:00   -0.463596\n2018-01-01 00:04:30   -0.463596\n2018-01-01 00:05:00    0.481481\n2018-01-01 00:05:30    0.481481\n2018-01-01 00:06:00   -1.540797\n2018-01-01 00:06:30   -1.540797\n2018-01-01 00:07:00    0.063262\n2018-01-01 00:07:30    0.063262\n2018-01-01 00:08:00    0.156507\n2018-01-01 00:08:30    0.156507\n2018-01-01 00:09:00    0.232181\n2018-01-01 00:09:30    0.232181\nFreq: 30S, dtype: float64</code></pre></div>\n<h2 id=\"dt-접근자\" style=\"position:relative;\"><a href=\"#dt-%EC%A0%91%EA%B7%BC%EC%9E%90\" aria-label=\"dt 접근자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>dt 접근자</h2>\n<p>datetime 자료형 시리즈에는 dt접근자가 있어 datetime 자료형이 가진 몇가지 유용한 속성과 매서드를 사용할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">s <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">(</span>pd<span class=\"token punctuation\">.</span>date_range<span class=\"token punctuation\">(</span><span class=\"token string\">\"2020-12-25\"</span><span class=\"token punctuation\">,</span> periods<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> freq<span class=\"token operator\">=</span><span class=\"token string\">\"D\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ns</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0    2020-12-25\n1    2020-12-26\n2    2020-12-27\n3    2020-12-28\n4    2020-12-29\n        ...    \n95   2021-03-30\n96   2021-03-31\n97   2021-04-01\n98   2021-04-02\n99   2021-04-03\nLength: 100, dtype: datetime64[ns]</code></pre></div>\n<p>예를 들어 <code class=\"language-text\">year</code>, <code class=\"language-text\">month</code>, <code class=\"language-text\">day</code>, <code class=\"language-text\">weekday</code> 등의 속성을 이용하면 년, 월, 일, 요일 정보를 빼낼 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>dt<span class=\"token punctuation\">.</span>year</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0     2020\n1     2020\n2     2020\n3     2020\n4     2020\n      ... \n95    2021\n96    2021\n97    2021\n98    2021\n99    2021\nLength: 100, dtype: int64</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>dt<span class=\"token punctuation\">.</span>weekday</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0     4\n1     5\n2     6\n3     0\n4     1\n     ..\n95    1\n96    2\n97    3\n98    4\n99    5\nLength: 100, dtype: int64</code></pre></div>\n<p><code class=\"language-text\">strftime</code> 매서드를 이용하여 문자열을 만드는 것도 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>dt<span class=\"token punctuation\">.</span>strftime<span class=\"token punctuation\">(</span><span class=\"token string\">\"%Y년 %m월 %d일\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0     2020년 12월 25일\n1     2020년 12월 26일\n2     2020년 12월 27일\n3     2020년 12월 28일\n4     2020년 12월 29일\n          ...      \n95    2021년 03월 30일\n96    2021년 03월 31일\n97    2021년 04월 01일\n98    2021년 04월 02일\n99    2021년 04월 03일\nLength: 100, dtype: object</code></pre></div>\n<p>Quiz, 다음 명령으로 만들어진 데이터프레임에 대해 월별 value의 합계를 구하라. (힌트 : <code class=\"language-text\">groupby</code> 매서드와 <code class=\"language-text\">dt</code> 접근자를 사용))</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>seed<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"date\"</span><span class=\"token punctuation\">:</span> pd<span class=\"token punctuation\">.</span>date_range<span class=\"token punctuation\">(</span><span class=\"token string\">\"2020-12-25\"</span><span class=\"token punctuation\">,</span> periods<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> freq<span class=\"token operator\">=</span><span class=\"token string\">\"D\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> \n    <span class=\"token string\">\"value\"</span><span class=\"token punctuation\">:</span> np<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>출처 : 데이터사이언스 스쿨(<a href=\"http://datascienceschool.net\">http://datascienceschool.net</a>)</p>"},"primaryTag":{"name":"Python","color":"#445788"}},"pageContext":{"postId":"96cd1786-0868-59a4-b69e-1d5f978a731a","primaryTag":"Python"}}}