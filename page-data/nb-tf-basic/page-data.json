{"componentChunkName":"component---src-templates-post-tsx","path":"/nb-tf-basic","result":{"data":{"post":{"headings":[{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3}],"frontmatter":{"title":"TF - 텐서플로우 소개 및 맛보기","path":"/nb-tf-basic","tags":["ML-DL","Tensorflow","자연어처리"],"excerpt":"텐서플로우(TensorFlow)는 데이터 플로우 그래프(Data flow graph)를 사용하여 수치 연산을 하는 오픈소스 소프트웨어 라이브러리이다.","created":"2019-07-21T00:00:00.000Z","createdPretty":"21 July, 2019","updated":"2019-07-21T00:00:00.000Z","updatedPretty":"21 July, 2019","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABEklEQVQoz5VRXUsCQRTdX+JTf8qfIz32Gr73ZNCDYiJJViaBSdCL9mWDbbgFgtYuUWp7557mw23ZnAQPc5nLHc7hnDseJLBabG9StzoGuiU7ZyfHlucaaoImsxZZzMCjDvhzmhHdTFCLkbXGFzug3RyonjfiyftaQVYReRkzEft1GL6CilugzrZJzyTT94Qj2e0wcWUgl30cg9sFIPLTeWY9vMahOsHLGJPJu+llLO0HKETRF4JgjPlskX6S5P8ja7LG1fUN9ssNVOpnOKgco9Zo46R1ib1SFc1WF4dH5yjXTk3RN63s1PsbNww/8CB8DMQz+ncCvVth+qEfYPoW4n7wpGaPEMOREpRuwcxyN4Ej9g976rc4gJEuNwAAAABJRU5ErkJggg==","aspectRatio":2.150537634408602,"src":"/static/7701c7a0cff07ad94d0586e42cc22780/fa42c/cover.png","srcSet":"/static/7701c7a0cff07ad94d0586e42cc22780/dc47e/cover.png 200w,\n/static/7701c7a0cff07ad94d0586e42cc22780/9f2d5/cover.png 400w,\n/static/7701c7a0cff07ad94d0586e42cc22780/fa42c/cover.png 600w","sizes":"(max-width: 600px) 100vw, 600px"}}}},"html":"<p>텐서플로우(TensorFlow)는 데이터 플로우 그래프(Data flow graph)를 사용하여 수치 연산을 하는 오픈소스 소프트웨어 라이브러리이다.</p>\n<h3 id=\"데이터-플로우-그래프data-flow-graph\" style=\"position:relative;\"><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%94%8C%EB%A1%9C%EC%9A%B0-%EA%B7%B8%EB%9E%98%ED%94%84data-flow-graph\" aria-label=\"데이터 플로우 그래프data flow graph permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>데이터 플로우 그래프(Data flow graph)</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 252px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4a67e12961d71d510c83c2aa35a8febb/5e02b/data-flow-graph-01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 177.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAYAAACJ8xqgAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAFg0lEQVRIx61W2XITVxD1h+cH8pA8BVKkTEgVCRWKQJEQAcbE2AEjLGuxZO0aSaMZzap9He0np68t2TjCeclUtUZ35va5vZzunp3VaoX/89qRn+l0isFggOFwiNFohCAI+H+kninhcyVq3b96tn5PET0xTgG2221EojGcpc4RTSQROY2iqutw/SZsz4ftOEocrp1GG7brcm3z7vF94+Idn83n8wvATq8Ps5CEdfAA7tFDmFqWyg04tRIcvag2e1yb6TDs2B7c+uVhvDvVPByCe76P2Wx2aWFvALeURPWPb2G//g5+rQCvM0Tl4Bfob+/D8Tz4zRb0o8fQnn0Nr5rj+wGMxDuUnn/DgzV4jdYVYKfTgWnWUKdFeiWv3JFTa9WCWjuOdeFivQK9nINtm7TagWmUUaU3tmXAZWjms/k6hj1oqT9RjO2iTDG0j6iW3iMf+QGVxH1U82+ha1EUT++hGN2FngnBqCS5/z60+I+oZZ6gXq9jvlhcALbaHWiFExTO31Be06o0anp6s65oCRh6HqXMG+RTXBdPYNSK0HIHfL+HYuYQlm1fJUXS7jFbDV8yyEy6klmK20Dd8tXapThei2uPyh6feUxEm8mh8Hmr1cZyucTOhtjkIrrdrWSdzaaYTALyc8z7BJNgonjX7/UwHo8+J/aKqAK5zOUwjJ7CI6jP01utFq1ylfU3LykAcbFcqSJfKNBqS+1fSAzXFq5I7mmjgT5P7nY7Sqnf79OCAN2BD91Ow3ByGI0Hyj29VkM6nUYymUIuR2bwgA1tvlTPq+UKAQHj+dd4dXwHB9EHBHcw6A+xu7ur3BXdNpPa7w8uXZZfuo12i3GcUcFFXg9DMxKYTMdq02IxR6Pp0eq+Wk+CGcLhEywXFweLFzNycNMcFuJm6E8EuokM+ffywx28P3uE4bizsXaxWPLclaJGtvo3UtUQCkaY6wUTFDBZ0yvACTNsMRFNVoxP+vSYPVG8eU3pwZRxKlsxxAsvUbET6iCxUDrWhctb4ienyiVJaTBR0o2azSaG0rp46Lg/QqfVVZES/dFofAW4Toqij9wpYomQ1DAMnEajSGdzSDGbsWwez2NpPI2cIVXSMB4NIfZsBbx+l/RLIpqdLqqRV6j99RNcy8RpvoiHJwkl8WKJyRlvt3BDk0tAsVBI2mDLMjMRmGeHcNltfPbEarnGuq6zAzkYMplSFdLdRUfUtwIqC+my7zkohu6gvvc9LawhHsti7/knhJ4eI3NeUqUoOlJNonOrhRJDSYiVjahO7bASbNtFIVdmZ9LZrmxmd6z4Jy7/J+A6Nn1ybEgiDwYcYBxePVbHQIYY3ZUGIfSSobam2VZAeSkx1Dmo4vE48mwcqfNzNtociuFj5I7fsxdmFajslYTcCihgssmnywY7sSlClysEy/z8AGmK9inMWdRTe0VudXkN2Gg22Dw9NdFEZHym8gUk2V10clSIv57rEvPbAdlIm90+KpE96O8ecnQaOEplcS98hrsfYjjO5DFj7FTpcu9adyugnCb17Tt1WJzDxskLZtmCYdn4mMrhU7qAmmluvhbWpN58OfwbdIXxdIFm+gjlR1+huX8XtllBOlXCYSiKw5cx5DIaAo4FGZ3i0VbAdS0LYDCZwdMLtC4EK3lIC+v8PDGQiGVY15zX/C9daXbNuq0uX6fOaDxBwMMH5GGXs0ZaVTCeEmSuym3I2N3U+4LLFw11HZtUMonHvz5Bd+jivLKPs+I+uj2PrZpJMY3PdHe2zpJLUImRXFKCedLFbxkIp39DJPs7v3UMdApFtPffoMVeOb+M41YLr7vQ7DhIaC8Q057B8NKYTdYhYa2z2XZppef524m9ta5nASpWXM2Pds++fLf8os6tLm8bD9c9uCly/QMsNaRIXdPofQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mnist\"\n        title=\"mnist\"\n        src=\"/static/4a67e12961d71d510c83c2aa35a8febb/5e02b/data-flow-graph-01.png\"\n        srcset=\"/static/4a67e12961d71d510c83c2aa35a8febb/5e02b/data-flow-graph-01.png 252w\"\n        sizes=\"(max-width: 252px) 100vw, 252px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>수학 계산과 데이터의 흐름을 노드(Node)와 엣지(Edge)를 사용한 양방향 그래프(Directed Graph)로 표현한다.</p>\n<ul>\n<li>노드(Node) : 수치 연산</li>\n<li>엣지(Edge) : 노드 사이를 이동하는 다차원 데이터 배역(텐서, tensor)</li>\n</ul>\n<h3 id=\"특징-및-장점\" style=\"position:relative;\"><a href=\"#%ED%8A%B9%EC%A7%95-%EB%B0%8F-%EC%9E%A5%EC%A0%90\" aria-label=\"특징 및 장점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>특징 및 장점</h3>\n<p>텐서플로우는 머신러닝과 딥 뉴럴 네트워크 연구를 목적으로 구글의 인공지능 연구 조직인 구글 브레인 팀의 연구자와 엔지니어들에 의해 개발었는데 다임과 같은 특징을 가진다.</p>\n<ul>\n<li>코드 수정없이 데스크탑, 서버 혹은 모바일 디바이스에서 CPU나 GPU를 사용하여 연산을 구동</li>\n<li>분산(distributed) 실행환경이 가능</li>\n<li>아이디어 테스트에서 서비스 단계까지 모두 이용가능</li>\n<li>계산 구조와 목표 함수만 정의하면 자동으로 미분 계산 처리</li>\n</ul>\n<h3 id=\"설치\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EC%B9%98\" aria-label=\"설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설치</h3>\n<p>먼저 아나콘다를 설치한 후 다음과 같이 conda install 명령으로 간단하게 설치할 수 있다.</p>\n<p><code class=\"language-text\">conda install tensorflow</code></p>\n<h2 id=\"실습\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%EC%8A%B5\" aria-label=\"실습 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실습</h2>\n<p>그럼 이제 텐서플로우 공식 홈페이지에 나와있는 튜토리얼을 따라 해보자.</p>\n<h3 id=\"basic-classification\" style=\"position:relative;\"><a href=\"#basic-classification\" aria-label=\"basic classification permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Basic classification</h3>\n<p><a href=\"https://www.tensorflow.org/tutorials/keras/basic_classification?hl=ko\">https://www.tensorflow.org/tutorials/keras/basic_classification?hl=ko</a></p>\n<h3 id=\"데이터-준비하기\" style=\"position:relative;\"><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A4%80%EB%B9%84%ED%95%98%EA%B8%B0\" aria-label=\"데이터 준비하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>데이터 준비하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n<span class=\"token keyword\">from</span> tensorflow <span class=\"token keyword\">import</span> keras</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>__version__<span class=\"token punctuation\">)</span> </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">1.13.1</code></pre></div>\n<p>현재 사용하는 버전은 1.13.1</p>\n<p>이제 10개의 범주(category)와 70,000개의 흑백 이미지로 구성된 패션 MNIST 데이터셋을 사용하겠다. 이미지는 해상도(28x28 픽셀)가 낮고 다음처럼 개별 옷 품목을 나타낸다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/18d2c1da3b5c7dbff14ea81077d9ed24/1e088/fashion-mnist-sprite.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA9hAAAPYQGoP6dpAAADHUlEQVQ4yzWUZ0+qQRCF9yf4RTRBUOkW7II0wd47iGAv0WDXaIyaEP/53DznZj/s++7Ozs7MOXN23eXlpTHy+bytrq7a3NycbW1t2fn5uZ2cnNje3p7Nzs7azs6OVSoVu7u7s93dXctkMlav1+3q6ko+Gxsb9vT0ZK5YLNrh4aECEGxxcdHW1tZk297eVpKzszMdaDQaVq1W7fT0VD74N5tN29zctIODAyV2k5OTViqVdJjKCEiSdDqtP04MfKgQ29LSkoJNTU1ZNpvVYH9mZsZcLpez8fFxQVhYWJBxenpaaw6zTyAq8gkGBgbkR5CRkRHZSKAKv76+VBm8AAXo5XJZ/Nze3mqsr6/b29ub5tfX1/bz82MfHx+2srJiR0dH9vj4KH8ocQR4fn5WoL+/P2u32/b7+ytHKj4+PlYVcAdfcPv+/q5m3NzcqAgSLC8vC5UjO9VhAAKwyJZIJLSGcBxHR0cFHT+gYfec0hB4pR8KiBPV+M6xBjaNokJkQVAgEog/NnwZBOWPtBwfIL++vkpjDw8PGhcXF4L48vIi/qCgVqvJBo8eLtqDw1arJY4dE6rwB6jg8/NTzgzs+MAbhwuFgoLSTIogmG8eiVxPT4/19vZaV1eXdXd3W2dnpw0ODlo0GrW+vj4LBALW39+vfXgMBoPyC4fDssfjccmoo6PDIpGIORwgc2xsTNcvFApZLBbTQeZwR5c5SCI0iuiZE4BiaCDBU6nUf9kAlaDoEXns7++LZBqDsJEKneQasjc/Py8bZ/AZGhqS0JGS+/7+VncZdBVx0kUCwB9rqpyYmFAXaRwcog7WcEoC/7g4ygUu8OAIuMBjcCWBBzR4wo81+hseHhZ8YOLHPmcdxOOUTCa1SQI2OOADkJ01eyRF2KxJClzmcEi1jixwx8uBuIEDdLjkxqBHeIMGIGKHV24RNn8N2YNX5w+z8AHv7+/1uOJIQLSGVtEh3OEHbDjGzntJDG6P4y2jIcCg48zJ7O80sGkQiRE6/v7eYqPLnEFa6jIPKp3jhiAfsvI6A4E5gamS4AQmGYGokD9rCqFyuvwPzyTcTG7WJMQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mnist\"\n        title=\"mnist\"\n        src=\"/static/18d2c1da3b5c7dbff14ea81077d9ed24/1e088/fashion-mnist-sprite.png\"\n        srcset=\"/static/18d2c1da3b5c7dbff14ea81077d9ed24/5a46d/fashion-mnist-sprite.png 300w,\n/static/18d2c1da3b5c7dbff14ea81077d9ed24/0a47e/fashion-mnist-sprite.png 600w,\n/static/18d2c1da3b5c7dbff14ea81077d9ed24/1e088/fashion-mnist-sprite.png 840w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>{: width=\"600\"}</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">fashion_mnist <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>fashion_mnist\n<span class=\"token punctuation\">(</span>train_images<span class=\"token punctuation\">,</span> train_labels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>test_images<span class=\"token punctuation\">,</span> test_labels<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> fashion_mnist<span class=\"token punctuation\">.</span>load_data<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-labels-idx1-ubyte.gz\n32768/29515 [=================================] - 0s 1us/step\nDownloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-images-idx3-ubyte.gz\n26427392/26421880 [==============================] - 2s 0us/step\nDownloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-labels-idx1-ubyte.gz\n8192/5148 [===============================================] - 0s 0us/step\nDownloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-images-idx3-ubyte.gz\n4423680/4422102 [==============================] - 1s 0us/step</code></pre></div>\n<p>Fashion MNIST data를 가져와 훈련셋(train<em>images, train</em>labels)와 테스트셋(test<em>images, test</em>labels)에 저징한다.</p>\n<p>우리가 만드는 학습모델에 훈련셋을 통해 학습시킬 것이고, 테스트셋의 test<em>images을 통해 예측값을 도출한 후 test</em>labels와 비교하여 오차를 측정할 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">train_images<span class=\"token punctuation\">.</span>shape</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(60000, 28, 28)</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">test_images<span class=\"token punctuation\">.</span>shape</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(10000, 28, 28)</code></pre></div>\n<p>데이터를 간단히 살펴보면 훈련셋에는 60000개, 테스트셋에는 1000개의 이미지 이고 하나의 이미지는 28x28 크기를 가지고 있는것을 확인 할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">train_labels</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">array([9, 0, 0, ..., 3, 0, 5], dtype=uint8)</code></pre></div>\n<p>위와 같이 label은 0~9까지의 값을 가지고 있다. 각 숫자가 의미하는 바는 다음과 같다.</p>\n<p><strong>Label: Class</strong></p>\n<p>0: T-shirt/top\n1: Trouser\n2: Pullover\n3: Dress\n4: Coat\n5: Sandal\n6: Shirt\n7: Sneaker\n8: Bag\n9: Ankle boot</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">class_names <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'T-shirt/top'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Trouser'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Pullover'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Dress'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Coat'</span><span class=\"token punctuation\">,</span> \n               <span class=\"token string\">'Sandal'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Shirt'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Sneaker'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Bag'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Ankle boot'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>그럼 불러온 fashion_mnist 데이터를 살펴본 결과는 다음 그림과 같다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 672px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9b190ee014bbc78d92c0d4019a77f749/30d16/load-data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACrElEQVQoz1WTS3PSYBiF+7/cuXDhwhlduPL3qAtdOdUZpzpqZ5xqrxRKKaWk5ZLQNAFKL1CgN3qBQlIgFEqp8PgCrR0XZ77k+5KTc95zMtK2w9zUonTqKu1qhE5NHdzfo79/Lc/8uYz+Q7eq0iwp2NterISXkuGmvuunY2mMHBR1ZsNuXKE5VhIrzMv1grqAN7aIV/Myrcxi5CPQMMAxBcO1drZKWfOx754hOz+FFfVzWwkzUrpQ2cwG2RJs5xQ2MwFSuVW28iGSewrxjEK2EKFb36B3hz5p/XwV2/ST905zsDRDM7lGpxxhhPYudHYEuwN0W1vUCgFo6w9orUNzfaDyntQ5X6MUWyDnmeLYPyeig6JQCHux13TX39ATdGNvIf6OdNKHls5iZvMY2Rwbe3lS+QxtS0gdUdhK4BTXKMtYcp5prJCfZnxVFIplxp/A1Ev4/QJmXsn6lMxujI9hhx+azXjskm9ala+RItapinOmYB2tcHkSFEKvzHAaWwivDGVI2D88Tbsp7y9xkfdxY8fEmslN1ZDE41yV1znJBUSRBHOdxD4OcpByUTkKcKEvkl2YohBw00qGhoS3BQ83h3PcHrnoHM7SK0paNUmxkqBa7iOOVTS5ssyB3eqJMiBuFEOcqW4yrgkuI2I5cW/5yyOYeAa/nssq+PkYM2XwPthgLCJW1Tqfo1eMhUtUjtdoV6LDlKU2lQ0fh4uzHC25ZOsulKY5iq19kJQ+UdNH6e19x6nESR+myRcypPe30ZI6mVyc3qCDgroxUFhSPeTmJykrvocZtqpiq6TRqOg4ZZ3bxiZyOqxJUyrjaHStEMgfdF+bPmntVOEkPM+ea5KSENra8p3l/hf7f0FjY4i6Li8ZUuQH0OirM/8rdttSsXeWKepezmIe7JTMXvb+Ap3oS0WYJ1qNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mnist\"\n        title=\"mnist\"\n        src=\"/static/9b190ee014bbc78d92c0d4019a77f749/30d16/load-data.png\"\n        srcset=\"/static/9b190ee014bbc78d92c0d4019a77f749/5a46d/load-data.png 300w,\n/static/9b190ee014bbc78d92c0d4019a77f749/0a47e/load-data.png 600w,\n/static/9b190ee014bbc78d92c0d4019a77f749/30d16/load-data.png 672w\"\n        sizes=\"(max-width: 672px) 100vw, 672px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"데이터-전처리\" style=\"position:relative;\"><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%84%EC%B2%98%EB%A6%AC\" aria-label=\"데이터 전처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>데이터 전처리</h3>\n<p>모델에 데이터를 학습시키기 위해 먼저 데이터 전처리를 진행해 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># train_images의 첫번째 요소를 그림</span>\nplt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>train_images<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>colorbar<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 점자선을 없애자.</span>\nplt<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 305px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/62c83c767e07d4e0c790fe4905f7779f/a3e09/output_18_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAAEIElEQVQ4y2WU/U9TZxTHT0s3cW7xZTKYMB0gyIVCKVKh72+3tJQWKLelUFoobxoGyIIiTh1kzDHnWHiLMtyyscRtApkKcW/sB+QtmYuLoCsq4GK2uC3ZX7DS3rOnV2lMfG6+OeeePPnke+55ngtA1m5IEirBMqCEgv5nxCPiF/QrSFREWJ6qWwakkN9njpdE35iO8koyI/cQ1I4QD0QgU5h5FZjPcz0rKEczuJ7IiSZ+BRHJSaTJu3WvXDizGP3toYYdrxHUJg4oBmW2Hhgk8nPibcjuN0CpX6pv9YudnX71q/V+I9hIzUYis66Dov/oBHVKz7xo9PIfhhdhY+0DsY7m2ZGIJUA2lBMYGqAE5Vtr0PtNNTLTjZjw0VlMt76FisRGNkd2FHOFTUE6Lo86NG2+lCiPTSeoKA4oAV1mGMhjQlCkI+yoBTvanJX41QMJfr+WgmcWDeicakDRcBerGO1AR4c3mAQeSj/pGZN2217eMChIgSzNBpBTCCiwo4YAPW0MfvmXBM/fVuIFnxwvrmXj4G0VO/F3FjadMgYjoZSivm4aTzruCgNBCAfkNM9BgKF2iUPizigoQRlU4cneQrz8SITtv9qw9SaDQ8sqHF3JYs8ta9HU1RxMfekwFXu+bXSLOE0YnnIWqPcbOIcO0q6DJR8dlVCG+ig3jkwp8drDVJxcFeLI/Ry8uCLBsdUMdthnRFVxSzAZjNSu90+OU+eGw0PZlAIZtJYcD11kGWuMrWY1ojq011XhsauF+MWaBHvvanH4ngKvrIlx2KfEyfuZ7Mw/Qqw9XBR8ARgq/sTbYztldBxhPccRU0Ettju9eHaaZodmNWznrWI888CEnzxUYMt35dh53YEjdxX4+VIe9hB95pOzP/6bhv2nxUEAL0U1dYxuSxRRBLWVA0bsrNec+MGBg3+q2QsrMnbq9xTsX6Lx1JIVP11Q4ZEhLx694sL2G0XY69Ni329aduJRBr47aCDAbkrkPD5e8sGdzY8bbgNeHBSq7T2N2LhSzlYsVIeEB3+pwHbiNNTux/fkOOjTYPcdE9aTuvGnZrZ20Y3eq1VByOijcnXHxmJez0kMeeOY2ZCTpYnxoOOdunX39dr1xsXywHvLlsDAal7g9HJBoGmpLFB7yxNoWHQF3DerA6rpI+uFEy1Bk8vj3wcllCK79dKeaGnoLvO5oSQLxKZ8MlUa3GhLrsA3zE5sdlbhm6WV2KBm0LnfgebMSszPrMI8kRf16TVoiDlI9jtQytOnqWJrrrkTPtwSPocZIKXU/KKfdfyiGSUUzucAM3cA7HMSYOZzgZlVQPG8htSJ5jRgXdCBdVYLlgUV3zKXHUHvkUVau3ZFJMTBUyv0l3iey6QQycV+EMBe2Mbl8bA9vDPmyX3dTp7Nj1vcYLwi2A3/A4pf56lrJgVCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/62c83c767e07d4e0c790fe4905f7779f/a3e09/output_18_0.png\"\n        srcset=\"/static/62c83c767e07d4e0c790fe4905f7779f/5a46d/output_18_0.png 300w,\n/static/62c83c767e07d4e0c790fe4905f7779f/a3e09/output_18_0.png 305w\"\n        sizes=\"(max-width: 305px) 100vw, 305px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>픽셀 값의 범위는 0 ~ 255 이다.</p>\n<p>신경망 모델에 주입하기 전에 이 값의 범위를 0~1 사이로 조정해야 하기 때문에 모든 값을 255로 나누어 주자.\n(색상은 무시 하겠다는, 즉 Gray scale로 하겠다는 의미)</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">train_images <span class=\"token operator\">=</span> train_images <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span>\ntest_images <span class=\"token operator\">=</span> test_images <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span></code></pre></div>\n<p>위와 같은 그림을 다시한번 확인해 보면 모든 요소가 0~1 사이의 값을 갖도록 변한 것을 확인할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># matplotlib을 통해 그림을 그린다.</span>\nplt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># train_images의 첫번째 요소를 그린다.</span>\nplt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>train_images<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>colorbar<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 점자선을 False로 둠으로써 없앤다.</span>\nplt<span class=\"token punctuation\">.</span>gca<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 302px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a929424924f67d29f957c15d08f372ec/5f1d2/output_23_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 83.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAAESklEQVQ4y22UbUxbZRTHn9vWbCOLQxN5cYFNtwmjZUCBvkBX+nJvW2h56zulpZBNpIyGyaist8BQKd0Uh8ncJmYb4nCgMcYsyPiwOd9GzJSIwGzZRMhcNNk3PxlLe49PK3SYeZJ/nifPvfd3z/+ckwchHGkoM02M1NVYtVg1j4mlqRFxNPF103l1CZuyZiB11r2FHRkjQym5GPVUjIf2oQOlJGEEijD9V8gEJF5VyABqpAcSryTbHH+mxO/rOHbIQsbepYdJTdem0/rRRhQh+X4lMjAYGt0s/FGUQoaoPLkxKijojKq22qNqVBslkR7L+LcOWSAP6b0TDzKd717f70sA9yKeBANjEIiBlQRW7AcsAyNDVkbpameUU13Mbu9pprgU77fYGdV2e5hMd0MRMtPdv0ocrvEyP0ZtiwNzkShPGbMTA/4LA5JlxBb1IHu2EbqvVcGVVT64btWB8BMf8HoHYPfxwbDizACU5bnoqpv6hsoJ84lEhjwkLHgENDLxWnGMoMBALVUHI6slMHmXC1d/4cL7QSH4ZqvA8505/PaMFhTby2nepMtZeKm5Z4OXtAdxpTizWF3WLeMGYaAM18hqNGOgGPzzGmicaYBzQSlcCJXA1H1u+NRtA0hzD9PpHxxzZJ5sHUhYjjeFMMQhFMfAUCw97qwexMgOHbQVvvj9BfgwVATn70hhOCiBibt8GF8WhE2jXih+3k0/c+YV587Xuno3MmTv4+SX4HrhBphBihyMFFlBtqMByjVOuPINH0aXhTAWKobRpWK4GBLBRIgPn/+RFw6Mx8amjt416HPu8vjWLf+JCC7KFshSnUy92QjuI0bG1N8MbZ9ZYGiZilv1/1QB79wrg69XcmF4QQ6XgyVw80FO+OqcACpTFHT6Mb9jT1PHI8tJyMJ7KWCBSw+xnfuFzMe/FcIwBpy6Q8GbX2qg+T0X+Kf10PmtFQI/VsDZ4EG4vCoI31goAMdzJL2zod/Jqzue6HISa5tV2fppU6QnqIXu25XMuXkpvDGngaOzJhgJiuH8dQUEpnXw1g8kzlYFnu9rITCvCl/4uRzU7W46u8zn5Fd6ezaNjZxHWlqgea4RTLMvMpoZN9M0a2e8i9XMiZCWeX2lgvGvlDPepVrmyKKNoWaOMpJbneGWxRYQdLTRAl6Xo0jkDmDU1jgwh8gVyJFpTcVvitgHnWu+yaq1wRu6yNmvyiODU5o190f6iHXMGakfs6/ZxhwR5UVXRD3U/leVrhVKEeU9mP9ygzS7rXsjwSf2EnlSNcuMR8WCZYWaZBvUZByCmsxDUJtcjy8BfEGw60DJssVF4b0C2UCLGvFUaF6VpNYflj5t8ycsZ6H8VCGi+qQcnUdMUL0CpKEFSEXzkcwvRloP3veJENlXhio8QiQfkCCNt5RQ0UK24rSQoETFHJJ7gF1KYlRKYhbR/0UO2vLY2ZProxELDiI2P0olMtj/ALWFCEiO8ztcAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/a929424924f67d29f957c15d08f372ec/5f1d2/output_23_0.png\"\n        srcset=\"/static/a929424924f67d29f957c15d08f372ec/5a46d/output_23_0.png 300w,\n/static/a929424924f67d29f957c15d08f372ec/5f1d2/output_23_0.png 302w\"\n        sizes=\"(max-width: 302px) 100vw, 302px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>보다 많은 이미지를 확인해 보기 위해 위에서 정의했던 <code class=\"language-text\">class_names</code>를 적용해 어떤 사진인지 label과 함께 확인해 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    plt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>xticks<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>yticks<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>train_images<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> cmap<span class=\"token operator\">=</span>plt<span class=\"token punctuation\">.</span>cm<span class=\"token punctuation\">.</span>binary<span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span>class_names<span class=\"token punctuation\">[</span>train_labels<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 573px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7dbc8bd8b63af5dca5a6373e2189da9b/3c024/output_25_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 99.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAFGElEQVQ4yzVU90+bVxT9/gH+gvwESK2QUCtVKoUQFRBQRlkiTVLAlJXBKAICNaZYhhgTgwwBm2E2GBoQYpQ9zN6ryBgoOwQIGyQ2gTBuz7PUHz77e+9779x7zj33coeHh1FnZ2djU1NT4zs7O+HDw8PBQUFBk+7u7qMKhUJERD6dnZ1jhYWFY6enp29x/mlycvJ4VFTU6MrKSvKXL1+8iouLx2NjYwfPz8+V3P39ffHl5SVZWFiQq6tr7ocPH+RhYWHk7e1NpaWl1QAUr62tEQLR1dVV293dHX9wcJDq6uoIiXTgu1ClUpGPjw9eScPJZLKygIAAsrS0JCMjoyJsZqWkpJC1tTV9/vy5HgBvNzc3aXR0lAF03dzc/KnRaKiyspI+ffrUh/PxOTk55OLiQhcXF/9yDQ0NzyQSSXlmZmZ5dXX1L7jgGhIS8t7U1PQ9LvqAku3IyEhpTU1N+dHR0UuAW5SUlBQhaMnc3NwLBLUWCoUqLy+vvzY2Nl5z+AkNDAzsR8oDoBWELAIQdRBPP8D5y8vLHk5OTn0PHjwYqKqqikMAN4D0Aqy3o6Mjfn19/Qlk60PQHtxP48bGxlQCgYBCQ0OpoqKiAIAZjNK7d+9oYGDgb2glMTAwID09PfL392eaxTCxAEqNjY09KEQcW/f09FBWVtYM19/fXxoZGUnBwcGEShasrq5mIho1NzdTV1dXXVJSUqK9vT0hS3J0dNQBXl9f08HBAeFsT3Z2dlxiYiIhU0JyM5xarXbJzc1VovTZ0MYJlH7a39/PPTk5UeLyE6lUatHU1JQ9OzubA2t4TUxMPETgTNBTQk8eLPTIwcFBAY2zFxYWXnLQiA/9NG5ublrQew3dQuCvWXNzc01tbW08QH0RZAqXtfBhMp5fsTcFqhrII8Oax9Z4/rm9vc3jsKliZY+Li6OZmZl8fMjY3t4mfX19pmktvksQgJjXWltb1bu7uwJmI+ZLGL8baxE7397eTvX19dMcAEry8vIIdJi2+SiI4tWrV2RlZcVAahcXFxPGx8cJ/9Tb26sGuGBvb48YCDTuAkMRDE9sDwlpGeWfw8PD01HlTHSMfXR0tK2NjU0WfClHxMcowCNkkYpzcnx/CqAfYLXU+fn5dEjxDIV5yNb4ng76/hzKL0Rmi5OTkytDQ0MCvEcg41U4fxHv0qWlpRceHh5LZmZmy6h8GkB5MTExS2wPBVXgjF93d/dSWVnZ3PHxcSmH6CrWVsbGxmRoaKjTsKWlhUQiEfNaLYSWwDr0/Plz1mpqaCfg8/k6mymVym7QFf3fmshay2VkZBRiuhC7BO1yAJgOaSg/P59gnyqs3zCTe3p6Mo1bysvL/2Aao9VYIdWgGcs8yHTGxJrkPn78aAdzy7CQIZIt9PgRLSaFN6XT09NO6F8zsVgsxfRJQQaP4cPvMIXewNCJsJX71taWCajHo4BsKnly8JMkIiJi19nZeR8CM9/F4PAhKO+gR5nwv4POTlFR0R7zGTIMAO1d7G1D0wJMo0AUdBfTaQOMaphtcLaIWPsBIBdrOXqSIDyjWA0QMTIhTBRmjTYej8dnfc9os1ZEDYQoEJmYmFBfX59GByiXy8nPz4/QJTpAUNZpCMGrUTlxQkIC2dnZkVarbcPY4qelpVFqaiqhOB1oNyHGnW5+YljoAL+FD31B2ReXv4EmxugIf7ShPzT9Htp+jcLxoKMvxpUpJrohppA3dPeFpczw/hUC8pD1b5inFv8Bl65n1RWxspsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/7dbc8bd8b63af5dca5a6373e2189da9b/3c024/output_25_0.png\"\n        srcset=\"/static/7dbc8bd8b63af5dca5a6373e2189da9b/5a46d/output_25_0.png 300w,\n/static/7dbc8bd8b63af5dca5a6373e2189da9b/3c024/output_25_0.png 573w\"\n        sizes=\"(max-width: 573px) 100vw, 573px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"모델-구성\" style=\"position:relative;\"><a href=\"#%EB%AA%A8%EB%8D%B8-%EA%B5%AC%EC%84%B1\" aria-label=\"모델 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>모델 구성</h3>\n<p>이제 실제로 Fashion MNIST data를 예측하는 모델을 만들어 보겠다.</p>\n<p>신경망 모델을 만들려면 모델의 층을 구성한 다음 모델을 컴파일 해야한다.</p>\n<p><strong>층 설정</strong></p>\n<p>신경망의 기본 구성요소는 층(layer) 이다. 층은 주입된 데이터에서 표현을 추출하는데 아마도 문제를 해결하는데 더 의미있는 표현이 추출될 것이다.</p>\n<p>대부분 딥러닝은 간단한 층을 연결하여 구성이 되고 <strong>tf.keras.layers.Dense</strong>와 같은 층들의 가중치(parameter)는 훈련하는 동안 학습된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">model <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">#2차원배열(28x28 픽셀)의 이미지 포맷을 28*28=784 픽셀의 1차원 배열로 변환</span>\n    keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Flatten<span class=\"token punctuation\">(</span>input_shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">#128개의 노드(뉴런)</span>\n    keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span>tf<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>relu<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">#10개의 노드의 소프트맥스층 (10개의 확률을 반환하고 반환된 값은 전체 합의 1이됨)</span>\n    <span class=\"token comment\">#각 노드는 현재 이미지가 10개 클래스 중 하나에 속할 확률을 출력</span>\n    keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span>tf<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>softmax<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">WARNING:tensorflow:From C:\\Users\\nicey\\.conda\\envs\\nlp\\lib\\site-packages\\tensorflow\\python\\ops\\resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\nInstructions for updating:\nColocations handled automatically by placer.</code></pre></div>\n<p>위의 코드를 확인해보면 model은 총 3개의 layer를 갖는 것을 확인할 수 있는데,</p>\n<p>첫번째 layer, Flatten 에서는 28x28로 되어있는 2차원 값을 1차원으로 변환.</p>\n<p>두번째 layer, Dense 에서는 128개의 노드를 가지며 relu라는 activation function을 수행.</p>\n<p>세번째 lyaer, Dense 에서는 10개의 노드를 가지며 softmax함수를 통해 classification하는 작업을 수행.</p>\n<h3 id=\"모델-컴파일\" style=\"position:relative;\"><a href=\"#%EB%AA%A8%EB%8D%B8-%EC%BB%B4%ED%8C%8C%EC%9D%BC\" aria-label=\"모델 컴파일 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>모델 컴파일</h3>\n<p>모델을 훈련하기 전에 필요한 몇 가지 설정이 모델 컴파일 단계에서 추가된다.</p>\n<ul>\n<li>손실 함수(Loss function)-훈련 하는 동안 모델의 오차를 측정. 모델의 학습이 올바른 방향으로 향하도록 이 함수를 최소화해야 한다.</li>\n<li>옵티마이저(Optimizer)-데이터와 손실 함수를 바탕으로 모델의 업데이트 방법을 결정.</li>\n<li>지표(Metrics)-훈련 단계와 테스트 단계를 모니터링하기 위해 사용. 다음 예에서는 올바르게 분류된 이미지의 비율인 정확도를 사용.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">model<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span>optimizer<span class=\"token operator\">=</span><span class=\"token string\">'adam'</span><span class=\"token punctuation\">,</span> \n              loss<span class=\"token operator\">=</span><span class=\"token string\">'sparse_categorical_crossentropy'</span><span class=\"token punctuation\">,</span>\n              metrics<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'accuracy'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>모델이 사용하는 optimizer를 선택해주고, loss function을 선택, metrics는 측정항목을 입력해 준다.</p>\n<h3 id=\"모델-훈련\" style=\"position:relative;\"><a href=\"#%EB%AA%A8%EB%8D%B8-%ED%9B%88%EB%A0%A8\" aria-label=\"모델 훈련 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>모델 훈련</h3>\n<p>신경망 모델을 훈련하는 단계는 다음과 같다.</p>\n<ol>\n<li>훈련 데이터를 모델에 주입 - 이 예에서는 train<em>images와 train</em>labels 배열.</li>\n<li>모델이 이미지와 레이블을 매핑하는 방법.</li>\n<li>테스트 세트에 대한 모델의 예측 - 이 예에서는 test<em>images 배열이다. 이 예측이 test</em>labels 배열의 레이블과 맞는지 확인해야 한다.</li>\n</ol>\n<p>훈련을 시작하기 위해 model.fit 메서드를 호출하면 모델이 훈련 데이터를 학습한다.</p>\n<p>fit 함수를 이용해 학습시킬 images와 labels를 넣어주고 epoch를 설정한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_images<span class=\"token punctuation\">,</span> train_labels<span class=\"token punctuation\">,</span> epochs<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Epoch 1/5\n60000/60000 [==============================] - 3s 58us/sample - loss: 0.5000 - acc: 0.8243\nEpoch 2/5\n60000/60000 [==============================] - 3s 53us/sample - loss: 0.3762 - acc: 0.8633\nEpoch 3/5\n60000/60000 [==============================] - 3s 51us/sample - loss: 0.3366 - acc: 0.8770\nEpoch 4/5\n60000/60000 [==============================] - 3s 53us/sample - loss: 0.3162 - acc: 0.8841\nEpoch 5/5\n60000/60000 [==============================] - 3s 52us/sample - loss: 0.2963 - acc: 0.8911\n\n\n\n\n\n&lt;tensorflow.python.keras.callbacks.History at 0x237f2119e10&gt;</code></pre></div>\n<p>위 코드를 실행하면 학습되는 상태정보를 순차적으로 확인할 수 있다.</p>\n<h3 id=\"정확도-평가\" style=\"position:relative;\"><a href=\"#%EC%A0%95%ED%99%95%EB%8F%84-%ED%8F%89%EA%B0%80\" aria-label=\"정확도 평가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정확도 평가</h3>\n<p>이제 model의 evaluate함수를 이용하여 test images와 labels를 인자로 주어 테스트 세트에서 모델의 성능을 비교해 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">test_loss<span class=\"token punctuation\">,</span> test_acc <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>test_images<span class=\"token punctuation\">,</span> test_labels<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'테스트 정확도:'</span><span class=\"token punctuation\">,</span> test_acc<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">10000/10000 [==============================] - 0s 28us/sample - loss: 0.3484 - acc: 0.8758\n테스트 정확도: 0.8758</code></pre></div>\n<p>테스트 세트의 정확도가 훈련 세트의 정확도보다 조금 낮다. 훈련 세트의 정확도와 테스트 세트의 정확도 사이의 차이는 과대적합(overfitting) 때문일 것이다. 과대적합은 머신러닝 모델이 훈련 데이터보다 새로운 데이터에서 성능이 낮아지는 현상을 말한다.</p>\n<h3 id=\"예측-만들기\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%B8%A1-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-label=\"예측 만들기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예측 만들기</h3>\n<p>훈련된 모델을 사용하여 실제 모델이 어떻게 예측하는지 test_images로 확인할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">predictions <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>test_images<span class=\"token punctuation\">)</span></code></pre></div>\n<p>테스트 세트에 있는 각 이미지의 레이블을 예측했다. 첫 번째 예측을 확인해 보면,</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">predictions<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">array([1.1595419e-08, 1.3519094e-10, 2.1264961e-09, 1.2290319e-10,\n       7.7952078e-10, 4.4512744e-03, 2.5239646e-07, 7.9262927e-03,\n       1.2780076e-07, 9.8762208e-01], dtype=float32)</code></pre></div>\n<p>이 예측은 10개의 숫자 배열로 나타낸다. 이 값은 10개의 옷 품목에 상응하는 모델의 신뢰도(confidence)를 나타내고 가장 높은 신뢰도를 가진 레이블을 찾는다.</p>\n<p>해당 10개의 값중 가장 큰 값을 정답이라고 생각할 것이기 때문에 numpy의 argmax함수를 이용해 가장 큰 값을 갖는 인덱스를 찾자.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>predictions<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">9</code></pre></div>\n<p>모델은 이 이미지가 앵클 부츠(class_name[9])라고 가장 확신하고 있다. 이 값이 맞는지 테스트 레이블을 확인해 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">test_labels<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">9</code></pre></div>\n<p>오! 정답..^^</p>\n<p>위와 같은 방식으로 총 25개의 test_images에 대한 이미지와 예측결과를 비교해 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    plt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>xticks<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>yticks<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span><span class=\"token string\">'off'</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>test_images<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> cmap<span class=\"token operator\">=</span>plt<span class=\"token punctuation\">.</span>cm<span class=\"token punctuation\">.</span>binary<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># predictions에서 가장 큰 값을 predicted_label 로 가져온다.</span>\n    predicted_label <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>predictions<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    true_label <span class=\"token operator\">=</span> test_labels<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n    <span class=\"token comment\"># 이때 실제 test_label과 일치하면 초록색 글씨로,</span>\n    <span class=\"token keyword\">if</span> predicted_label <span class=\"token operator\">==</span> true_label<span class=\"token punctuation\">:</span>\n      color <span class=\"token operator\">=</span> <span class=\"token string\">'green'</span>\n    <span class=\"token comment\"># 일치하지 않으면 빨간색 글씨로 출력한다.</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n      color <span class=\"token operator\">=</span> <span class=\"token string\">'red'</span>\n    plt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">\"{} ({})\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>class_names<span class=\"token punctuation\">[</span>predicted_label<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> \n                                  class_names<span class=\"token punctuation\">[</span>true_label<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                  color<span class=\"token operator\">=</span>color<span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 591px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c88fb25e850211d1ac27b51991cb19e9/e4c9a/output_49_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 96.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAAFmUlEQVQ4yx1U7VNSaRTnf+nDfqhmpxlrdiZ33BqzcmutJtNGq5l1LbNVa0WcTBuUMlBM05IQMBES30oF0RQFRRCQDLgiIKAgFzWVK77xYoJnn9u9H+7znOc5v3vO7/zOoeA4fj4UCmkAQBeLxd4tLy+nU6lU3ZUrVwzj4+N0ZL/L5XKNt2/fNqB71Hg8/ri2tnaGzWYb0Fm+z+craW5u1tfV1c0g3xxKIBDIQgeg1WpBJBZ9M5vNJZmZmZCSkgLV1dX96Kiqra0Nyp6VweHhYRvat+h0OtDpdaRbo0qlEqIHWCwWyGSyVxSb1Zb11fgVPrR+ADqdbprWTtPS09PhdMJpqKiokCInhmZKA12dXbC7s9uO9nzbvA1MJhMJ2IR8RR/FH0EgEIBGo2FRhBPCxBnHDMfisXAxP1baIGm4+LLpJYdeT+fRX9P/9hG+i93D3S2MN4wWi9uSYXaZb4oHxC1tn9paZhdmr3l8nhvMZia3nlfPXV1dTaagv1z61PcJSziTYHUtuYT7kf1szbTGOqYcsx/GD1n+Vf8/8mH5Qmd3p30ZXy4ntojS2FHMEYe4fX1z/UkkEilHGLZYPGZfWVnJIwGzjUYjIKJhbW3NvLmxSVtcXISdnR3YWN+Qeb3eF6MjozA4OEim2U4ECIHX44Xt4Dasrqy+tVgsYq1G+5MSHo9XQzk6OspwuV2AKgmoYloE8Fhv0IPT5QT3orvL6XSW9/b2QkdHB6ACcHd3d9+iSsMRete+r7GtVisPBQIocrA77FUUs9t8XK6Rv3xU9qhajalz9Rr9qZHpEcaUdaoGs2FpKKrf+sb7mJ1fOlmqSVWK0W68rF/Q1xqchhqNSXNhfm3++oR5gqW1aWuxZew8mfJ1znvObtq1tBCSwkg4HM5DtlCACBx4vJ7W/f19pL3YD2SLosjq0bdmaHjoB5LIAakAH+57k5SUFLmZfvMARfmUsrW1ld3U1ASZGZnQ1dVlQgA0RC5IOiQgahcNNHM4DGF7O3wZGYG+/n4hKZtOSSeQUiFlg+6Ijh07BieOnwCpVMqi6PX6NJlcFlQoFXtSmVSOeHiAWbE9m2M+8s1i4mtUE8UOq/Vg0eGITKvVrxEIk1pKjVJp1DBa01tbW+tO/noydPb3s2H5kLyUsuRe+qVf0V9Z2VDJMnwz3J13z5+RDEtYLC6TrTKr02PupSRscJA9zOHUhp2uvzC3LcXg0NdiXowV3Aue183oLqVmpjLvF99/hfvxRJLDzNnZWSguLiZbS2e325+IxWLg8/kwphjr9ni9FRXPn8PD/HwYGh7mISm9GxgYALLdenp66hRjCn5ycjLk5uYCkhuDchQ/yt7e3obenl5AErLMfp2lkbpDgwEUowrppFr9opbNhkoGAz52dIjmsDnBvbv34PKly5CamvoWBdR+9epVQMOB5JRJ2QntpLg8LjOzjjl3ED9o/Sz7nCX7IpuTj8rtHb0S5szUVE5jTY3jycOH80Ier8y/ulI8ohxxqDQqm2pCVYBv4vRzKedsJc9KHCvBlQKK3WM/lV+Sz0lISuA28hv/s3lt5/AgziWiBM/53Z2zaLZcAILgQzTackQQGfjaalogEuATYYK7H97/c843d6eSXdnS3NbcYsJNNyhKpTL7VvotSExMhMKCQlM0GqUFg0HALBigSTIQioQZ0YMDmJxSkxy27+/tCaKRKCjHxqGJ1BuAUCKRgHpSTab8ijLQP5BVVFj0k1RaCc2ECKeJReKfrSjgC6SDskFGw+t6yHuQB4X/Fgj7pFIev1UAze/fQ05ubiMCEY0jcIvZQgKyKAqN4g9qOXUsJz9HWcWqqsfX8LT17XUlESIm/Rv+p8Y5Yxa+gU8F9jYn8YC/6Lt1vmAXx9XR9fXJzQXnfXzTX9Td36UaGh+aJHaJO/8DO6hPk92lpB0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/c88fb25e850211d1ac27b51991cb19e9/e4c9a/output_49_0.png\"\n        srcset=\"/static/c88fb25e850211d1ac27b51991cb19e9/5a46d/output_49_0.png 300w,\n/static/c88fb25e850211d1ac27b51991cb19e9/e4c9a/output_49_0.png 591w\"\n        sizes=\"(max-width: 591px) 100vw, 591px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>빨간색 글씨가 3개로 확인. 오답이 3개~</p>\n<p>이제 10개의 신뢰도를 모두 그래프로 표현해 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">plot_image</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> predictions_array<span class=\"token punctuation\">,</span> true_label<span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  predictions_array<span class=\"token punctuation\">,</span> true_label<span class=\"token punctuation\">,</span> img <span class=\"token operator\">=</span> predictions_array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> true_label<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n  plt<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n  plt<span class=\"token punctuation\">.</span>xticks<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  plt<span class=\"token punctuation\">.</span>yticks<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  \n  plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> cmap<span class=\"token operator\">=</span>plt<span class=\"token punctuation\">.</span>cm<span class=\"token punctuation\">.</span>binary<span class=\"token punctuation\">)</span>\n\n  predicted_label <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>predictions_array<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">if</span> predicted_label <span class=\"token operator\">==</span> true_label<span class=\"token punctuation\">:</span>\n    color <span class=\"token operator\">=</span> <span class=\"token string\">'blue'</span>\n  <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    color <span class=\"token operator\">=</span> <span class=\"token string\">'red'</span>\n  \n  plt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">\"{} {:2.0f}% ({})\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>class_names<span class=\"token punctuation\">[</span>predicted_label<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                                <span class=\"token number\">100</span><span class=\"token operator\">*</span>np<span class=\"token punctuation\">.</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>predictions_array<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                class_names<span class=\"token punctuation\">[</span>true_label<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                color<span class=\"token operator\">=</span>color<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">plot_value_array</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> predictions_array<span class=\"token punctuation\">,</span> true_label<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  predictions_array<span class=\"token punctuation\">,</span> true_label <span class=\"token operator\">=</span> predictions_array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> true_label<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n  plt<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n  plt<span class=\"token punctuation\">.</span>xticks<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  plt<span class=\"token punctuation\">.</span>yticks<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  thisplot <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>bar<span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> predictions_array<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span><span class=\"token string\">\"#777777\"</span><span class=\"token punctuation\">)</span>\n  plt<span class=\"token punctuation\">.</span>ylim<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> \n  predicted_label <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>predictions_array<span class=\"token punctuation\">)</span>\n \n  thisplot<span class=\"token punctuation\">[</span>predicted_label<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>set_color<span class=\"token punctuation\">(</span><span class=\"token string\">'red'</span><span class=\"token punctuation\">)</span>\n  thisplot<span class=\"token punctuation\">[</span>true_label<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>set_color<span class=\"token punctuation\">(</span><span class=\"token string\">'blue'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>0번째 원소의 이미지, 예측, 신뢰도 점수 배열을 확인해 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">i <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\nplt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nplot_image<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> predictions<span class=\"token punctuation\">,</span> test_labels<span class=\"token punctuation\">,</span> test_images<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\nplot_value_array<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> predictions<span class=\"token punctuation\">,</span>  test_labels<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 356px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/140f970838157a77f9b0072dca5d3e93/50ac3/output_54_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACMElEQVQoz4WSTWsaQRjHh15baNqmX6KX2t4WCv0AHgI5RIl+BEEPghATKPYkUkuIqRC89SIx4CmINUi1riImBkObBd9dvMi6G3V326zOS2fsKqnQ5oH/zOwzw2//zzMDyuXyeqVSefYPPc9ms48AjVqt9rbT6Tiotqhsd7TV7XZtrVbLlkgk1sB4PMa6rquapukLqarKNDEMg/R6vY8MOBwOv5F7Ip/Pvwb/2cdsoKBPDDgajTJmfkqF7giyeTZDkOf5lwsgRDQYhLrF7XYb088pdc8cRhhQUZSz+V8wnuGVMBG4WOQtwDyEFo7S6TRxuVzE4/HMwuEwof1ZBcJlCfjPyKz0+xBnsyaQWYYQ4lKpREKhEIMRh8Mx83q9JJlMzoGyLP8FZMYQwvOVohCyvQ1xNEqB1WqVpFIpFIvFcCAQIG63m9jt9jnQ6XQy+BwoSdISuKzSNCrLhGxsQByJUGA8HicUNN3d3YM+nw/6/X4YDAah1Wo1GJiWfWDe8rKHbKIvgPb7J2YZScJkcxPiw8OCBdz3FBRFPlq5ZQZE9XodFYtFdHV1ga6vB9hmI2h/P2cBNzdqW9OMH7puCJOJUZ9MfgmjkSao6u13Tbvti2J/jwEHg8FXRmNvk4UgCKRQ4Ekud0YuL0VCgbT/X17Ro/7HAETXAfjwFIDAEwDerQFwQNdHNPeezuABA56fX7xoNptvGo0GJ4oil8lkuOPjBHdyEudOT3nOam1zOzufH/4GmNCk81H4RZQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/140f970838157a77f9b0072dca5d3e93/50ac3/output_54_0.png\"\n        srcset=\"/static/140f970838157a77f9b0072dca5d3e93/5a46d/output_54_0.png 300w,\n/static/140f970838157a77f9b0072dca5d3e93/50ac3/output_54_0.png 356w\"\n        sizes=\"(max-width: 356px) 100vw, 356px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">i <span class=\"token operator\">=</span> <span class=\"token number\">12</span>\nplt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nplot_image<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> predictions<span class=\"token punctuation\">,</span> test_labels<span class=\"token punctuation\">,</span> test_images<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\nplot_value_array<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> predictions<span class=\"token punctuation\">,</span>  test_labels<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 356px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f9e302a9169fd2feb594b07972cfd915/50ac3/output_55_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACJUlEQVQoz42Sz4tSURTHb+siqmnof2iTtXsQtOkfyMW4EHHhJlwILQYUy4UrNxLSUNAwTLsCFy79iYVpg6iokOjIk9dDZPytT30x+e69p3NfRiVMzOGdew/n3Pt5937PJcVi8XapVNq5wHez2ew1glav1x8pimJH31NU1aY0mzalVrNhvPdNUWydTscWjUZvEE3TuK7ry9VqpS+XS13MG1+s12tQVfWlAI7H48/wtxWLAJHIP6lcLveAwMXGxYCg1wI4n8/TZpaxtRghkWCwv88wppgTRguFwr3fQCoW4Wa+AXE0sRH6/f6BAM5ms4z5F0oNLuqpFOc+HxcxUIof5Qi0ENQQDMNgjUaDBwIBiMfjMBqNBNEQALz6NpCaR0gmAXw+MIGM/QHa7XYIBoPM7/fzUCgE4XAYpYlALBYzKpUKpFIpEzidTi8HtFqt4HK5mNPp5A6HA9xuN3i9XvB4PAbmAOsHm6ZcDthqtaBWq60r5TIto+NTodVqVfiP4XAIvV7v1dYJf2mYTJoaMhFvNMzn85b/ddk0BL3d6rJhdjmdZnhCZsbIFG0+OfliIQtNk/XForGaz5v6ZNI2Z/SVpn39rutqt9t9LoCDweCT4Bnn5+YzYAm88gsv1FWAyVCoYEAm8/G+WEvw5d48JmQXxbr1jJDrHwi584aQHSxdIRvDBt2VZfmh3G5Lcr8vnR69k0bep9LjJwPp+KgtnZ2dSoeH76/+BMtOqPtZfFf7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/f9e302a9169fd2feb594b07972cfd915/50ac3/output_55_0.png\"\n        srcset=\"/static/f9e302a9169fd2feb594b07972cfd915/5a46d/output_55_0.png 300w,\n/static/f9e302a9169fd2feb594b07972cfd915/50ac3/output_55_0.png 356w\"\n        sizes=\"(max-width: 356px) 100vw, 356px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>몇 개의 이미지의 예측을 출력해 보면, 올바르게 예측된 레이블은 파란색이고 잘못 예측된 레이블은 빨강색이다. 숫자는 예측 레이블의 신뢰도 퍼센트(100점 만점)이고, 신뢰도 점수가 높을 때도 잘못 예측할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 처음 X 개의 테스트 이미지와 예측 레이블, 진짜 레이블을 출력</span>\n<span class=\"token comment\"># 올바른 예측은 파랑색으로 잘못된 예측은 빨강색으로 나타냄</span>\nnum_rows <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\nnum_cols <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\nnum_images <span class=\"token operator\">=</span> num_rows<span class=\"token operator\">*</span>num_cols\nplt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>num_cols<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>num_rows<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>num_images<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  plt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span>num_rows<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>num_cols<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  plot_image<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> predictions<span class=\"token punctuation\">,</span> test_labels<span class=\"token punctuation\">,</span> test_images<span class=\"token punctuation\">)</span>\n  plt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span>num_rows<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>num_cols<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>i<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n  plot_value_array<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> predictions<span class=\"token punctuation\">,</span> test_labels<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 708px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2be05572804cff1e55f90a0c8d119c15/3cb0f/output_57_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAAEsUlEQVQ4yzWU/U9aZxTH+T+W/dB0/WVJl+ylcc2S9aelSZt0c/vB1bXZ7FqXRre1SdN27WLfZtZaqiu+IILirBZbkVrUVkAUpcDFIqC8K4K83cvlXi7eC5cLXC7PHkx3k+eH+z05J5/vOed5ROHwzgFBECYBAHMkmW3J5XIPWJZdBIC/8eLFTFtjY6Ohs/NuD47XzprNhflSiZkol6tNExNPxy5caJ2vVks/Tk1RYpbl9DRNd4gwLHGkVOLA7KwWKBRDClg4Ag9Ip4FtYKBfc/To5+DMmSaM44CUIMD/n1irfQnkcjkQhJJsdraSqovVKr8u0uvdhy2WNc/MzFxcqXz2J9Sfx+MxTCbjpHL5kwfHjn1FtLZenE8khCsWCx8FoOwgycKv6+ubDqVyPJnJZK9rtdw0zwsoBJOL/H5wcH7ePCiVjo9Bgh8mJlLXkkl0NBpNXrTZtn6WySYmFQrNvVSKasRxcoii8EepFHNqeFgtOXfu0pNYjIL20eskSSlxPN0mgkSfer0esLS0VIeWzsxwgXe2TGazaXJ0dATcvt2xC/8ldXF7ez92X61WCzLZILRZ7Jubq+y3iecrVlG1WvsoEAgQCws6gWX37k9NsaZ6UBCqU3a7Xdrb2wcGBqT2RCJ8F8PY2spKJQ0AfWNtzZEYGVHWMhm0U6PhLPUcjivOiAIB/n2t1ipWKrX9oRD57epq6qLHQz0mCPSsz5f8vr9fNTQ3Z70ajQaPh0LoQ6OR7AiFIse3t+m/V1d9A05n8hunE2t3uageDEu3QMLqJ263W4hGoxCZleB4yZXJ7NvSbWxsjBkMerCwsBCsT7YuIkitwvPkPdjnQrlcBiiK9tRqvBemg0qlsiSCu/MxgiCVYDAEslnsHwyrODBsv+Aro3H53+lpDYA754f97aqLVqtQLJXwO5FIjMnnCyCVQrthoY0I7GK5XDGIXK7N9xyO8ONQiFBEImhjNIr+ZrORg+Fw+pzD4TvT1TU8Njmpu0nT+MlwmJQgCNHp822diMWKj2gaDPv9xHcomrq8uEhJMQxrFcXjicMEQaScTlfxzRvkLwiu390VgN1eU/l8SO/p081ALO4xQ7iO9XWeIwg+RtOZq5Bmx+v1cU6n+y7P88t2u1DjOG4KEr79zOvdBE6nA+h0OjlM3Klb29wEFptNN93d3Q26u3tQKA1QFADFIgAsSzx0u13AZrPAnIVBGEvkcvW14d+KDIb4gUymKsvnwROfL9tcKBBXggFmFEEKvxiNSz85HDvPXr+23aGo+Ndm895QJEKJ4ZRPBYOZvnicGff7M025HHltba0wApe7TbTh3voQTeFuksxFM3j2jxzNqHjEkirQZD/NFDtVqueY3x98SRD5yysr3E4ux6xBorb29kv2hoYvdsPhyNVMJq/GcS5ZKDBDIkmv5IhqUgWsNiswmZYVtfrjwLKgVCzahJqgkUgeA4fDjlWrQPpu+tA2Iz558gQ4dOgDoFaPyxgGJHl+/644RB4EOUgkk5osium3PJ7zDFvoYkwWI5Ykb+b28r+fP9++oteb+miaO7u8zL7a22OfptNoU3Nzi6qh4UuDTveqZWsr+2h1lVxkmOyt/wD+SvWxavhp3QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/2be05572804cff1e55f90a0c8d119c15/3cb0f/output_57_0.png\"\n        srcset=\"/static/2be05572804cff1e55f90a0c8d119c15/5a46d/output_57_0.png 300w,\n/static/2be05572804cff1e55f90a0c8d119c15/0a47e/output_57_0.png 600w,\n/static/2be05572804cff1e55f90a0c8d119c15/3cb0f/output_57_0.png 708w\"\n        sizes=\"(max-width: 708px) 100vw, 708px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>마지막으로 훈련된 모델을 사용하여 한 이미지에 대한 예측을 만들어 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 테스트 세트에서 이미지 하나를 선택합니다</span>\nimg <span class=\"token operator\">=</span> test_images<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(28, 28)</code></pre></div>\n<p>tf.keras 모델은 한 번에 샘플의 묶음 또는 배치(batch)로 예측을 만드는데 최적화되어 있다. 하나의 이미지를 사용할 때에도 2차원 배열로 만들어야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 이미지 하나만 사용할 때도 배치에 추가</span>\nimg <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>expand_dims<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(1, 28, 28)</code></pre></div>\n<p>이제 이 이미지의 예측을 만들자.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">predictions_single <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>predictions_single<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[[2.7692769e-05 5.9337044e-08 3.9947031e-06 2.0716065e-08 5.4740326e-06\n  2.3610677e-01 1.6528367e-05 2.1145634e-01 4.4389912e-05 5.5233872e-01]]</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plot_value_array<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> predictions_single<span class=\"token punctuation\">,</span> test_labels<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xticks<span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> class_names<span class=\"token punctuation\">,</span> rotation<span class=\"token operator\">=</span><span class=\"token number\">45</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 356px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/61bd1485969fac03a0ddac2978b3ddf9/50ac3/output_64_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 79.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACBklEQVQ4y62TPW/aUBSGLykpqVJjNQSM+RBClQXChB/QhTVdImVJUejWdqi6WGLrXgYW1DIAYkJI/QX5EwxIkZ0BKTICBAPBkahkQ11/9VxjWtpGKqW50iu/5/ie597j64va7fbT4XD4djwevx6NRm+21CuofycIwjPU6/VeWvc0JpNJAw0GgxdOrII0kL6FvmKAJEkfUb/fzzlA3dxyGIaJN2JNp9PKH8B/bXNZcQ9APHM1W5aXQEn6T6BhLP3xsalxHAD0vwBxuErd5eHb2THDmNrpqd30ZjtcT69g68CjI1PL5TYAru9qPp9bi8Xil4WWLZsWy5ra2dlP4Oo//AbF+l3Ci1WrVb3ZbNoeavRGo6Hf3Eh2nEoZqgP8hODa5Tc5hHq9brVaLduLomgVCgU41Vs7ZlnLOj/H7raGut3u89lsJkI7l4qi8CBBluUraJGHp4BzqqoK5XJZqNVqPFQJnU7nCoDC9bUowOXik8kv/MnJoq8ow/com83ucBy3S9N0IBwOH8ZisQOGYchIJOKLRqO+eDz+JBQK+SmK8pIkSYGnEonEY4IgfJDz03QwGAh8cHs8QZplEx7kDAIUAB2A9kF+0CPH74IeOu/2HI/zhyA3CEN8INImpdNpl9frJaAVhFUsFl35fH4H/TYqlcoPn8lkHpRKJdunUkm3y7Vvwy4uPqPvxgfXoAdTf2MAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/61bd1485969fac03a0ddac2978b3ddf9/50ac3/output_64_0.png\"\n        srcset=\"/static/61bd1485969fac03a0ddac2978b3ddf9/5a46d/output_64_0.png 300w,\n/static/61bd1485969fac03a0ddac2978b3ddf9/50ac3/output_64_0.png 356w\"\n        sizes=\"(max-width: 356px) 100vw, 356px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>model.predict는 2차원 넘파이 배열을 반환하므로 첫 번째 이미지의 예측을 선택한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">prediction_result <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>predictions_single<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>prediction_result<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">9</code></pre></div>\n<p>이전과 마찬가지로 모델의 예측은 레이블 9이다.</p>"},"primaryTag":{"name":"ML-DL","color":"#4bc822"}},"pageContext":{"postId":"b1d7620a-6daf-5731-a628-60fad80473eb","primaryTag":"ML-DL"}}}