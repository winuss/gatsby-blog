{"componentChunkName":"component---src-templates-post-tsx","path":"/kafka-cluster","result":{"data":{"post":{"headings":[{"depth":4},{"depth":5},{"depth":4},{"depth":4},{"depth":4},{"depth":4}],"frontmatter":{"title":"카프카(Kafka) 설치 및 클러스터 구성","path":"/kafka-cluster","tags":["DataLake","Kafka","ELK"],"excerpt":"Kafka를 설치하고 간단하게 클러스터 환경을 구성하여 Producer 및 Consumer 테스트를 해보자.","created":"2019-01-25T00:00:00.000Z","createdPretty":"25 January, 2019","updated":"2019-01-25T00:00:00.000Z","updatedPretty":"25 January, 2019","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAACTElEQVQozw3Q207aYAAA4L8HoNAWeqCcFaEqikIGSEdbC+UglrOAsEmH4sbIphBFYGiYxmTJLpZlcXd7hD3m9j3CB/hM350bcvmJVZmypUe89mTSlkj8ArgLsDdrJJMWTwZzZQxuFWLlQLJT7s3YaAuKdNHkCPjzI650R0gTIj03Srem7PjV+aNdvQQORWxc+eNtxKUSvGawywZKILfLrpRujulI5sacWQHvydJWvbeoU4M8NgnvifQlo/Sx3QrEpui9OhltmvYb1tQba6ROJU4xoccVrpjKktd/oMkvwKYt/a1HNDaAQy0TX6FibciahFkJpkWEUzB3xrhbweNtWtaJZA/snQVPnxyN59DpN6c4BYnxL3/nHn/dxxMdNHBkXsshjIj5jyzrBWw9D3MSGW8Tkm5Rh8TRxCyPieyMKy1D3aeL1R9AiB+gzZqR1/DNYy7RplJv0Z2qOXhMhqtUuGrwZhmhhwmXTG1hO1nR2pJOTwLl6X7zlst+BHCobvBlISplXcuFi0N0q+yXdLH2GWwdWyJN44HOFG+o4gIvPTibX7caS296GFQHG/IZnewCwKQQpwyhUYgUUF4DaNTqUryJDrxThxPnpsIMVRaIcBdsPQvD7y7t2iGeedL9YOPaVRyB/z02XiOdGYgSzaEyTB6we3VffuSqzeOfXhB55lDv3em5/fB6vTx2Kxc4X7JLfd/JNPBuBVCPSobruEdFHYeWbc20USTEga24oAuraOcnCN2sKQ+7xTkljdjDgT3SpGNdX2sWmf9Ov/z9B0Q/f2BKQJK8AAAAAElFTkSuQmCC","aspectRatio":2.0618556701030926,"src":"/static/d5aa304e7f0b59c0f49b3013888d25fe/90823/cover.png","srcSet":"/static/d5aa304e7f0b59c0f49b3013888d25fe/dc47e/cover.png 200w,\n/static/d5aa304e7f0b59c0f49b3013888d25fe/9f2d5/cover.png 400w,\n/static/d5aa304e7f0b59c0f49b3013888d25fe/90823/cover.png 800w,\n/static/d5aa304e7f0b59c0f49b3013888d25fe/f86ae/cover.png 834w","sizes":"(max-width: 800px) 100vw, 800px"}}}},"html":"<p>Kafka를 설치하고 간단하게 클러스터 환경을 구성하여 Producer 및 Consumer 테스트를 해보자.</p>\n<p>먼저 가상머신을 이용해 다음 그림과 같이 클러스터 환경을 구성하여 테스트를 진행할 것이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1172px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/473e8df68fe8b16fdada7cc1271a949d/511f0/kfc-01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABcRAAAXEQHKJvM/AAADC0lEQVQ4y32T62/bZBTG8x8hvsIXPsI0JhBDaEJCIK0SGx+ATVs0rWVi+UCF2k3qLu3WsQuaJjpYW7aqaANGUenKstZJL8lSrCyJ0yyp4yS2c7Mdxz98yQoREkc6sl+/r5/znPc8TyiVSiGsrhATBKRcFsfpYpomnU6HdruNLMuUSkXKZZmdnRL1eh3LsnbTtMzd9NahbCbD5tMtCjsKpoMfjhO82LbNZiLJ74tLRFcEok9WfMD/i5DlMmksfos2cxrdzU4h6W90u10c22TyrsiR8xsMXklw4vIGNdUDDApatsF0bJzbq2P8IFyg3lZdQLuLOvkR1cgrlE++RO3xDOZuPYsTE3EOn41z84HE3vBSDzAItVHl2PQ+js/u4+j0XmS94DG0aUwdQzv7JvXR11GFedL5otua7jXN6WsbvHsq6oO+H4lS7TGUcnmey9t89eAgwz8PMPzLANWmTMgbgBT/g9zj+6QWZlBLeUy3iCiKGK0G9xYlznyXYvhmkonZv9D0BtlsBkVRMIw2y+sLRJOLLMUeotW9lt3JdPzmwPA5BVFvNCk9lxi5leDQmRiRG0k+cVk+y0hUlPI/U+j2rtT27t0JWjbXfqL160Xav13CKIoUSmXS6TRadYfjFwUGRuJcnc+yJ/yIfKHI9nYeScr7UskoCUR5jWfKJh3bCoZSu/whSuRVyoMvk7l/FVlr0bU7fvmx71Mcdhl+OrbG5+fiqHrTJ6aUK6RzIl/Of8DgvfcYmjuAUi8GgM1bn6GPvoE2/BpW8mFPjF3sjiuLhQyR6wm35QTn72z1yUZvqYRn3+bk3H7Cd99CaRSDoeQezbnMrvP0xwmK4npPh45/s6e+Wefg1wKjUyL7v1juA2wZTaaWL3DnySVu/zmOosrBUEz3Yj3ttdynYdm+UwKzWAxNeoAxzk2neWdouU+H3r8VuYZa0Slul9A1nZDn2V6Pu5WdFxZ0nTIxs8WhUYGPR1YJj69Rrel9Z/5jPcMwfJt5vv13et+8vVpNc1kFWamqNJvNvvMeoRfprf8Go9vjOyrzgcMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img\"\n        title=\"img\"\n        src=\"/static/473e8df68fe8b16fdada7cc1271a949d/511f0/kfc-01.png\"\n        srcset=\"/static/473e8df68fe8b16fdada7cc1271a949d/5a46d/kfc-01.png 300w,\n/static/473e8df68fe8b16fdada7cc1271a949d/0a47e/kfc-01.png 600w,\n/static/473e8df68fe8b16fdada7cc1271a949d/511f0/kfc-01.png 1172w\"\n        sizes=\"(max-width: 1172px) 100vw, 1172px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>이 글에서는 3대의 서버를 생성하였지만 1대의 서버로 포트를 다르게 하여 구성할 수도 있다. 또한 Kafka와 Zookeeper서버를 동일한 장비에 구축하였지만 실무에서는 별도로 구축하는 것이 좋다.</p>\n<h4 id=\"kafka-다운로드-및-설치\" style=\"position:relative;\"><a href=\"#kafka-%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C-%EB%B0%8F-%EC%84%A4%EC%B9%98\" aria-label=\"kafka 다운로드 및 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kafka 다운로드 및 설치</h4>\n<p>다운로드(각 버전에 대해서는 <a href=\"https://kafka.apache.org/downloads%EB%A5%BC\">https://kafka.apache.org/downloads를</a> 참고하자.)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">wget</span> http://apache.mirror.cdnetworks.com/kafka/2.1.0/kafka_2.11-2.1.0.tgz</code></pre></div>\n<p>압축해제 및 경로이동</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">tar</span> -zxvf kafka_2.11-2.1.0.tgz\n$ <span class=\"token builtin class-name\">cd</span> kafka_2.11-2.1.0</code></pre></div>\n<p>Kafka의 동작은 Zookeeper에 의해 관리가 되기 때문에 Zookeeper 없이는 Kafka를 구동할 수 없다. 이 때문에 Kafka를 다운로드 하면 Zookeeper도 함께 들어있다. 물론 별도로 최신버전의 Zookeeper를 다운받아 사용해도 되지만, Kafka에 들어있는 Zookeeper는 Kafka버전과 잘 동작하는 검증된 버전이므로 패키지 안에 있는 Zookeeper의 사용을 권장한다.</p>\n<h5 id=\"zookeeper-설정\" style=\"position:relative;\"><a href=\"#zookeeper-%EC%84%A4%EC%A0%95\" aria-label=\"zookeeper 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Zookeeper 설정</h5>\n<p>각 인스턴스에 설치된 Kafka의 config/zookeeper.properties 파일은 하나의 Zookeeper를 실행하는데 쓰이는 설정 파일이다. 이 말은 zookeeper1.properties, zookeeper2.properties, zookeeper3.properties 이런식으로 여러개의 설정파일을 만들고 하나의 장비에서 다중으로 실행할 수 있다는 의미이다. 설정파일을 다음과 같이 3대의 서버에 동일하게 추가하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">vi</span> config/zookeeper.properties</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># the directory where the snapshot is stored.</span>\n<span class=\"token assign-left variable\">dataDir</span><span class=\"token operator\">=</span>**/tmp/zookeeper**\n\n<span class=\"token comment\"># the port at which the clients will connect</span>\n<span class=\"token assign-left variable\">clientPort</span><span class=\"token operator\">=</span><span class=\"token number\">2181</span>\n\n<span class=\"token comment\"># disable the per-ip limit on the number of connections </span>\n<span class=\"token comment\"># since this is a non-production config</span>\n<span class=\"token assign-left variable\">maxClientCnxns</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>\n\n<span class=\"token assign-left variable\">initLimit</span><span class=\"token operator\">=</span><span class=\"token number\">5</span>\n<span class=\"token assign-left variable\">syncLimmit</span><span class=\"token operator\">=</span><span class=\"token number\">2</span>\n\nserver.1<span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.137.101:2888:3888\nserver.2<span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.137.102:2888:3888\nserver.3<span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.137.103:2888:3888</code></pre></div>\n<p>새로 추가한 설정값은 클러스터를 구성하는데 필요한 설정 값들안데 여기서 주의할 점은 모든 Zookeeper 서버들은 동일한 변수 값을 가지고 있어야 한다.</p>\n<p><strong>initLimit</strong></p>\n<p>팔로워가 리더와 초기에 연결하는 시간에 대한 타임아웃</p>\n<p><strong>syncLimit</strong></p>\n<p>팔로워가 리더와 동기화 하는데에 대한 타임아웃. 즉 이 틱 시간안에 팔로워가 리더와 동기화가 되지 않는다면 제거 된다.</p>\n<p>이 두값은 dafault 기본값이 없기 때문에 반드시 설정해야 하는 값이다.</p>\n<p>그리고 server.1,2,3의 숫자는 인스턴스 ID이다. ID는 dataDir=/tmp/zookeeper 폴더에 myid파일에 명시가 되어야 한다.</p>\n<p>/tmp/zookeeper 디렉토리가 없다면 생성하고 myid 파일을 생성하여 각각 서버의 고유 ID값을 부여해야 한다. </p>\n<p>(그 외 자세한 설정정보를 알고 싶다면 <strong>주키퍼 가이드문서</strong>를 참고하자.)</p>\n<p><strong>1 서버 (192.168.137.101)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">mkdir</span> /tmp/zookeeper\n$ <span class=\"token builtin class-name\">echo</span> <span class=\"token number\">1</span> <span class=\"token operator\">></span> /tmp/zookeeper/myid</code></pre></div>\n<p><strong>2 서버 (192.168.137.102)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">mkdir</span> /tmp/zookeeper\n$ <span class=\"token builtin class-name\">echo</span> <span class=\"token number\">2</span> <span class=\"token operator\">></span> /tmp/zookeeper/myid</code></pre></div>\n<p><strong>3 서버 (192.168.137.103)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">mkdir</span> /tmp/zookeeper\n$ <span class=\"token builtin class-name\">echo</span> <span class=\"token number\">3</span> <span class=\"token operator\">></span> /tmp/zookeeper/myid</code></pre></div>\n<p>이제 Zookeeper를 구동하기 위한 설정은 끝~</p>\n<h4 id=\"kafka-설정\" style=\"position:relative;\"><a href=\"#kafka-%EC%84%A4%EC%A0%95\" aria-label=\"kafka 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kafka 설정</h4>\n<p>Kafka의 config/server.properties 파일은 하나의 Kafka를 실행하는데 쓰이는 설정 파일이다. Zookeeper와 마찬가지로 여러개의 설정파일을 만들고 다중 실행을 할 수 있다.</p>\n<p>설정파일 config/server.properties에 3대 서버 각 환경에 맞는 정보를 입력해 준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">vi</span> config/server.properties</code></pre></div>\n<p><strong>1 서버 (192.168.137.101)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">broker.id<span class=\"token operator\">=</span><span class=\"token number\">1</span>\n<span class=\"token assign-left variable\">listeners</span><span class=\"token operator\">=</span>PLAINTEXT://:9092\nadvertised.listeners<span class=\"token operator\">=</span>PLAINTEXT://**192.168.137.101**:9092\nzookeeper.connect<span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.137.101:2181, <span class=\"token number\">192.168</span>.137.102:2181, <span class=\"token number\">192.168</span>.137.103:2181</code></pre></div>\n<p><strong>2 서버 (192.168.137.102)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">broker.id<span class=\"token operator\">=</span><span class=\"token number\">2</span>\n<span class=\"token assign-left variable\">listeners</span><span class=\"token operator\">=</span>PLAINTEXT://:9092\n\nadvertised.listeners<span class=\"token operator\">=</span>PLAINTEXT://**192.168.137.102**:9092\nzookeeper.connect<span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.137.101:2181, <span class=\"token number\">192.168</span>.137.102:2181, <span class=\"token number\">192.168</span>.137.103:2181</code></pre></div>\n<p><strong>3 서버 (192.168.137.103)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">broker.id<span class=\"token operator\">=</span><span class=\"token number\">3</span>\n\n<span class=\"token assign-left variable\">listeners</span><span class=\"token operator\">=</span>PLAINTEXT://:9092\n\nadvertised.listeners<span class=\"token operator\">=</span>PLAINTEXT://**192.168.137.103**:9092\n\nzookeeper.connect<span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.137.101:2181, <span class=\"token number\">192.168</span>.137.102:2181, <span class=\"token number\">192.168</span>.137.103:2181</code></pre></div>\n<p>별도 파일(/tmp/zookeeper/myid)에 인스턴스 ID를 명시해야 하는 Zookeeper와는 달리 Kafka는 설정파일안에 broker.id라는 항목이 있다.</p>\n<p>그리고 zookeeper.connet라는 항목에는 Zookeeper인스턴스들의 정보를 입력해준다.</p>\n<p>Kafka를 구동하기 위한 설정은 끝났다. 클러스터 구성을 위한 인스턴스들의 정보를 입력해 주는것이 거의 대부분의 설정이다.</p>\n<p>그외 설정 파일에 대한 상세한 내용은 공식 홈페이지의 <a href=\"http://kafka.apache.org/documentation/#brokerconfigs\"><strong>Broker Configs</strong></a>를 참고하길 바란다. default설정값을 확인하고 변경하고자 하는 값들은 설정파일에 명시를 해주면 된다.</p>\n<h4 id=\"zookeeper-및-kafka-서버-구동\" style=\"position:relative;\"><a href=\"#zookeeper-%EB%B0%8F-kafka-%EC%84%9C%EB%B2%84-%EA%B5%AC%EB%8F%99\" aria-label=\"zookeeper 및 kafka 서버 구동 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Zookeeper 및 Kafka 서버 구동</h4>\n<p>Kafka를 구동하기 위해 먼저 Zookeeper를 구동 한다음 이후 Kafka를 구동해야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ bin/zookeeper-server-start.sh config/zookeeper.properties\n$ bin/kafka-server-start.sh config/server.properties</code></pre></div>\n<p>3대의 서버에 Zookeeper와 Kafka가 정상적으로 구동이 되었다면 다음과 같이 starting 메시지를 확인할 수 있을 것이다.</p>\n<p>*starting (kafka.server.KafkaServer)</p>\n<p>이제 기본적인 클러스터 환경을 구성하고 서버를 구동시켰다.</p>\n<p>Kafka에서는 bin폴더 아래 제공되는 스크립트 파일을 이용해 Topic을 관리하고 Producer,Consumer를 테스트 해볼수 있다.</p>\n<p>기본적인 몇가지 스크립트 명령을 이용해 Topic을 생성해 보고 Producer 메시지를 저장하고 Consumer 메시지를 읽어오는것을 확인해 보도록 하자.</p>\n<h4 id=\"topic-관리\" style=\"position:relative;\"><a href=\"#topic-%EA%B4%80%EB%A6%AC\" aria-label=\"topic 관리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Topic 관리</h4>\n<p><strong>1. Topic생성</strong></p>\n<p>GameLog, GameLog2, GameLog3 세개의 Topic을 생성해보자.(replication-factor:3, partitions : 1)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ bin/kafka-topics.sh --create --zookeeper <span class=\"token number\">192.168</span>.137.101:2181, <span class=\"token number\">192.168</span>.137.102:2181, <span class=\"token number\">192.168</span>.137.103:2181 --replication-factor <span class=\"token number\">3</span> --partitions <span class=\"token number\">1</span> --topic GameLog\n$ bin/kafka-topics.sh --create --zookeeper <span class=\"token number\">192.168</span>.137.101:2181, <span class=\"token number\">192.168</span>.137.102:2181, <span class=\"token number\">192.168</span>.137.103:2181 --replication-factor <span class=\"token number\">3</span> --partitions <span class=\"token number\">1</span> --topic GameLog2\n$ bin/kafka-topics.sh --create --zookeeper <span class=\"token number\">192.168</span>.137.101:2181, <span class=\"token number\">192.168</span>.137.102:2181, <span class=\"token number\">192.168</span>.137.103:2181 --replication-factor <span class=\"token number\">3</span> --partitions <span class=\"token number\">1</span> --topic GameLog3</code></pre></div>\n<p>출력 <em>Created topic \"GameLog\"</em></p>\n<p><strong>2. Topic 리스트 확인</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ bin/kafka-topics.sh --list --zookeeper <span class=\"token number\">192.168</span>.137.101:2181, <span class=\"token number\">192.168</span>.137.102:2181, <span class=\"token number\">192.168</span>.0.103:2181</code></pre></div>\n<p>출력 GameLog GameLog2 GameLog3</p>\n<p><strong>3. Topic 삭제</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ bin/kafka-topics.sh --delete --zookeeper <span class=\"token number\">192.168</span>.137.101:2181, <span class=\"token number\">192.168</span>.137.102:2181, <span class=\"token number\">192.168</span>.137.103:2181 --topic GameLog3</code></pre></div>\n<p>출력 <em>Topic GameLog3 is marked for deletion</em></p>\n<p><strong>4. Topic 상세 정보 확인</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ bin/kafka-topics.sh --describe --zookeeper <span class=\"token number\">192.168</span>.137.101:2181, <span class=\"token number\">192.168</span>.137.102:2181, <span class=\"token number\">192.168</span>.137.103:2181</code></pre></div>\n<p>출력 <em>PartitionCount:1 ReplicationFactor:3..</em></p>\n<p>토픽을 생성했으면 해당 토픽에 메시지를 생산하고 소비하는것을 직접 확인해보자.</p>\n<h4 id=\"메시지-생산-및-소비\" style=\"position:relative;\"><a href=\"#%EB%A9%94%EC%8B%9C%EC%A7%80-%EC%83%9D%EC%82%B0-%EB%B0%8F-%EC%86%8C%EB%B9%84\" aria-label=\"메시지 생산 및 소비 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>메시지 생산 및 소비</h4>\n<p><strong>1.Producer 메시지 생산하기</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ bin/kafka-console-producer.sh --broker-list <span class=\"token number\">192.168</span>.137.101:9092,192.168.137.102:9092,192.168.137.103:9092 --topic GameLog</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 762px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8655d49a4820e52b9918d1fe72c11f40/a016c/kfc-02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAnklEQVQI123M4QqCMBDA8b2PM9M5y9Ttlo2UOUXIORRC6P3foWl9KBB+HP8Pd4eGcen6ueunprVNO3LZS2Wkekg1VNrWrS1KzW7dmdWZUMVVX2Cd+RZoME+3UWtzyqs4geTsiIDCIYaAuhA4Yl7IMOFrRAz/QMYuKSg/BiekvMxYWXB3ueH+N/64j59A0/xK8/sxZhEVhAIm4JGdg11vV5g5swKmtKsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img\"\n        title=\"img\"\n        src=\"/static/8655d49a4820e52b9918d1fe72c11f40/a016c/kfc-02.png\"\n        srcset=\"/static/8655d49a4820e52b9918d1fe72c11f40/5a46d/kfc-02.png 300w,\n/static/8655d49a4820e52b9918d1fe72c11f40/0a47e/kfc-02.png 600w,\n/static/8655d49a4820e52b9918d1fe72c11f40/a016c/kfc-02.png 762w\"\n        sizes=\"(max-width: 762px) 100vw, 762px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><strong>2.Consumer 메시지 소비하기</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ bin/kafka-console-consumer.sh --bootstrap-server <span class=\"token number\">192.168</span>.137.101:9092,192.168.137.102:9092,192.168.137.103:9092 --topic GameLog --from-beginning</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 759px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6cb08f54ad9045d799356f3f26eee1f2/ef3e1/kfc-03.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAqUlEQVQI132M6wqCQBBGfR9T21uGYTumW5q31SXdNKH3f4omg6A/wWH4ZvjOOLqfB/usW4uhM8u5GlU5VN2MFI0tu6nS07W9X+qx1BNyynuZNaBaUNrpzaOobZr3PFKEy3CfiBC2AnwGHpM+h0AkGyoDnmDA1SWxS44fHHNbRJzTfeqLhAiAg8xiSXdoogbY/uKtE1/g/Q0Hx5g5jDLCJBXA1rbLfpw/vABcgzroFEspYgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img\"\n        title=\"img\"\n        src=\"/static/6cb08f54ad9045d799356f3f26eee1f2/ef3e1/kfc-03.png\"\n        srcset=\"/static/6cb08f54ad9045d799356f3f26eee1f2/5a46d/kfc-03.png 300w,\n/static/6cb08f54ad9045d799356f3f26eee1f2/0a47e/kfc-03.png 600w,\n/static/6cb08f54ad9045d799356f3f26eee1f2/ef3e1/kfc-03.png 759w\"\n        sizes=\"(max-width: 759px) 100vw, 759px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>from-beginning 옵션은 해당 topic의 맨 처음 메시지부터 소비하겠다는 의미이다.</p>\n<p>그림에서 보는 것과 같이 Producer에서 메시지를 입력하면 Consumer에서 해당 메시지를 읽어오는 것을 확인 할 수 있다.</p>\n<p>지금까지 Kafka 클러스터를 직접 구축하여 메시지 생산하고 소비하는 것을 간단하게 해보았다.</p>"},"primaryTag":{"name":"DataLake","color":"#b798f5"}},"pageContext":{"postId":"722d4cf2-22d7-5ee2-a4f5-8bacb633bdfa","primaryTag":"DataLake"}}}