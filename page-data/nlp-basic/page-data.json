{"componentChunkName":"component---src-templates-post-tsx","path":"/nlp-basic","result":{"data":{"post":{"headings":[{"depth":1},{"depth":1},{"depth":1},{"depth":1}],"frontmatter":{"title":"NLP - Bag of words, n-gram","path":"/nlp-basic","tags":["ML-DL","ML","NLP"],"excerpt":"자연어 처리(natural language processing)는 인간의 언어 현상을 기계적으로 분석해서 컴퓨터가 이해할 수 있는 형태로 만드는 자연 언어 이해 혹은 그러한 형태를 다시 인간이 이해할 수 있는 언어로 표현하는 제반 기술을 의미한다.","created":"2019-03-07T00:00:00.000Z","createdPretty":"07 March, 2019","updated":"2019-03-07T00:00:00.000Z","updatedPretty":"07 March, 2019","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAACXUlEQVQoz3WSXUiTURjHd9NNN0EXCdVNiRVkN1maBeFdYfgRWKaSkuaFFdVFriyJCow00+zDb9O+NCIrK1s5K8TVxK/ptBHbIp2Uqb3bnNvbNrf9Or4SdNMD/+dwOOf5nefjqBA2bxnBXZaPp+oCnsrzzN08h7+pGGlqmujsItYkqVmXcpaw3Sd5pO3j19QkbS/a0bzpUPS2Q4vT6VxAoVpwclsjUmIEzrxdODKisWftQM6MYWLIQFjCacKT1WzPucyS2Fzq2nTodd2UllVQV3+Hquo6rpaWY7FYF4Eh4byv7iPtXI7raDzukhPMXjmOJyuWydFhVuxRsyzuCOF7z6CKzKC2rRtDfx81tQ3U1zcqa8m/wAXnm/iKu7EYz7MGvLrX+IrykGsu4ff7ed5l4J5GT3mLluT8W9h+2pFmZqhtaOLh41a6urr5IOSam1sEFhh7yBzs5pBpgNzRXvYPfaK5p1P0wa1cCPhkZqUZvB4XkiTx136Yv+C4dopAZSH+24XI5fm4hVQrRblr2x8QqWlmo6aFpa21HBZQBRYM8m18nEHDEMaRUcwWC/Mi64U2MW7GkbwBe9oWpJRNOA5uw560HtUqAYzqfMI+fQepei2rxT67970CdMsyn00mTELDRiP9/QM47HblzC9+hiMtilnRd8eBzTjFIO0JEagSP2qIefeUBJ1GAYe9vMt1s1EJkr2/sdkmGBsbU2S1WrGN2xazn/6OqyAdR/pWnDlxuNSpzB6LF1MOhXD6fQRDQSoE6IZ4Wfmbotz/WSgQWLwzZsZTfZGQz0vIKxMSMX8AHoc67cKzVEIAAAAASUVORK5CYII=","aspectRatio":2.150537634408602,"src":"/static/c7da038937e7bf3502929f7490bce973/cd86a/cover.png","srcSet":"/static/c7da038937e7bf3502929f7490bce973/dc47e/cover.png 200w,\n/static/c7da038937e7bf3502929f7490bce973/9f2d5/cover.png 400w,\n/static/c7da038937e7bf3502929f7490bce973/cd86a/cover.png 768w","sizes":"(max-width: 768px) 100vw, 768px"}}}},"html":"<p>자연어 처리(natural language processing)는 인간의 언어 현상을 기계적으로 분석해서 컴퓨터가 이해할 수 있는 형태로 만드는 자연 언어 이해 혹은 그러한 형태를 다시 인간이 이해할 수 있는 언어로 표현하는 제반 기술을 의미한다. (위키피디아)</p>\n<p>간단하게 말하면, 자연어의 의미를 분석하여 컴퓨터가 처리할 수 있도록 하는 일 이라고 생각하면 될 것 같다.</p>\n<h1 id=\"텍스트\" style=\"position:relative;\"><a href=\"#%ED%85%8D%EC%8A%A4%ED%8A%B8\" aria-label=\"텍스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>텍스트</h1>\n<p>기계학습 모델을 만들기 위해서는 데이터를 모델에 맞게 변형시켜 주어야 한다. 알고리즘에서 텍스트를 그대로 받아들일수 없기 때문에 받아들일 수 있는 어떤 숫자값으로 변환을 해주어야 한다. 하지만 텍스트는 일단 언어가 제각기 다르기 떄문에 텍스트 자체를 어떻게 숫자화 할지 부터 시작해야한다.</p>\n<p>그럼 어떤 방법들이 있는지 살펴보자.</p>\n<h1 id=\"bowbag-of-words\" style=\"position:relative;\"><a href=\"#bowbag-of-words\" aria-label=\"bowbag of words permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BOW(bag of words)</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 417px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0037be387a166505e7fa603e1bb1e026/f27fb/bow-01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABtUlEQVQoz42SO27CQBCGkTgGRTgLR+Ak1ByAC1AjUSJ6ilhUUIAgJMLEPNYyMY5f6wdgGxswr/yOHUQQBVOsdsf+Zv79Z1OXJ+J8PmP1fX/9G0EQxPnU5bkAr6oqyDAMFUU5nU4JfP6Lhw1d15VlGasgCM1mk2EYQshms/nX+SGPOB6PPM+zLNtut8FrmqbI8uFwSGBUXSwWjuPcqkAAi8tRSsFDM9QSMpVkxfU87CMY9aCkWCzqun5Ve2fVfr9fWvZ2u6VU3+522HieF8GdTofjuGq12mq1cFytVrAEQKPRgEhk0FMURU3TbdMcjyfh4RglHSeC8/l8JpPJZl8KhQKOlmWVSqVcLpdOp2u1GjK2bWM8ruNi76zXs+lUEObwLILr9XqlUimXywzzimM8BrjQ7XZjY9A5tsaguqoosGA+nyed0Qo6ISz+CfCd7Zgt7hJdWNeXyyUyEAI7k1EB8/3gFkCJq9uxc6ZpQb9BqaJq+BSNKgh8SVqwQxaeUWrsw/DhU7FNo9fvj9gRO/zo9d4k6Rv5lOe53OeIEAyS58ZjjOEhbFBtMHj/EkW8ttlkMiMEdvwAOXPOwW+77AEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nlp-1\"\n        title=\"nlp-1\"\n        src=\"/static/0037be387a166505e7fa603e1bb1e026/f27fb/bow-01.png\"\n        srcset=\"/static/0037be387a166505e7fa603e1bb1e026/5a46d/bow-01.png 300w,\n/static/0037be387a166505e7fa603e1bb1e026/f27fb/bow-01.png 417w\"\n        sizes=\"(max-width: 417px) 100vw, 417px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>BOW(Bag of words)는 텍스트 데이터를 표현하는 방법 중 하나로 가장 간단하지만 효과적이라 기계학습에서 널리 쓰이는 방법이다. BOW는 텍스트의 구조와 상관없이 단어들을 담는 가방(Bag)으로 생각하면 된다. </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">The game is fun\nThe game is interesting\nThe game is not funny</code></pre></div>\n<p>세 문장에서 나타나는 단아들을 모으고 세 문장을 각각 binary vector로 표현하는 것이 BOW이다. 각각의 문장을 binary vector로 표현하면 다음과 같다.</p>\n\n      <div class=\"remark-sticky-table\"> \n      <div class=\"remark-sticky-table-wrapper\" style=\"width: 100%; height: 100%; overflow: auto;\">\n          <table class=\"remark-sticky-table-table\">\n      \n            \n               <thead class=\"remark-sticky-table-thead\">\n                     <tr class=\"remark-sticky-table-tr\">\n                     <th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">the</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">game</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">is</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">fun</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">interesting</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">not</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">funny</th>\n                        </tr> \n                        </thead><tbody class=\"remark-sticky-table-tbody\">\n                     <tr class=\"remark-sticky-table-tr\">\n                          <td class=\"remark-sticky-table-td\">1</td><td class=\"remark-sticky-table-td\">1</td><td class=\"remark-sticky-table-td\">1</td><td class=\"remark-sticky-table-td\">1</td><td class=\"remark-sticky-table-td\">0</td><td class=\"remark-sticky-table-td\">0</td><td class=\"remark-sticky-table-td\">0</td>\n                         </tr>\n                         </tbody>\n               \n        \n          </table>\n      </div>\n    </div>\n  \n<blockquote>\n<p>The game is fun : <strong>[1, 1, 1, 1, 0, 0, 0]</strong></p>\n</blockquote>\n\n      <div class=\"remark-sticky-table\"> \n      <div class=\"remark-sticky-table-wrapper\" style=\"width: 100%; height: 100%; overflow: auto;\">\n          <table class=\"remark-sticky-table-table\">\n      \n            \n               <thead class=\"remark-sticky-table-thead\">\n                     <tr class=\"remark-sticky-table-tr\">\n                     <th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">the</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">game</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">is</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">fun</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">interesting</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">not</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">funny</th>\n                        </tr> \n                        </thead><tbody class=\"remark-sticky-table-tbody\">\n                     <tr class=\"remark-sticky-table-tr\">\n                          <td class=\"remark-sticky-table-td\">1</td><td class=\"remark-sticky-table-td\">1</td><td class=\"remark-sticky-table-td\">1</td><td class=\"remark-sticky-table-td\">0</td><td class=\"remark-sticky-table-td\">1</td><td class=\"remark-sticky-table-td\">0</td><td class=\"remark-sticky-table-td\">0</td>\n                         </tr>\n                         </tbody>\n               \n        \n          </table>\n      </div>\n    </div>\n  \n<blockquote>\n<p>The game is interesting : <strong>[1, 1, 1, 0, 1, 0, 0]</strong></p>\n</blockquote>\n\n      <div class=\"remark-sticky-table\"> \n      <div class=\"remark-sticky-table-wrapper\" style=\"width: 100%; height: 100%; overflow: auto;\">\n          <table class=\"remark-sticky-table-table\">\n      \n            \n               <thead class=\"remark-sticky-table-thead\">\n                     <tr class=\"remark-sticky-table-tr\">\n                     <th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">the</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">game</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">is</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">fun</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">interesting</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">not</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">funny</th>\n                        </tr> \n                        </thead><tbody class=\"remark-sticky-table-tbody\">\n                     <tr class=\"remark-sticky-table-tr\">\n                          <td class=\"remark-sticky-table-td\">1</td><td class=\"remark-sticky-table-td\">1</td><td class=\"remark-sticky-table-td\">1</td><td class=\"remark-sticky-table-td\">0</td><td class=\"remark-sticky-table-td\">0</td><td class=\"remark-sticky-table-td\">1</td><td class=\"remark-sticky-table-td\">1</td>\n                         </tr>\n                         </tbody>\n               \n        \n          </table>\n      </div>\n    </div>\n  \n<blockquote>\n<p>The game is not funny : <strong>[1, 1, 1, 0, 0, 1, 1]</strong></p>\n</blockquote>\n<p>만약 이 가방에 들어있지 않는 단어가 포함된 문장이 있어도 BOW는 그 없는 단어는 제외하고 있는 단어만을 가지고 벡터로 만들 것이다.</p>\n<p>그럼 이 수치로 표현된 값을 어떻게 활용할까?</p>\n<p>머신러닝 모델에 입력값으로 사용할 수도 있디만 단순히 계산만으로 문장간의 유사도(Sentence similarity)를 알 수도 있다.</p>\n<p><code class=\"language-text\">the game is fun</code> 과 <code class=\"language-text\">The game is interesting</code> 문장의 유사도를 구해보자.</p>\n\n      <div class=\"remark-sticky-table\"> \n      <div class=\"remark-sticky-table-wrapper\" style=\"width: 100%; height: 100%; overflow: auto;\">\n          <table class=\"remark-sticky-table-table\">\n      \n            \n               <thead class=\"remark-sticky-table-thead\">\n                     <tr class=\"remark-sticky-table-tr\">\n                     <th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">문장</th><th class=\"remark-sticky-table-th\" style=\"position: sticky; display: table-cell; width: auto; min-width: auto; white-space: nowrap; top: 0px; z-index: 2;\">벡터값</th>\n                        </tr> \n                        </thead><tbody class=\"remark-sticky-table-tbody\">\n                     <tr class=\"remark-sticky-table-tr\">\n                          <td class=\"remark-sticky-table-td\">the game is fun</td><td class=\"remark-sticky-table-td\"><code class=\"language-text\">1</code>, <code class=\"language-text\">1</code>, <code class=\"language-text\">1</code>, 1, 0, 0, 0</td>\n                         </tr>\n                         </tbody><tbody class=\"remark-sticky-table-tbody\">\n                     <tr class=\"remark-sticky-table-tr\">\n                          <td class=\"remark-sticky-table-td\">The game is interesting</td><td class=\"remark-sticky-table-td\"><code class=\"language-text\">1</code>, <code class=\"language-text\">1</code>, <code class=\"language-text\">1</code>, 0, 1, 0, 0</td>\n                         </tr>\n                         </tbody>\n               \n        \n          </table>\n      </div>\n    </div>\n  \n<blockquote>\n<p><strong>유사도 = (1x1) + (1x1) + (1x1) + (1x0) + (0x1) + (0x0) + (0x0) = 3</strong></p>\n</blockquote>\n<p>또한 수치로 표한된 값을 이용해 기계학습 모델에 입력값으로 사용할 수가 있다. 문장에 대한 감성분석을 해주는 모델이 있다면, 벡터화된 값을 모델에 입력값으로 사용할 수 있고 모델은 우리가 원하는 <code class=\"language-text\">Good</code> 또는 <code class=\"language-text\">Bad</code>의 결과를 출력해 줄 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1200px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/93cabce3b645984aeb6dc3ae405ecaa7/a3767/bow-ml.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABR0lEQVQY02WRvU7DMBSF81R9AuBRYGIAnqMSS1UGpk6UCcSCoBXQQieEChJTpaZpotKQxEnUpI3/cvA1Eghh6/PPsX1077VTVRU451BKQUoJIYSFNILWpHNeYWPuAuae4Oj2XCjJzV6CPBT/nh2jIM9zzGYzBEGAKIosq9XK6mmaYrFYYMMFUGvcPn+i2Z1g++gJzfMJBuMEpeKYliFEreBkWYYkSRCGIZbLpSWOY2tIZilLEOVrJC83qActdO4ZGrt97B+P0di7w1k/MCFpzNcJuJZwPM8DQSa+78N1XWtalqU1zFIGVnCwcQ/1sI3TXoytgwcctt5MlI/oXM9tGVwWQGgTIaVJRowxC6VHKRdFYSMnKAsuFLSp8/A1Qvtiih1jdnI5xeidAUICnm9KUsOpzUAforX+A+n/wG+7Gn38rOnMvLD9C1QJuruXBnsGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"bow\"\n        title=\"bow\"\n        src=\"/static/93cabce3b645984aeb6dc3ae405ecaa7/c1b63/bow-ml.png\"\n        srcset=\"/static/93cabce3b645984aeb6dc3ae405ecaa7/5a46d/bow-ml.png 300w,\n/static/93cabce3b645984aeb6dc3ae405ecaa7/0a47e/bow-ml.png 600w,\n/static/93cabce3b645984aeb6dc3ae405ecaa7/c1b63/bow-ml.png 1200w,\n/static/93cabce3b645984aeb6dc3ae405ecaa7/a3767/bow-ml.png 1210w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>하지만 BOW는 몇 가지 단점이 있다.</p>\n<ul>\n<li><strong>Sparsity</strong><br>\n실제 사전에는 100만개가 넘는 단어들이 있을 수도 있다. 그렇게 되면 벡터의 차원이 100만개가 넘어가기 때문에 실제 문장하나를 표현할 때 대부분의 값이 0이고 그외의 값들은 상당히 적을 것이다. 결국 학습량이 많아지고 컴퓨터 자원도 상당히 많이 사용하게 된다.<br>\n(the game is fun [1,1,1,1,0,0,0,0,0,0,0,,,,,,0,0,0,0,0])</li>\n<li><strong>빈번한 단어는 더 많은 힘을 가진다.</strong><br>\n많이 출현한 단어는 힘이 세진다. 만약 의미없는 단어들이 많이 사용 되었다면 우리가 원하는 결과를 얻기는 어려울 것이다.</li>\n<li><strong>Out of vocabulary</strong><br>\n오타, 줄임말 등의 단어들이 포함되면 굉장히 난감해진다.^^;</li>\n<li><strong>단어의 순서가 무시됨</strong><br>\n단어의 출현 횟수만 셀수 있고 단어의 순서는 완전히 무시 된다. 단어의 순서가 무시된다는 것은 다른 의미를 가진 문장이 동일한 결과로 해석될 수 있다는 것이다.</li>\n</ul>\n<p>전혀 반대의 의미를 가진 두 문장을 보자.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 786px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1f557bdb0147a1cfe1663bb193df0d0c/321ea/bow-02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABcRAAAXEQHKJvM/AAABzElEQVQoz11STWsTURSdpCbZCAU32SnUrV1JLXRj7cqduPEH+A8M2EJXIuiyX6lQssgqVbHaoURjQ2koZCMSQiSaZNppmbZpyWRMJpk3eZPJfNzeWwspHni8++5599z7Dk84Sy9L1Y2F/fq3d78PNpeq+2L85Ggrrv/dSTwWEMCaNwFAYIyFTjU2Srn1/NELsXAG7/eqRmqv1k1mS1Zyu8Q/5mUuVBKxMeXDq9tPxqOTmdTac3A4WHoTWFdXObfOwfd/aJoWRNEYrm7PNOVWx9BM24Mv6e3d6L3pB8tf/9yJrYh33376OSZcw62Hj2ZSrMdBOT7xSqVfoOs66vnnhmGEWq3WGxSEWq0GlUoFTMZgbvbld+F/GOLrQCH7+QbFWlOdUlUVDmXZL5fLDgqB4zgKca7rzrfbbZAkyS4Wizb8wwJx2XwhlNiRAkvpcuBSFIng1X6fcw71et1Hz1zP8wCXHIlEnuZyuQ1SaDQaLjYaUGya5irVWZYVxJrhlJSgfTAYTPT7fVAUxcfLLsXIHYTD4WeZTEYkEWpm27ZLcafTiVMd5kbQmqHgtQkn6CJOcClIT0Qfj6+4eeLw3MPpe+QvNlskDv0doZ9AuABW82/6AALCAgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nlp-1\"\n        title=\"nlp-1\"\n        src=\"/static/1f557bdb0147a1cfe1663bb193df0d0c/321ea/bow-02.png\"\n        srcset=\"/static/1f557bdb0147a1cfe1663bb193df0d0c/5a46d/bow-02.png 300w,\n/static/1f557bdb0147a1cfe1663bb193df0d0c/0a47e/bow-02.png 600w,\n/static/1f557bdb0147a1cfe1663bb193df0d0c/321ea/bow-02.png 786w\"\n        sizes=\"(max-width: 786px) 100vw, 786px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>두 문장은 의미가 전혀 반대이지만 BOW를 이용해 처리한다면, 동일한 결과를 반환하게 될 것이다.\n이런 단점을 보완하기 위해 좀더 개선된 n-gram이란 것이 있다. BOW는 하나의 토큰을 사용하지만 n-gram은 n개의 토큰을 사용하여 어느정도 단어의 순서를 반영 결과에 반영해 준다.</p>\n<h1 id=\"n-gram\" style=\"position:relative;\"><a href=\"#n-gram\" aria-label=\"n gram permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>N-Gram</h1>\n<p>BOW를 조금 더 개선하여 단어 하나만을 보는 것이 아니라 주변의 n개 단어를 뭉쳐서 보는 것이다. 뭉쳐진 n개의 단어들을 gram이라고 한다.\n단어 개수에 따라 부르는 명칭이 다른데 2개의 단어를 묶어서 사용하면 <code class=\"language-text\">bi-gram</code>, 3개면 <code class=\"language-text\">tri-gram</code>이라고 부른다.\n(1-gram은 uni-gram이라고 한다.) </p>\n<p>다음 문장을 bi-gram를 사용하여 처리 한다면,</p>\n<p><strong>\"home run\"</strong> 과 <strong>\"run home\"</strong></p>\n<blockquote>\n<p>bag of words : [home, run] , [run, home]<br>\nbi-gram : [home run], [run home]</p>\n</blockquote>\n<p>BOW를 사용한다면 두 문장은 같은 백터의 값을 갖게 되겠지만 bi-gram을 사용하면 2개를 뭉쳐서 사용하므로 어느정도의 순서가 보장되는 효과를 볼수 있게 되어 다른 결과 값을 가지게 될 것이다.</p>\n<p>이런 특성을 이용해 n-gram은 다음 단어 예측하거나 어떤 단어를 입력 했을때 오타를 발견하고 다른 단어를 추천해 주는데 활용할 수 있다.</p>\n<h1 id=\"텍스트-전처리-preprocessing\" style=\"position:relative;\"><a href=\"#%ED%85%8D%EC%8A%A4%ED%8A%B8-%EC%A0%84%EC%B2%98%EB%A6%AC-preprocessing\" aria-label=\"텍스트 전처리 preprocessing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>텍스트 전처리 (Preprocessing)</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1010px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6991a0789807fb1e23a545e938b335a9/5b587/process.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.000000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABcRAAAXEQHKJvM/AAABj0lEQVQY01VQPUhCURh9IC1ZSdAQQU1NTS1OrY2tQWkOJdFoQ4M2CYFQS2NGNEgghqZoTpL4r6GLk5ri7/Mpoj5/BvG9p93OtYL64Lz7cd4533fuZTqdDp/P57nhcCjmcrn9fr9/Nx6PRUEQWJyTQqFwCs0leInneXYwGIi1Wu2W47id0WgkNptNrtVq9dvt9rter19kICR2u/0TQuL1eq9gdhEUFkzo6ff7bzKZzGOpVCLJZHLS7XZJKpXyuFyuI0mSaD+lM+AvGQwGBWMymYhSqRRDoRCxWq0P5XL5lQrS6fQYKemy+3A4/IJFJBqNCo1Gg0QikTez2XxOB1YqFaFer5NisfgB/xKDqNQ8RRFcWYtkz+S7JPrJZrMXvV7vmvYYNuNYln2qVqu7P9wsIYaWjUajgvF4PBqkUAcCARX69WAwqHQ4HFqbzaZ2u93HTqdzE/+2YrHYocViOYvH4yqfz7edSCRW8EQnuPoBoIF3T6fTyRiUHFhm/tcvJ//DrQJrwAYg+6ObBxaAOUp8AbaJPCe4qq24AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nlp-1\"\n        title=\"nlp-1\"\n        src=\"/static/6991a0789807fb1e23a545e938b335a9/5b587/process.png\"\n        srcset=\"/static/6991a0789807fb1e23a545e938b335a9/5a46d/process.png 300w,\n/static/6991a0789807fb1e23a545e938b335a9/0a47e/process.png 600w,\n/static/6991a0789807fb1e23a545e938b335a9/5b587/process.png 1010w\"\n        sizes=\"(max-width: 1010px) 100vw, 1010px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>BOW나 n-gram이나 모두 많이 쓰이지만 가장 중요한 것은 단어의 전처리가 확실해야 한다는 것이다. 이 글에서는 설명을 위해 간단한 문장만을 사용하여 크게 신경을 쓸 필요는 없겠지만, 자연어 처리를 하다보면 다양한 케이스의 문장들을 접하게 될 것이며 이런 문장들을 토큰화하고 불필요한 단어들은 제거하고 같은 의미의 단어들은 치환하는 등의 고단한 작업 들을 해야 할 것이다. 하지만 다행인 것은 이런 전처리 작업들을 편하게 할 수 있도록 도와주는 좋은 라이브러리들이 있다.</p>\n<p>다음 포스팅에서는 전처리에 대해 자세히 살펴보도록 하겠다...</p>"},"primaryTag":{"name":"ML-DL","color":"#4bc822"}},"pageContext":{"postId":"a6522e0d-9638-5b46-8256-ea5d492d6872","primaryTag":"ML-DL"}}}