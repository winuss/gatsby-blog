{"componentChunkName":"component---src-templates-post-tsx","path":"/ml-knn","result":{"data":{"post":{"headings":[{"depth":1}],"frontmatter":{"title":"K-최근접 이웃법 (Nearest Neighbor)","path":"/ml-knn","tags":["ML-DL","ML","KNN"],"excerpt":"최근접 이웃법은 새로운 데이터를 입력받았을 때 가장 가까이 있는 것이 무엇이냐를 중심으로 새로운 데이터의 종류를 정해주는 알고리즘이다.","created":"2018-02-14T00:00:00.000Z","createdPretty":"14 February, 2018","updated":"2018-02-14T00:00:00.000Z","updatedPretty":"14 February, 2018","featuredImage":null},"html":"<p>최근접 이웃법은 새로운 데이터를 입력받았을 때 가장 가까이 있는 것이 무엇이냐를 중심으로 새로운 데이터의 종류를 정해주는 알고리즘이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 562px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0174c9019b26347b9a0a374784b2c2a7/6e88f/knn-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABcRAAAXEQHKJvM/AAACmElEQVQ4y2Oor6vjq6tvMGQAAqeAWBYGKAjsPsAYPuUMS1DvITA/uO8IA1GgqrFdoL26QMNz4kXlyOnn34ZNOZOPria4/ygD0QDJQCWggW+ABhaCxEMnntAIm3K6OLDnoBDEhYfhevYnq8LpfUjsdVHyDAzIXnYMjGMJ6jnIBGIDvduUvf3Pf6DBfmALJp1khhn4usYATL+rNWR4U2PA5KfCAeZfyddiYKirr+cDGmqA7vKQCcekgYZEBXTu5Qbxg3oOgMXPZmuA6fd1hnC1/xc4IjSCDKyFujC4Y6d4xLTzu4BeTUM2PLxnL5i+XazD8L/LjPFOsQ4jiH+3REf6boluDIj9stqA8VqBNtDLYAMbjcCu6NqjHjPv5v/wqeemgvhRs66wBXTtAxt2q9wE4aKJVmD6Xolu9uNyvQenMjWkQfzLeVqMYAORvezduEnMpXwJG4jt07wVLHanRBdMA13A8bBMbwLQVVJQPhcw3DiBBrGC+JfytCAuBGKwgaWtU5iQ0iGYjph2juF6sT5Y/HKhvuHjSsNTN0v03dHD/FyOJoQBMrAOamBdXT0jMCEzApMKPP151KwGs5es386IbsiZTDUhYCQJQl3HCDcQ5kIgzYgtrc6eMwfswpmzZjssXrxo0by5s51B/EcVBpsflestBLF/t5owwrzMD8SGUAOZ6urqGNDxnDlzwGE0d+6ctnv37v1fsHBhB4h/s9zUDxi+rjMidcFpdGplKtgQLqAmHWJyFdBg7Xnz5hXPnj1bF6cioGEKQGwPxNxALAzEQliwYGNjo3BaWhonSE9KaipnY2ODcFdtsUhXbYkIWE19vRAwtQiADLQC4lAg1gBifSDWQ8dAX4DphoYGg6amJmMQjSwOoqFsLQB1EjADPn5x/wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"knn\"\n        title=\"knn\"\n        src=\"/static/0174c9019b26347b9a0a374784b2c2a7/6e88f/knn-1.png\"\n        srcset=\"/static/0174c9019b26347b9a0a374784b2c2a7/5a46d/knn-1.png 300w,\n/static/0174c9019b26347b9a0a374784b2c2a7/6e88f/knn-1.png 562w\"\n        sizes=\"(max-width: 562px) 100vw, 562px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>{: height=\"300px\" }</p>\n<p>그림에서 보는것 처럼 기존 데이터가 파랑색과 주황색으로 데이터가 분류되었다고 한다면 물음표 데이터가 들어왔을때 이 데이터는 어떤 색상으로 분류가 되어야 할까? </p>\n<p>최근접 이웃법 말그대로 가까운 것에 따른 분류이기 때문에 주황색으로 분류할 것이다. 정말 간단하고 직관적인 알고리즘 이다.</p>\n<p>하지만 단순히 가장 가까이에 있는 것으로 분류를 하는것이 문제가 되는 경우도 있다.</p>\n<p>다음의 경우를 살펴 보자.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 562px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f7b1306f9f79091e0c65e3ae094d1e2f/6e88f/knn-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABcRAAAXEQHKJvM/AAADcElEQVQ4y42Se0jTURTH72Y+cpp7aSYVYUWr1sqIov4oKCKs/ujpgySx7C0mNpav/X5bVFtBmfmYrLJWM7SyYvmY6/e7m2/dNBXRzMoe2IMKoqggIm73Xt1Y0B8d+HLOPffezz3n3gtYhpnCsLo4gG3TkTNBYMKi1x0GHS1OGr+PB8DhHoxou2WaOXQi/ojLbovim9vkEDojm+w26eCFPUKyrqW+BoBcvUFszD+q2FjUPyfZ1PcjsaRbTSZTrz4J2KYxU2Bz7e1ogBAYyZq/YUyj/Pw4Y/Yykv+yGghLEZpkG/4qRt5K8jDQkJ+liC/qj0029X5IKOnOJPmD14cCiHdyD6XOlrZwEg9ploU9zZgVNpA+LaTwtE5AciOHZ84d0MfHVf1CoRTq3/La7WmTiDf2IroYco4gvrNPWoFjd4ZyGsndfIcCe158EnkLGstZ7HijWXgnDaHgTnuNCDAsOwVDl4B/WEtttZz4l+qFKWM5qmFHaUHMA8+oxFxumnPNYkmsslxZPrg3Kqb7QOx0WFUugs2tEgrUTlS43dg4Nams15FY4tlHxnYHFx2CkOBZ5uy45/krd3ea85Qkb7ly6bjb7UZWq9XgPRy2ewIh5KWApUD9UpLcdpabl1LxBCWV9ZTS9urbYmDdPd/LF973zFh/vm/j2fJKtfWGpbei4mrKt9dDwRTI88EQQgkF+re8SW+L2qKvCSExQssFI33tAcmp2fSBMsytew/V/UQ7irsZMq6ub5I7na7JFAghAY5XiEWB6lOlQi9464WuFammruxqmyPSmzNUOmMPmLuM+8vbF30f5sPtnEvuaxlCGf6XQRTITAA1OqMg9foorSap7NGD9Nsf0fHL/CqEzH89FnraEHqvAYZ4xx18vcjFNY7D/SvEYEFCiYd+mZ1FHaodF7sScgqtAc1NTjkPYXhasYvgfOAeQ5KgYeCNqGwQiX1JDIvAipv4k0Jz5gaQfr5W4F+RYt0uwHGcmOf5KOxlWFLosMsftrplrsriyNcapXVUrVR5gaEMwyjBfxrC3whLiH730/t+kRY2423Ooruvjik20wUYNgtrDZYIS4Yl9Qof5vM6nU6q1Wolubm54nHliRltgQTPyUAmCtyTfy7iFJMnIcBVWDuxFFiLsVT+wht8/l/C9646yRYs0bF4L8su+APklqkStwPgDgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"knn\"\n        title=\"knn\"\n        src=\"/static/f7b1306f9f79091e0c65e3ae094d1e2f/6e88f/knn-2.png\"\n        srcset=\"/static/f7b1306f9f79091e0c65e3ae094d1e2f/5a46d/knn-2.png 300w,\n/static/f7b1306f9f79091e0c65e3ae094d1e2f/6e88f/knn-2.png 562w\"\n        sizes=\"(max-width: 562px) 100vw, 562px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>{: height=\"300px\" }</p>\n<p>이번에는 문제가 약간 복잡해 진다. 이론대로라면 가장 가까운 것은 파란색이기 때문에 파랑색으로 분류를 해야 할것 같지만, 주변을 보면 대부분 주황색이 보인다. 왠지 파랑색으로 분류하면 안될 것 같다는 생각이 든다....</p>\n<p>단순히 가까운 것에 따른 분류에서 이제 <strong>주변에 있는 몇개의 것들 중에 많은 것</strong>으로 분류하게 되면 이 문제는 어느정도 해결이 된다.</p>\n<p>물음표 주변(큰원)에는 4개의 데이터가 있는데 그중 세개가 주황색, 한개가 파란색 이다. 따라서 물음표는 주황색으로 분류한다.</p>\n<p>그렇다면 주변의 범위 즉 주변 데이터의 갯수에 대한 기준이 있어야 할 것 같은데.. 위에서는 4개로 정하였다. 즉 K=4가 되는 최근접 이웃법이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 811px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dc087791fd9aa41cd1aaecd3b7dcd036/fd28b/knn-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABcRAAAXEQHKJvM/AAACwklEQVQoz2PorM5lYoCCgElnGP7/X82ADML//2c6vG83+8ENSyHq/v+Hy0XEJAhERESoR0RGCoL5ERGMDJUN7RKhU88Hh006IQ1TeGZJF3v6//8sd+rss+7WWMWAxPbvP8A79/9/NhA7auZF1qj1v1kj0wq5IkKDRCIiwlnhthQ0T1UMn3bhaviU054gfvG07cz7Dh7hB7EfFihbPShUNwOxb2fKcF9pD9LtvfWfw731ECuyLyKiomWBrtMDu7S+vk4UWXL7yWs856bm8wENswTxC6GuelSs7vy4VKun8cB7wZM71rGAxGKmneGIWnCfJTI5hyMiPJQrIjKKmaG9ukDIc+ZDHqALw6KbVnGs//+f41aRjtK9KrNZ/2eycG5dPFl12dKl1xYuXmYKMmT+mh0i3evO8lj13mJJmHuVmQEdLMq24A6act4ocvqF+349hyX//9zBzlB4jREcVjMumBRP31G6bPHCi7OWbbAFiW3dtZevfvkZYQYBSORELXzIEJmcyxARFsIQGRXNAPRyPdjLPmVz2EH09JW7JKZsuwK2OWXWmXkR086vAbF37T/CC6IP7N3N8//NSnCMz9x4DGLorCtgDAZ1dfViMNeGTTmbETXj/IUbuxdwgfids9ewL1y9VejE4f08hdHhDBX//zPuOXxCAOyzAzcY/t9Zi2oYCNTX1YnDY2vyCfXQyae9b+xfwb5j1x7hK3uXg11iKcLAsP7cY/YTU4sUTzQGgiPp4aQYhqysLIwgBHlZgAEL+A90zYvX79hv3rzJ/ebNG45rP/+zPivTmvyqWEkfJH+lzIwJmz6QgXp19fViQJdK1TY0SVc3tsk01NdLVVVVSdTU1Eg21NdJ1dQ3SDZXFEivrgw3mlmVppbROIkNqhergWpALASKHBiuq6tDYgNpIB9omUhc8xz+4sYu4ea6KpwGAgA5Nio/CiPTSAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"knn\"\n        title=\"knn\"\n        src=\"/static/dc087791fd9aa41cd1aaecd3b7dcd036/fd28b/knn-3.png\"\n        srcset=\"/static/dc087791fd9aa41cd1aaecd3b7dcd036/5a46d/knn-3.png 300w,\n/static/dc087791fd9aa41cd1aaecd3b7dcd036/0a47e/knn-3.png 600w,\n/static/dc087791fd9aa41cd1aaecd3b7dcd036/fd28b/knn-3.png 811w\"\n        sizes=\"(max-width: 811px) 100vw, 811px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>{: height=\"300px\" }</p>\n<p>만약 K=1로 한다면 처음 정의하였던 것처럼 물음표는 가장 가까운 한개의 요소만 바라보게 될 테니 파랑색으로 분류를 하게 될 것이다. 즉, K의 값에 따라 물음표가 어느 범주로 분류 될 것인지가 결정 된다.</p>\n<p>최근접 이웃법 앞에 K라는 단어가 붙어 KNN알고리즘이라고 하는 이유를 이제야 알 것 같다.</p>\n<p>그럼 과연 K는 몇이어야 좋은 것일까? 최선의 K값을 선택하는것은 데이터마다 다르게 접근해야 한다.</p>\n<h1 id=\"실습\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%EC%8A%B5\" aria-label=\"실습 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실습</h1>\n<p>간단하게 mglearn 라이브러리에 있는 데이터셋을 이용하여 실습해 보자.</p>\n<p>(mglearn : 그래프와 데이터셋을 손쉽게 다루기 위한 샘플데이터 라이브러리)</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">%</span>matplotlib inline\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">import</span> mglearn\n\nmglearn<span class=\"token punctuation\">.</span>plots<span class=\"token punctuation\">.</span>plot_knn_classification<span class=\"token punctuation\">(</span>n_neighbors<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>결과</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 359px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6d2b111709e71a61fc2064407b54e407/f5eb6/code-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAAB/ElEQVQoz21S23LTMBD1//8Ib32HocNDZwKEaYEkphRSO7Ec3y+yJFsXSwory8BM4Twka63Ont09CrTWfdczxsZJDMNAKB1wN44TZYxSQoaBvoC7ySHTdV0wTdM4jldrcJlcFxTRPrx95SJrr/9glhxnEQTACrhQ+ekpfnw43b/lpJ0F54ykX99JMRmt2/T4gqyV5GyY+rJEUQC6A2U3txuU5ekxnEjvJI1Owg+CC44r+199Tvu6CEBdzTr6vr8k8dKpdd1ao5TKskxK6fsHjHLWK2Y4Y9A2rADG9vXMkllLXK8XdA6/bM0iDLXu7g9V3STnMxRFCOV5HgghgOw7S+t+F2W+EGy+ruvZ2Hi30UpA0Z/7T23TAC1JEkhhjJ0y59wYm1S4GygmzI2kzevtN1CDGDYHjUB82O+qqgJmmiL4BHcDzgUscHOI34dxGGePsVM21mpjIOgIIyP3M2vJ4aSsmzfbAwSEEOcz5xPlSi3TGrtu1/89oSo8nrq2qesGbl+yPEFoEnL1eVzgaAvvjzGYTk5zgV0W1uHh4+eDv7yS3cNcvj2t7ClmjnNzt3v4gX7b5FJp1Yen3Hf3l9z3Pewc3jMMH0bpMyr0rGCcWUko7O0ASCGUlGsspXvbTq0s8QIwAHbb1BWki6KA3zRNoToYCwO3LTjVeAv94S+jlRzxTXiOOAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"knn\"\n        title=\"knn\"\n        src=\"/static/6d2b111709e71a61fc2064407b54e407/f5eb6/code-1.png\"\n        srcset=\"/static/6d2b111709e71a61fc2064407b54e407/5a46d/code-1.png 300w,\n/static/6d2b111709e71a61fc2064407b54e407/f5eb6/code-1.png 359w\"\n        sizes=\"(max-width: 359px) 100vw, 359px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><code class=\"language-text\">n_neighbors=3</code> 즉 K=3으로 할 경우 테스트 데이터가 어느 분류로 될지를 보여주는 그래프이다.</p>\n<p>앞에서 설명했듯이 가장 가까운 3개의 점들에 의해 분류가 결정이 된다.</p>\n<p>여기서는 세개의 별이 테스트로 들어온 데이터고 결과적으로는 두개는 주황색, 한개는 파랑색으로 분류가 되었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">mglearn<span class=\"token punctuation\">.</span>plots<span class=\"token punctuation\">.</span>plot_knn_classification<span class=\"token punctuation\">(</span>n_neighbors<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>결과</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 364px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e25eb7fb009ae6ff044ab64e59a0c867/e45a9/code-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAAB8UlEQVQoz2VSf2+bMBDl+3+JfYpJU/fHVE3aqq1TUq1J0zRjhYABhwAGzr8NO8fdsjYnYdnHvXd37y7qGOuHAbgYTsa6dgTAd++NDRcWIlnXCSEiDJnnqatSZ808z+ORLN6/s1rhfZ6m+cKabDtNDm0cx4hmcbZbxd8+cNYoYM7ZdPEJWopxx2xnlPgfOU0TZ7XiY73fciEjDvDx9oFLLYemP2QhiP5aGqMFOzijL5Nbo5AdOI+UkkVJs6IKxHg6a093BJ6LF8poY4NhGJ6+bOzekzk3+VbsP3qU4Ol+gbWF55e7TUpKkmeEkDRNq6rimBkAwu+Bq6/rJGRCPXzqeU42SzgSdMarH7TY56RAZJ7nXnaAl8wpbbsB6q4PRJ9/xt3I8aKk0MonX69XRUEQliQJYwzLRmBklHxIyqvvmzinN+vfvmDfkvNj4/LIINSCCmOkNfp68dj2g7XG9wwwDkKBUG9GgueeNqvn0tM5/8T+hxGkNu40aA/GLwjmFfu7FUKqbhRnopP/fhtX9TF4XqkdYD1I2nmu67vd1e1jaOFFTqFu1s/ncYbMbdtKKXFRrdZxXi2f0gn7AcAhozP8QsN1wJ31T87xhJNFTdMcDgfc8LIsEUDLAhEFIUiM2uLfuq4ppVggIQU6MQzvWZZprf8AVHwg0OQmAYcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"knn\"\n        title=\"knn\"\n        src=\"/static/e25eb7fb009ae6ff044ab64e59a0c867/e45a9/code-2.png\"\n        srcset=\"/static/e25eb7fb009ae6ff044ab64e59a0c867/5a46d/code-2.png 300w,\n/static/e25eb7fb009ae6ff044ab64e59a0c867/e45a9/code-2.png 364w\"\n        sizes=\"(max-width: 364px) 100vw, 364px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>만약 <code class=\"language-text\">n_neighbors=1</code> 즉 K=1으로 할 경우 다른 결과를 얻게 된다.</p>\n<p>mglearn의 make_forge 함수를 이용하여서 data와 target을 x와 y에 대입하여 해당 데이터로 모델을 만들고 검증해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> train_test_split\nx<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> mglearn<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>make_forge<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n \nx_train<span class=\"token punctuation\">,</span> x_test<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">,</span> y_test <span class=\"token operator\">=</span> train_test_split<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> random_state<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\nmglearn<span class=\"token punctuation\">.</span>discrete_scatter<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>결과</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 361px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/37876135892b5a8718709428b124ca2f/39d76/code-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAABpklEQVQoz3VS23LTMBD1/38Ef0EfgQfo9IEphJKBhsRtg+3YrqO7dZfMyio4TemOxl7vOWdvcuG9RxhzLkalGaOcc4IGwVOAM5YjZyakYjNUSKUEZzE4VO9ijNM0Havd6uLN9IoF7/H+5zQlZqGNbe435Y+vD9fvFB3MyJy1zfdLyTHAw+9N8O6ZOHg9ckkH0j4UUkpC6eX6HgCBWkEGcKCFfrcKIUjSxxBe1ndGaUGSeBzHJFhIMQa/EGPM45xG8ruABWRxCCAPzvnntPja8AAVWussBusxu/5Vp0QxGmuzcrhbS4Yz/yzjUrk8IET5kfIMvP+yhV2mRM7+d+wkVlp7az7f7j/elJt9+21b5co5PWIjnNNq4HxYbe08XaHAYGfaGuteTls2w93heDZ87iiJxWzg+ZDsH4kIibk8TaSMHejSRVrYclVz6JEIOOC8vVp/uinzLfyF+Kps8lBPlUFJKYWdQ/ve2s3+AAf+qvTpLKTOEPzF1hrYjpoNggAV6Yb6HiFECGm7zlnTtQegNk0jxFjXdYq3LRAwxl3XQSV4Qsmqqv4APccpih+rpM8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"knn\"\n        title=\"knn\"\n        src=\"/static/37876135892b5a8718709428b124ca2f/39d76/code-3.png\"\n        srcset=\"/static/37876135892b5a8718709428b124ca2f/5a46d/code-3.png 300w,\n/static/37876135892b5a8718709428b124ca2f/39d76/code-3.png 361w\"\n        sizes=\"(max-width: 361px) 100vw, 361px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>neighbors <span class=\"token keyword\">import</span> KNeighborsClassifier\nknn_classifier <span class=\"token operator\">=</span> KNeighborsClassifier<span class=\"token punctuation\">(</span>n_neighbors<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n \nknn_classifier<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"테스트 데이터 예측 : {}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>knn_classifier<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"테스트 데이터 정확도 : {}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>knn_classifier<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">,</span> y_test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"result\"><pre class=\"language-result\"><code class=\"language-result\">테스트 데이터 예측 : [1 0 1 0 1 0 0]\n테스트 데이터 정확도 : 0.8571428571428571</code></pre></div>\n<p><code class=\"language-text\">정확도는 약 86%</code></p>\n<p>이 말은 모델이 테스트 데이터셋에 있는 데이터들중 86%를 제대로 맞췄다는 의미이다.</p>\n<p>실제 핵심 로직은 sklearn에서 제공해 주고 있기 때문에 코드는 굉장히 간단해 보일 것이다.</p>\n<p>K-NN알고리즘은 지도학습의 분류 알고리즘의 하나로 로직이 간단하여 구현하기 쉽다. 하지만 학습 모델이 따로 없고, 전체 데이터를 스캔하여 데이터를 분류하기 때문에 데이터의 양이 많아지면 분류 속도가 현저하게 느려진다. 그래서 <code class=\"language-text\">게으른 알고리즘</code> 이라고도 한다.</p>"},"primaryTag":{"name":"ML-DL","color":"#4bc822"}},"pageContext":{"postId":"2191a159-debb-5e78-b5ff-5cc432a5df54","primaryTag":"ML-DL"}}}